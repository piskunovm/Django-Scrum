[
  {
    "title": "Тестируем сервисы для подготовки к собеседованию",
    "preview": "Шесть лет назад агентство Glassdoor выпустило исследование, где эксперты оценивали сложность интервью в IT-компаниях и реакцию соискателей. И неожиданно оказалось, что, чем труднее интервью, тем больше удовлетворения получает специалист от работы, если его наймут.",
    "body": "<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/be8/369/001/be83690011923dda93b800070ec7b2f2.jpg\"\n        style=\"width:780px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Шесть лет назад агентство Glassdoor выпустило&nbsp;<a\n        href=\"https://www.glassdoor.com/research/interview-difficulty/\">исследование</a>,\n    где эксперты оценивали сложность интервью в IT-компаниях и реакцию\n    соискателей. И неожиданно оказалось, что, чем труднее интервью, тем больше\n    удовлетворения получает специалист от работы, если его наймут.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Кажется, рекрутеры взяли это на заметку.\n    Собеседование любого айтишника превращается в большое количество\n    теоретических вопросов и практических задач. Квалифицированный спец может\n    сразу не вспомнить аргументы функций языка, что за 10 лет он использовал\n    два раза, и те случайно.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Чтобы освежить знания, даже сеньоры часто\n    дополнительно готовятся к техническому интервью и используют имитирующие\n    техническую часть собеседования онлайн-программы.</p>\n\n<p style=\"text-align:justify; font-size:18px\">К старту флагманского&nbsp;<a\n        href=\"https://skillfactory.ru/data-scientist-pro?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_dspr_081021&amp;utm_term=lead\">курса\n    по Data Science</a>&nbsp;разбираемся, действительно ли тестовые\n    собеседования подходят для подготовки к реальным.</p>\n\n<hr/>\n<h3 style=\"text-align:justify\">CodeSignal</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Его сильное преимущество &mdash; поддержка\n    большого пула языков. От популярных Python, Java, C++ или JS до редких\n    &mdash; F# или Erlang, поддерживается 38 ЯП. Интерфейс дружелюбный,\n    простой.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/52b/e33/54c/52be3354ca469794d77ed92f31d2f4d4.jpg\"\n        style=\"width:854px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Есть аркада, где в игровой форме можно\n    тренироваться использовать функции и атрибуты, а ещё есть челленджи от\n    компаний с их реальными задачами. Указаны уровень сложности и\n    предположительное время решения задач, поэтому развить навыки могут и\n    джуны.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">На CodeSignal нет туториалов и гайдов, есть\n    только задания и тренировочные блоки. Проверка кода автоматическая, с\n    помощью целого ряда &mdash; от 6 до 20 &mdash; тестов. Но нас интересует\n    раздел подготовки к интервью. Как утверждают создатели, программа\n    тренировки создана на основе вопросов и задач от топовых IT-компаний.\n    Интенсивность подготовки можно выбрать.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/029/fe7/988/029fe7988b1eff5c798a8fa7315cd831.png\"\n        style=\"width:986px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">При выборе одного из пакетов появляется\n    выпадающее меню с 20 темами. Программу можно подогнать под себя, выбрать\n    конкретную тему. Вот тестовый вопрос о массивах Python:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/68b/0b6/8fb/68b0b68fbb1e5f2a7d2ca1ea299585b8.jpg\"\n        style=\"width:508px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">За каждое выполненное задание даются баллы, они\n    открывают задачи сложнее. Сеньоры потратят час или полчаса, чтобы добраться\n    до действительно серьёзных задач.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Практику дополняют распространённые теоретические\n    вопросы собеседований. Есть развёрнутые ответы по каждому блоку знаний, так\n    что не придётся искать их отдельно. Также есть советы, на что обратить\n    внимание при подготовке.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Аккаунт CodeSignal может работать как резюме.\n    Инструмент на сайте поможет создать CV и красиво его оформить.</p>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\">Рекомендации по составлению резюме Data\n        Scientist и разбор ключевых ошибок вы можете прочитать&nbsp;<a\n                href=\"https://blog.skillfactory.ru/10-sovetov-kariernogo-tsentra/\">здесь</a>.\n    </p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">За час на портале автор решил десяток задач и\n    посмотреть на тренировки сложнее. Впечатление более чем хорошее. Удобный,\n    понятный интерфейс, различные форматы тренировок, реальные практические\n    задачи от компаний. Всё это &mdash; под соусом геймификации, а структура\n    портала и очки опыта мотивируют решать задачи проще, чтобы перейти к\n    сложным задачам.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/cd6/5ac/066/cd65ac066fc6170a6626f50b18f4d394.jpg\"\n        style=\"width:719px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">CodeSignal кажется довольно неплохим инструментом\n    для подготовки к технической части собеседования. Он нескучный, в нём\n    достаточно практических задач, есть теория. А ещё &mdash; задачи от топовых\n    компаний. Ресурс бесплатный.</p>\n\n<h3 style=\"text-align:justify\">InterviewBit</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Если CodeSignal помогает тренировать техническую\n    часть рабочего интервью, то на InterviewBit прокачивается коммуникация.&nbsp;</p>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\">Очень необычная штука, где вас собеседует не\n        автомат, а человек. Но обо всём по порядку.</p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">Языков всего 5: Python, Java, JavaScript, C++ и\n    C#, но есть мини-курсы по каждому. В теории можно прийти вообще без знаний\n    и изучать основы языка на этом ресурсе.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Базовый курс Python на сайте занимает чуть больше\n    9 часов. Практических задач не так много, но он очень даже неплохой.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Есть небольшие задачи от известных компаний,\n    туториалы на видео. Обучение комплексное.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Есть подробная база теоретических ответов с\n    собеседований Junior-Middle &mdash; это приблизительно 70 баз вопросов по\n    языкам, фреймворки и технологии, в каждой из которых от 50 до 100 вопросов\n    и тематические видео с пояснениями.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Я&nbsp;<a\n        href=\"https://www.interviewbit.com/python-interview-questions/\">посмотрел</a>&nbsp;раздел\n    Python, там оказалось 92 вопроса с детальными ответами. Вопросы не только\n    теоретические, но и на понимание принципов технологии и умения с ней\n    работать. Вот один из них:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/e77/82e/6af/e7782e6af0c481dba8dcb6213b141508.jpg\"\n        style=\"width:1104px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">А после идёт небольшой тест, где вы проверяете\n    знания. Сделано годно. Но вернёмся к инструменту для интервью:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/0f3/960/bfc/0f3960bfc7a93900e006d0fc5bbc0508.jpg\"\n        style=\"width:1136px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Вот так он работает:&nbsp;</p>\n\n<ol>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Вы подключаетесь к системе и ищете\n            собеседника прямо сейчас или планируете время в календаре. С вами\n            будет общаться такой же соискатель, но в этом и фишка.</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Когда собеседника выбран, вы получаете\n            вопросы на интервью, которые нужно ему задать. Они зависят от того,\n            какой язык программирования он изучает, какими компетенциями\n            обладает и на какую должность претендует. Оппонент также получает\n            блок вопросов к вам. Варианты ответов тоже есть, поэтому можно\n            оценить, насколько правильно отвечает человек.</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Сначала интервьюируют вас, потом &mdash;\n            вы. Или наоборот. Каждая из фаз длится 45 минут.&nbsp;</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">После двойного собеседования вы ставите\n            оппоненту оценку как интервьюеру и как соискателю. То же делает и\n            он. Всё анонимно, конфиденциально.&nbsp;</p>\n    </li>\n</ol>\n\n<p style=\"text-align:justify; font-size:18px\">Главная цель подобной тренировки &mdash; убрать\n    нервозность и страх перед живым собеседованием. Специалист не просто\n    тренируется отвечать на технические вопросы, а пробует делать это голосом,\n    перед реальным человеком и в условиях ограниченного времени. Это абсолютно\n    другие ощущения, чем решать тесты онлайн или отвечать на вопросы себе\n    самому.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Да, есть минусы. Если у вас разные стеки\n    технологий, вы не сможете оценить качество ответа собеседника и мелкие\n    нюансы. Частично это исправили каналом Discord, где можно обсудить подобные\n    вопросы. Но это &mdash; общий канал компании и её ценителей, так что\n    вариант не очень хороший.</p>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\">Подобный формат &mdash; пока наилучшая\n        возможность тренировки живого интервью. Лучше только настоящие\n        собеседования.</p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">Интервью ведутся на английском, русский не\n    поддерживается. Чтобы тестовое собеседование прошло успешно, нужно знать\n    язык хотя бы на уровне Upper-Intermediate. Отсутствие сильного акцента и\n    нормальные навыки аудирования приветствуются.&nbsp;</p>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\">Поработать над восприятием английского на\n        слух можно в приложении&nbsp;<a\n                href=\"https://play.google.com/store/apps/details?id=com.kimco.learn.english.listening\">Listen\n            English Daily Practice</a>. Этот другие ресурсы, полезные в\n        подготовке к интервью в Data Science, вы&nbsp;<a\n                href=\"https://blog.skillfactory.ru/15-poleznyh-resursov-dlya-podgotovki-k-sobesedovaniyam-v-it/\">найдёте\n            здесь</a>.</p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">Интересно, что на InterviewBit есть система\n    интервью с практикующими HR-специалистами. Можно отметить ряд организаций,\n    где вы хотели бы работать. Небольшие или средние компании могут отправить\n    приглашения на собеседование от спеца или рекрутера, то есть получить оффер\n    вы сможете прямо в системе.&nbsp;И всё это бесплатно для пользователей</p>\n\n<h3 style=\"text-align:justify\">Pramp</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Pramp &mdash; не часть большого проекта, он\n    полностью посвящён собеседованиям. Схема схожа с InterviewBit, но\n    реализована на совсем другом уровне, а среди направлений собеседования вы\n    найдёте Data Science. Бесплатными будут первые 6 собеседований.</p>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\">Как и в предыдущем варианте, основной язык\n        собеседований &mdash; английский, так что его нужно знать хорошо.</p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">Пары перекрестного собеседования подбираются на\n    основе навыков. Вместе с вами будет специалист примерно вашего уровня,\n    изучающий примерно тот же стек технологий, что и вы. Он будет понимать\n    техническую сторону вопросов, а не просто сверять ответы по шпаргалке. Есть\n    нюанс: тренироваться &laquo;здесь и сейчас&raquo; не получится &mdash;\n    нужно записываться заранее.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Набор ЯП не слишком большой, но самые\n    распространённые языки в нём есть. Самое интересное &mdash; можно выбрать\n    направление собеседования. Если вы претендуете на вакансию по ML, то знания\n    мобильной разработки вряд ли понадобятся.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/301/c74/88b/301c7488b41532f29fd852679af9b5a4.jpg\"\n        style=\"width:568px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Во время собеседования вы будете решать задачи в\n    реальном времени. Вот так выглядит окно разговора:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/3ae/f3b/aaa/3aef3baaa936408878252a56795fc7db.jpg\"\n        style=\"width:1919px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Слева снизу &mdash; окошко для видео, всё\n    остальное &mdash; это общее рабочее пространство. Вы пишете код в реальном\n    времени &mdash; собеседник увидит скорость работы, идеи и реализацию,\n    ошибки и исправление. Код запускается прямо в окне.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">В режиме интервьюера у собеседника чуть больше\n    информации, чем у вас. Если вдруг он сам не понял решение, есть подсказки и\n    подробный ответ, но, когда отвечаете вы, доступно только условие. Похожие\n    схемы взяли на вооружение крупные компании. Если интервью дистанционное,\n    регистрация на Pramp &mdash; must have.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Портал предлагает экспертные собеседования за\n    деньги со спецами из компаний FAANG. Пять сессий интервью стоят от 800 до\n    1400 долларов. Одна &mdash; около 200. Это будет максимально приближённое к\n    настоящему собеседование, программиста будут гонять по всем каверзным\n    вопросам и ситуациям, ведь принимает его действительно опытный человек. А\n    если пройти собеседование блестяще, возможно получить оффер.&nbsp;</p>\n\n<hr/>\n<p style=\"text-align:justify; font-size:18px\">В ходе подготовки материала мы нашли около\n    десятка инструментов для тренировки собеседований айтишников. Они частично\n    повторяют функции, поэтому нет смысла рассказывать обо всех, но оставим ещё\n    пару примеров:</p>\n\n<ul>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\"><a href=\"https://coderbyte.com/\">CoderByte</a>&nbsp;&mdash;\n            достойная альтернатива перечисленным выше инструментам, на которую\n            перешли уже 864 компании. Некоторые курсы и челленджы бесплатны,\n            остальные требуют платной подписки.</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\"><a href=\"https://www.hackerearth.com/\">HackerEarth</a>&nbsp;&mdash;\n            встречает пользователей разделением на энтерпрайз и открытое\n            сообщество. Бесплатно при некоммерческом использовании.</p>\n    </li>\n</ul>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\">Есть и необычные платформы, одна из таких\n        &mdash; русскоязычная&nbsp;<a\n                href=\"https://test-help.com/\">TEST-HELP</a>, где можно\n        проверить и прокачать общую подготовку, способность мыслить\n        последовательно и быстро в задачах разного типа. За 1299 рублей вы\n        получите полный доступ ко всем типам тестов и к ответам на задачи.</p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">Есть инструменты, которые объединяют тренировки с\n    изучением ЯП и узконаправленные порталы только для собеседований. Но\n    интересно, что с их помощью можно реально убрать страх перед техническим\n    собеседованием и показать себя с лучшей стороны, не отвлекаясь на волнение.&nbsp;Ведь,\n    чем больше интервью пройдёшь, тем увереннее будешь держаться на реальном\n    собеседовании. И тем выше шансы получить хороший оффер, чего нам и\n    надо.</p>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\"><em>Поделитесь в комментариях, какие сервисы\n        для собеседований использовали вы и какие впечатления они\n        оставили?</em></p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">При переходе из одной сферы в другую страх перед\n    интервью &mdash; не единственная проблема. К примеру, рынок перенасыщен\n    людьми, начинающими новую карьеру, особенно после карантина.&nbsp;<a\n            href=\"https://blog.skillfactory.ru/5-problem-pri-poiske-raboty-v-it-i-kak-ih-reshit-2/\">Эта\n        статья</a>&nbsp;подскажет, что делать.</p>",
    "author": "sidorov",
    "category": "разработка",
    "image": "be83690011923dda93b800070ec7b2f2.jpg",
    "status": "moderation",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": ""
  },
  {
    "title": "Если импортозамещение дышит в спину: особенности установки и настройки «облака» ресурсов и виртуальных машин на Linux",
    "preview": "Дисклеймер: данная статья не рассчитана на опытных линуксоидов, что уже собаку съели, куря мануалы OpenNebula, – для них большая часть текста покажется либо наивной, либо очевидной, либо наивно-очевидной. Мы хотим не рассказать о том, что же это за зверь такой, а скорее порекомендовать, на что обратить внимание, если вас поставили перед фактом, что надо переходить на российское ПО, и вам предстоит импортозаместить систему виртуализации. Ну, или пока запустить ее в тестовом режиме.",
    "body": "Дисклеймер: данная статья не рассчитана на опытных линуксоидов, что уже собаку съели, куря мануалы OpenNebula, – для них большая часть текста покажется либо наивной, либо очевидной, либо наивно-очевидной. Мы хотим не рассказать о том, что же это за зверь такой, а скорее порекомендовать, на что обратить внимание, если вас поставили перед фактом, что надо переходить на российское ПО, и вам предстоит импортозаместить систему виртуализации. Ну, или пока запустить ее в тестовом режиме.",
    "author": "petrov",
    "category": "разработка",
    "image": "a618e245f255411860a93a9c282d1fe6.png",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "15.09.21 01:55:19"
  },
  {
    "title": "Герметизация корпусов для электроники. Часть 1: пластик и резина",
    "preview": "В этой статье мы расскажем и покажем, как обеспечить герметичность корпуса для электроники — сделать его непроницаемым для воды и пыли. Под катом вас ждет разбор стандарта IP с разными степенями защиты и сравнительный анализ методов герметизации на серийном производстве.",
    "body": "<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/d75/aab/49f/d75aab49fb9cc09b62b7b1b46f1d16cc.png\" style=\"height:800px; width:1200px\" /></p>\n\n<p style=\"font-size:18px\">В этой статье мы расскажем и покажем, как обеспечить герметичность корпуса для электроники &mdash; сделать его непроницаемым для воды и пыли. Под катом вас ждет разбор стандарта IP с разными степенями защиты и сравнительный анализ методов герметизации на серийном производстве.&nbsp;</p>\n\n<p style=\"font-size:18px\">В первой части сфокусируемся на самом популярном материале &mdash; пластике &mdash; и посмотрим, как он себя проявляет при склейке, использовании уплотнителей и литье &mdash; многокомпонентном и перевормовке (overmolding). Во второй части разберем пять видов сварки. Этот метод герметизации подходит не только для металла, но и для термопластов.&nbsp;</p>\n\n<p style=\"font-size:18px\">В конце каждой части будет наглядная таблица, которая поможет выбрать оптимальную технологию для вашего проекта, с учетом всех &laquo;за&raquo; и &laquo;против&raquo;. Поехали!</p>\n\n<h2>Коды IP: защита от проникновения влаги и пыли &nbsp;&nbsp;</h2>\n\n<p style=\"font-size:18px\">Вы наверняка знакомы с IP-кодами (Ingress Protection Codes), которые показывают способность корпуса устройства пропускать твердые частицы и влагу, поэтому не будем задерживаться на этой теме.&nbsp;</p>\n\n<p style=\"font-size:18px\">Напомним только, что цифровая часть IP-кода состоит из двух цифр &mdash;&nbsp;IPXХ. Например, IP68. Первая цифра показывает степень защиты человека от частей, проводящих ток, а электроники внутри устройства &mdash; от твердых частиц. Этот показатель варьируются от 1 до 6.</p>\n\n<p style=\"font-size:18px\">Расшифровка степеней защиты от твердых частей</p>\n\n<p style=\"font-size:18px\">Расшифровка степеней защиты от твердых частей</p>\n\n<p style=\"font-size:18px\">Вторая цифра от 0 до 9 показывает степень защищенности устройства от влаги.&nbsp;</p>\n\n<p style=\"font-size:18px\">Расшифровка степеней защиты от влаги</p>\n\n<p style=\"font-size:18px\">Начиная с пятого уровня, на котором предусмотрена защита от струи воды, для обеспечения герметичности корпуса необходимо уплотнение. Ниже рассмотрим, как его можно обеспечить на серийном производстве корпусов из разных материалов.&nbsp;</p>\n\n<h2>Многокомпонентное литье под давлением</h2>\n\n<p style=\"font-size:18px\">Начнем с одного из самых популярных методов производства корпуса &mdash; многокомпонентного литья. Эта технология позволяет комбинировать несколько термопластов внутри одной литьевой формы &mdash; так дешевле и проще. Сборка не требуется, т.к. компоненты корпуса &laquo;спекаются&raquo; прямо в пресс-форме.</p>\n\n<p style=\"font-size:18px\">При производстве таких корпусов используются специальные термопластавтоматы (ТПА) с двумя резервуарами и двумя шнеками для разных материалов:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Горизонтальный ТПА для многокомпонентного литья полимеров тайваньской компании Jonwai\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/827/3ec/f4d/8273ecf4d5a3f99eda7d0f9c64aabaf3.jpg\" style=\"height:531px; width:1000px\" title=\"Горизонтальный ТПА для многокомпонентного литья полимеров тайваньской компании Jonwai\" /></p>\n\n<p style=\"font-size:18px\">Горизонтальный ТПА для многокомпонентного литья полимеров тайваньской компании Jonwai</p>\n\n<p style=\"font-size:18px\">В процессе литья автомат впрыскивает расплав одного материала, поворачивает пресс-форму за счет специального модуля и добавляет в нее расплав второго материала:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Поворотная форма для многокомпонентного литья\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/392/d84/74d/392d8474d527b8678d93eba348ace7cd.jpeg\" style=\"height:900px; width:1600px\" title=\"Поворотная форма для многокомпонентного литья\" /></p>\n\n<p style=\"font-size:18px\">Поворотная форма для многокомпонентного литья</p>\n\n<p style=\"font-size:18px\">Такая технология позволяет отказаться от прокладки уплотнителя и отлить его прямо в корпусе &mdash; в качестве второго материала. Так получается герметичный пластмассовый корпус с хорошей адгезией, т.е. сцеплением материалов:&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\"><img alt=\"1 — Заливка уплотнителя методом многокомпонентного литья. \n2 — Заливка детали по контуру эластичным материалом\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/daf/1b3/ff5/daf1b3ff50f48438e0ae022e05908f12.png\" style=\"height:2492px; width:5001px\" title=\"1 — Заливка уплотнителя методом многокомпонентного литья. \n2 — Заливка детали по контуру эластичным материалом\" /></p>\n\n<p style=\"font-size:18px\">1 &mdash; Заливка уплотнителя методом многокомпонентного литья. 2 &mdash; Заливка детали по контуру эластичным материалом</p>\n\n<p style=\"font-size:18px\">А еще многокомпонентное литье позволяет реализовать любые фантазии дизайнера с разными материалами, цветами и фактурой. Конечно, при этом усложняется и сама разработка пресс-формы для корпуса: инженерам и технологам нужно учитывать узлы впрыска, а производителю &mdash; настраивать систему управления.</p>\n\n<p style=\"font-size:18px\">Стоимость производства по этой технологии постепенно снижается, в том числе за счет того, что производители делают литьевые машины модульными, с возможностью комплектации под конкретные задачи.&nbsp;</p>\n\n<p style=\"font-size:18px\">Рассмотрим использование этого метода на конкретных примере:&nbsp;</p>\n\n<h3>Проект 1. Герметичный корпус эхолота с защитой по IP67</h3>\n\n<p style=\"font-size:18px\"><img alt=\"Эхолот с герметичным корпусом\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/6cf/72e/208/6cf72e208b20baa889e9e725b8c9c43d.jpeg\" style=\"height:809px; width:1600px\" title=\"Эхолот с герметичным корпусом\" /></p>\n\n<p style=\"font-size:18px\">Эхолот с герметичным корпусом</p>\n\n<p style=\"font-size:18px\">Устройство рассчитано на жесткие условия эксплуатации: температуры вплоть до &minus;30℃, защита от воды и пыли по стандарту IP67, устойчивость к ударам и падению с высоты 1,5 м на твердую поверхность.</p>\n\n<p style=\"font-size:18px\">Как эта инженерная задача была реализована на практике: стекло из материала ПММА мы используем в качестве закладной детали, а сверху заливаем пластик (PC). Полученную пластиковую деталь со стеклом обливаем резиной (TPU), которая также формирует эластичные кнопки, служит защитным бампером и обеспечивает герметичности корпуса при сборке с нижней деталью, которая производится по аналогии (тоже с закладными деталями, но уже без стекла).</p>\n\n<p style=\"font-size:18px\"><img alt=\"Стекло имеет штифты, которые предохраняют от сдвига и коробления в процессе заливки вторым компонентом\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/b4f/080/686/b4f080686d037f28cf27f75267afd1cf.jpeg\" style=\"height:451px; width:691px\" title=\"Стекло имеет штифты, которые предохраняют от сдвига и коробления в процессе заливки вторым компонентом\" /></p>\n\n<p style=\"font-size:18px\">Стекло имеет штифты, которые предохраняют от сдвига и коробления в процессе заливки вторым компонентом</p>\n\n<p style=\"font-size:18px\">В корпусе использованы специальные винты по пластмассе:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Такие винты по пластмассе дают необходимое усилие для достижения герметичности\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/64b/7f9/17f/64b7f917f6772d4baa17a7929327f9c4.jpeg\" style=\"height:1012px; width:1600px\" title=\"Такие винты по пластмассе дают необходимое усилие для достижения герметичности\" /></p>\n\n<p style=\"font-size:18px\">Такие винты по пластмассе дают необходимое усилие для достижения герметичности</p>\n\n<p style=\"font-size:18px\">В итоге технология двухкомпонентного литья на серийном производстве идеально подошла для решения задач проекта:&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/762/3ba/b98/7623bab98fb931c956f746b7bf48fe65.jpeg\" style=\"height:630px; width:1134px\" /></p>\n\n<h2>Овермолдинг (overmolding)</h2>\n\n<p style=\"font-size:18px\">Еще более доступный по цене метод &mdash; овермолдинг, он же переформовка. Отличается от многокомпонентного литья тем, что материалы соединяются не в одном производственном цикле, а в двух последовательных.&nbsp;</p>\n\n<p style=\"font-size:18px\">Для переформовки используют обычную машину для литья под давлением, но производят две формы: в первой форме получают первую деталь &ndash; подложку, а затем перекладывают ее во вторую форму с дополнительной полостью, где поверх заливают другой компонент.</p>\n\n<p style=\"font-size:18px\">Овермолдинг можно также использовать для соединения двух половин корпуса или изготовления кнопок. Этот метод хорош тем, что отливку кнопок можно комбинировать с заливкой эластичного материала вокруг корпуса, повышая таким образом ударопрочность изделия.&nbsp;</p>\n\n<p style=\"font-size:18px\">Для отливки корпуса по технологии овермолдинг используют термопласты, резины или один и тот же материал разных цветов. В процессе производства два вещества связываются физически или химически.</p>\n\n<p style=\"font-size:18px\"><strong>Конструктору на заметку!&nbsp;</strong>При впрыске второго компонента подложка может смещаться, поэтому ее нужно зафиксировать по габаритам детали или предусмотреть дополнительные элементы, например, отверстия для фиксации на штифтах во второй форме.</p>\n\n<p style=\"font-size:18px\">При использовании нескольких термопластавтоматов манипуляторы автоматически перемещают детали из одной формы в другую. Они работают так быстро, что деталь не успевает остыть &mdash; так достигается хорошая адгезия материала.</p>\n\n<p style=\"font-size:18px\">Можно обойтись и одним автоматом, но тогда процесс будет сложнее и рискованнее. :-) После отливки нужного количества деталей в первой форме ставим на автомат вторую, прочищаем шнек от предыдущего материала и засыпаем новый. Для этих манипуляций потребуется достаточно много времени, за которое подложка успеет остыть и измениться в размерах из-за усадки материала. Это нужно будет учитывать при проектировании пресс-формы.&nbsp;</p>\n\n<p style=\"font-size:18px\">При сборке корпуса для крепежа стоит использовать металлические резьбовые вставки или специальные винты по пластмассе. При выборе второго материала важно достичь оптимального соотношения: материал должен быть достаточно эластичным для нажатия кнопки и герметизации, но в то же время иметь достаточную твердость для сопротивления истиранию.</p>\n\n<p style=\"font-size:18px\">И снова покажем технологию в действии:</p>\n\n<h3>Проект 2. Проектирование и производство корпуса для газоанализатора</h3>\n\n<p style=\"font-size:18px\"><img alt=\"Проработка конструкции в 3D — один из этапов разработки корпуса\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/e2f/eca/61d/e2feca61d76a39859ee153f13b39cc1b.jpeg\" style=\"height:648px; width:1387px\" title=\"Проработка конструкции в 3D — один из этапов разработки корпуса\" /></p>\n\n<p style=\"font-size:18px\">Проработка конструкции в 3D &mdash; один из этапов разработки корпуса</p>\n\n<p style=\"font-size:18px\">Здесь прозрачная подложка заливается эластичным материалом. Этот же эластичный материал используется для герметичных кнопок, достижения ударопрочности и в качестве уплотнения между деталями.&nbsp;</p>\n\n<p style=\"font-size:18px\"><img alt=\"Этап 1. Подложка с залитыми металлическими закладными элементами \" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/881/eff/857/881eff8574f58d6540108c67e3676719.jpeg\" style=\"height:387px; width:586px\" title=\"Этап 1. Подложка с залитыми металлическими закладными элементами \" /></p>\n\n<p style=\"font-size:18px\">Этап 1. Подложка с залитыми металлическими закладными элементами&nbsp;</p>\n\n<p style=\"font-size:18px\"><img alt=\"Этап 2. Так выглядит корпус после заливки вторым эластичным компонентом\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/104/85e/f4a/10485ef4a6792788b78461535db2d7e7.jpeg\" style=\"height:537px; width:1100px\" title=\"Этап 2. Так выглядит корпус после заливки вторым эластичным компонентом\" /></p>\n\n<p style=\"font-size:18px\">Этап 2. Так выглядит корпус после заливки вторым эластичным компонентом</p>\n\n<p style=\"font-size:18px\"><img alt=\"Для нужного уплотнительного натяга использованы металлические закладные элементы, которые также увеличивают срок службы соединения\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/d21/5ce/5d5/d215ce5d5afb61bc687e24de5723463d.jpeg\" style=\"height:536px; width:913px\" title=\"Для нужного уплотнительного натяга использованы металлические закладные элементы, которые также увеличивают срок службы соединения\" /></p>\n\n<p style=\"font-size:18px\">Для нужного уплотнительного натяга использованы металлические закладные элементы, которые также увеличивают срок службы соединения</p>\n\n<p style=\"font-size:18px\">Вот так это выглядит в разрезанной модели:</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/dcf/3e9/a28/dcf3e9a28bbd5dbba418f844a6edb4f5.png\" style=\"height:602px; width:612px\" /></p>\n\n<h3>Проект 3. Разработка герметичного корпуса глубиномера для рыбалки</h3>\n\n<p style=\"font-size:18px\"><img alt=\"Корпус эхолота, изготовленный по технологии переформивки (овермолда)\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/7ad/381/ec4/7ad381ec4ebaf26461236e2c0eb51618.jpeg\" style=\"height:848px; width:1600px\" title=\"Корпус эхолота, изготовленный по технологии переформивки (овермолда)\" /></p>\n\n<p style=\"font-size:18px\">Корпус эхолота, изготовленный по технологии переформивки (овермолда)</p>\n\n<p style=\"font-size:18px\">Для устройства потребовалась герметичная кнопка. Для этого эластичный полимер был залит прямо в отлитый корпус.&nbsp;</p>\n\n<p style=\"font-size:18px\">Далее в корпус устанавливается плата, а поверх нее &mdash; экран. Защитное стекло для экрана фиксируется на специальный двухсторонний скотч 3М:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Компоненты корпуса глубиномера на разных этапах разработки и прототипирования\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/518/6a3/393/5186a339349c4e2b2e9b5c94d70163b6.jpeg\" style=\"height:1053px; width:1600px\" title=\"Компоненты корпуса глубиномера на разных этапах разработки и прототипирования\" /></p>\n\n<p style=\"font-size:18px\">Компоненты корпуса глубиномера на разных этапах разработки и прототипирования</p>\n\n<p style=\"font-size:18px\">В этом проекте были сложности с подводкой литника для кнопки, поскольку литник должен быть изнутри кнопки, а пластиковая деталь представляет собой глубокий цилиндр. Мы решили эту задачу за счет изготовления сложного разрезного подвижного пуансона (что это?):</p>\n\n<p style=\"font-size:18px\"><img alt=\"Модель сложного разрезного подвижного пуансона\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/5bb/54b/917/5bb54b917e04dbbafb906302fcacda60.png\" style=\"height:687px; width:502px\" title=\"Модель сложного разрезного подвижного пуансона\" /></p>\n\n<p style=\"font-size:18px\">Модель сложного разрезного подвижного пуансона</p>\n\n<h2>Использование уплотнителя для герметизации корпуса</h2>\n\n<p style=\"font-size:18px\">А теперь рассмотрим последний на сегодня метод создания герметичного устройства &mdash; самый простой и дешевый &mdash; уплотнитель для защиты от влаги.&nbsp;</p>\n\n<p style=\"font-size:18px\">Уплотнитель бывает с круглым и прямоугольным сечением. Как он работает: резиновые кольца закладывают в канавки, при создании натяга ответной деталью резинка деформируется и заполняет канавку.&nbsp;</p>\n\n<p style=\"font-size:18px\">Уплотнитель может иметь клейкую поверхность и приклеиваться к поверхности корпуса. Закладные резинки можно использовать как в пластиковых, так и в металлических корпусах.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Четыре варианта использования уплотнителей в корпусе устройства\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/41e/0ee/ae8/41e0eeae859d6c933444f8ffae42f2b2.jpeg\" style=\"height:1098px; width:1600px\" title=\"Четыре варианта использования уплотнителей в корпусе устройства\" /></p>\n\n<p style=\"font-size:18px\">Четыре варианта использования уплотнителей в корпусе устройства</p>\n\n<p style=\"font-size:18px\"><strong>Примеры уплотнителей на картинке выше:</strong></p>\n\n<ol>\n\t<li>\n\t<p style=\"font-size:18px\">Прямоугольное резиновое уплотнение закладывается в канавку.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Круглое резиновое уплотнение закладывается в канавку.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Уплотнение слоем с натягом.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Уплотнение с клейким слоем.</p>\n\t</li>\n</ol>\n\n<p style=\"font-size:18px\">Если путь прокладки уплотнителя длинный, то используют шнур. Концы шнура обрезают под острым углом, чтобы увеличить площадь среза, а затем склеивают эластичным клеем.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Склеенный срез эластичного шнура\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/755/665/913/755665913ea4f9b6cea3f0fe3b8d1aa6.png\" style=\"height:276px; width:902px\" title=\"Склеенный срез эластичного шнура\" /></p>\n\n<p style=\"font-size:18px\">Склеенный срез эластичного шнура</p>\n\n<p style=\"font-size:18px\">Уплотнители широко используются для разборных корпусов, которые подлежат ремонту или содержат в себе сменную батарею. Для неразборных герметичных стоит рассмотреть другие технологии &mdash; такие как сварка и склейка, но о них мы поговорим уже во второй части.</p>\n\n<p style=\"font-size:18px\">А пока &mdash; последний на сегодня разбор примера:</p>\n\n<h3>Проект 4. Разработка корпуса рации для кайтсерфинга</h3>\n\n<p style=\"font-size:18px\"><img alt=\"Рация с MP3-плеером для серфинга, кайтсерфинга и виндсерфинга\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/3a3/164/139/3a316413964f2108da0b5c83be9e438a.jpeg\" style=\"height:808px; width:1600px\" title=\"Рация с MP3-плеером для серфинга, кайтсерфинга и виндсерфинга\" /></p>\n\n<p style=\"font-size:18px\">Рация с MP3-плеером для серфинга, кайтсерфинга и виндсерфинга</p>\n\n<p style=\"font-size:18px\">Итак, перед нами проект цифровой рации с MP3-плеером для водных видов спорта . Нужно обеспечить высокую защиту от внешних воздействий по стандарту IP67. Требуются минимальный вес и габариты, простое кнопочное управление + одна аварийная кнопка.</p>\n\n<p style=\"font-size:18px\">Как это можно реализовать: возьмем эластичный материал для герметичных кнопок и бамперов на фронтальной и боковых сторонах.&nbsp;</p>\n\n<p style=\"font-size:18px\">Для герметизации периметра и динамика используем уплотнители:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Корпус рации с металлическими закладными элементами\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/46b/4a7/1d6/46b4a71d6871da1611c1580fd40c469e.png\" style=\"height:456px; width:744px\" title=\"Корпус рации с металлическими закладными элементами\" /></p>\n\n<p style=\"font-size:18px\">Корпус рации с металлическими закладными элементами</p>\n\n<p style=\"font-size:18px\"><img alt=\"Заливка фронтальных кнопок эластичным материалом\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/003/0a3/f49/0030a3f49e846c8cca43cbcb14448ab4.png\" style=\"height:454px; width:785px\" title=\"Заливка фронтальных кнопок эластичным материалом\" /></p>\n\n<p style=\"font-size:18px\">Заливка фронтальных кнопок эластичным материалом</p>\n\n<p style=\"font-size:18px\"><img alt=\"Использование специального разъема с защитой IP67 . Уплотнитель разъема заходит с натягом в отверстие корпуса.\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/20d/0a3/2a1/20d0a32a10072fdcbbeaa43e7e090c4c.png\" style=\"height:691px; width:775px\" title=\"Использование специального разъема с защитой IP67 . Уплотнитель разъема заходит с натягом в отверстие корпуса.\" /></p>\n\n<p style=\"font-size:18px\">Использование специального разъема с защитой IP67 . Уплотнитель разъема заходит с натягом в отверстие корпуса.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Герметизация динамика с защитой IP67 \" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/db2/a3e/ad9/db2a3ead9d7c8d725a798566f47c86a5.png\" style=\"height:455px; width:872px\" title=\"Герметизация динамика с защитой IP67 \" /></p>\n\n<p style=\"font-size:18px\">Герметизация динамика с защитой IP67&nbsp;</p>\n\n<p style=\"font-size:18px\">И вот, что получилось в итоге на производстве:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Герметизация периметра с помощью уплотнения, которое также герметизирует винты\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/db2/687/7f8/db26877f81106fd979bb5b4ca7f84d9b.jpeg\" style=\"height:765px; width:1073px\" title=\"Герметизация периметра с помощью уплотнения, которое также герметизирует винты\" /></p>\n\n<p style=\"font-size:18px\">Герметизация периметра с помощью уплотнения, которое также герметизирует винты</p>\n\n<h2>Выводы</h2>\n\n<p style=\"font-size:18px\">На выбор идеального метода герметизации устройства для конкретного проекта влияет множество факторов: требования к конструкции, возможности производства, размер партии, предполагаемая стоимость, условия эксплуатации и другие. И, как видно по представленным примерам, методы можно комбинировать.&nbsp;</p>\n\n<p style=\"font-size:18px\">Вот сводная таблица с характеристиками трех технологий, которые мы разобрали в первой части статьи:</p>\n\n<table>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\"><strong>Метод герметизации</strong></p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\"><strong>Оборудование</strong></p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\"><strong>Преимущества</strong></p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\"><strong>Недостатки</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Много-компонентное литье</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">ТПА с двумя узлами впрыска и дорогая оснастка</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Низкая стоимость при массовом производстве, нет доп. затрат на герметизацию</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Неэффективно при малых сериях. Нужно дорогое оборудование, оснастка и персонал высокой квалификации</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Овермолдинг</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">ТПА и несколько комплектов оснастки</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Альтернатива многокомпонентному литью. За счет более простого оборудования технология доступней по цене на мелких партиях</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Затраты на манипулятор или ручной труд</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Использование уплотнителя</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Не требуется</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Низкая стоимость, не нужно оборудование</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Дополнительная операция при сборке (установка уплотнений), нужен крепеж в зоне уплотнения</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"font-size:18px\">Но это еще не все. Во второй части статьи мы рассмотрим пять видов сварки &mdash; горячей плитой, электромагнитную, вибрационную, ультразвуковую и лазерную, &mdash; которые применяются не только для металлов, но также для термопластов.&nbsp;</p>\n\n<p style=\"font-size:18px\">Так что наша &mdash; и ваша &mdash; справочная таблица по герметизации будет дополнена новыми методами.&nbsp;<a href=\"https://habr.com/ru/users/Promwad/\" rel=\"noopener noreferrer nofollow\"><u>Подписывайтесь на обновления</u></a>, чтобы не пропустить вторую часть.&nbsp;</p>\n\n<p style=\"font-size:18px\">Надеемся, наш опыт разработки герметичных корпусов будет для вас полезен (увидим это по вашим комментариям и голосам за статью). Задавайте вопросы, делитесь идеями &mdash; будем рады пообщаться.&nbsp;</p>",
    "author": "sidorov",
    "category": "разработка",
    "image": "d75aab49fb9cc09b62b7b1b46f1d16cc.png",
    "status": "draft",
    "comment_moderator": "",
    "moderator_id": "",
    "published_at": ""
  },
  {
    "title": "Как подружить helm со своим шаблонизатором?",
    "preview": "Helm использует go templates для рендеринга манифестов. Есть функции, которые были разработаны специально для helm. Но в большинстве своем используется библиотека Sprig.\n\nНо что, если нам мало функций и мы хотим воспользоваться каким-нибудь своим кастомным шаблонизатором?",
    "body": "<p style=\"text-align:justify; font-size:18px\">Helm использует&nbsp;<a\n        href=\"https://pkg.go.dev/text/template\"\n        rel=\"noopener noreferrer nofollow\">go templates</a>&nbsp;для рендеринга\n    манифестов. Есть функции, которые были разработаны специально для helm. Но\n    в большинстве своем используется библиотека&nbsp;<a\n            href=\"http://masterminds.github.io/sprig/\"\n            rel=\"noopener noreferrer nofollow\">Sprig</a>.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/e9c/8e7/e28/e9c8e7e28cdf05808d18569bdd853e05.jpg\"\n        style=\"width:1280px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Но что, если нам мало функций и мы хотим\n    воспользоваться каким-нибудь своим кастомным шаблонизатором?</p>\n\n<p style=\"text-align:justify; font-size:18px\">В этой статье я покажу пример, как подключить\n    шаблонизатор&nbsp;<code>gomplate</code>. Но это не помешает вам\n    использовать какой-нибудь другой. Принципы одинаковые.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><code>gomplate</code>&nbsp;содержит огромное\n    количество функций по работе со строками, сетью, криптографией и т.д.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Одна из киллер-фичей &ndash; получать данные из\n    разных источников: файлы, https, git, ssh, AWS EC2 metadata, AWS Secret\n    Manager,&nbsp;<a href=\"https://pkg.go.dev/go.etcd.io/bbolt\"\n                     rel=\"noopener noreferrer nofollow\">BoltDB</a>,&nbsp;<a\n            href=\"https://www.consul.io/\" rel=\"noopener noreferrer nofollow\">Hashicorp\n        Consul</a>&nbsp;и&nbsp;<a href=\"https://www.vaultproject.io/\"\n                                  rel=\"noopener noreferrer nofollow\">Hashicorp\n        Vault</a>.</p>\n\n<h3 style=\"text-align:justify\">Подготовка</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Для начала надо установить&nbsp;<code>helm</code>&nbsp;и&nbsp;<code>gomplate</code>&nbsp;,\n    если они еще не установлены.</p>\n\n<pre style=\"text-align:justify\">\n<code>$ brew install helm\n$ brew install gomplate</code></pre>\n\n<p style=\"text-align:justify; font-size:18px\">Первая сложность:&nbsp;<a\n        href=\"https://github.com/hairyhenderson/gomplate\"\n        rel=\"noopener noreferrer nofollow\">gomplate</a>&nbsp;и helm используют\n    одинаковые кавычки-разделители&nbsp;<code>\n        {{</code>&nbsp;и&nbsp;<code>}}</code>&nbsp;для шаблонов.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Можно было бы начать их экранировать. Но это ни к\n    чему хорошему не приведет. Будет много некрасивого кода и кавычек. Поэтому\n    проще назначить другие кавычки для&nbsp;<code>gomplate</code>.</p>\n\n<pre style=\"text-align:justify\">\n<code>export GOMPLATE_LEFT_DELIM=&quot;[[&quot;\nexport GOMPLATE_RIGHT_DELIM=&quot;]]&quot;</code></pre>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Тестируем:</strong></p>\n\n<pre style=\"text-align:justify\">\n<code>echo &#39;Hello, [[ .Env.USER ]]&#39; | gomplate\nHello, zhilyaev</code></pre>\n\n<h3 style=\"text-align:justify\">Создаем helm chart</h3>\n\n<pre style=\"text-align:justify\">\n<code># [[ defineDatasource &quot;foo&quot; &quot;https://httpbin.org/get&quot; ]]  \n# [[ if not (datasourceReachable &quot;foo&quot;)]] unreachable [[end]]\n# [[ $d := ds &quot;foo&quot; ]]  \napiVersion: v1  \nkind: ConfigMap  \nmetadata:  \n  name: {{ include &quot;this.fullname&quot; . }}  \n  labels: {{ include &quot;this.labels&quot; . | nindent 4 }}  \ndata:  \n  random: &quot;[[ random.AlphaNum 32 ]]&quot;  \n  host: &quot;[[ $d.headers.Host ]]&quot;\n</code></pre>\n\n<p style=\"text-align:justify; font-size:18px\">Переходим к основной части. Helm имеет флажок&nbsp;<code>--post-renderer</code>&nbsp;его\n    мы и будем жадно абузить.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img alt=\"Диаграмма работы\"\n                                   src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/719/1f1/2d5/7191f12d53cfa88e6b639d0f5ba9fa76.png\"\n                                   style=\"width:1152px\"\n                                   title=\"Диаграмма работы\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Диаграмма работы</p>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Запускаем:</strong></p>\n\n<p style=\"text-align:justify; font-size:18px\">helm template this chart --post-renderer\n    gomplate</p>\n\n<pre style=\"text-align:justify\">\n<code># Source: this/templates/configmap.yaml\n#\n# \n# \napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: this\n  labels:\n    helm.sh/chart: this-0.1.0\n    app.kubernetes.io/name: this\n    app.kubernetes.io/instance: this\n    app.kubernetes.io/version: &quot;1.16.0&quot;\n    app.kubernetes.io/managed-by: Helm\ndata:\n  random: &quot;2tJyK9xSsg1gvEmunEokQf4lyGkvojiQ&quot;\n  host: &quot;httpbin.org&quot;\n</code></pre>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Деплоим:</strong></p>\n\n<pre style=\"text-align:justify\">\n<code>helm upgrade --install this chart --post-renderer gomplate</code></pre>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Profit</strong></p>\n\n<h3 style=\"text-align:justify\">Послесловие</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Внедрение&nbsp;<code>--post-renderer</code>&nbsp;вносит\n    дополнительную сложность. Cледуя принципам KISS, попробуйте&nbsp;<a\n            href=\"https://github.com/helmwave/helmwave\"\n            rel=\"noopener noreferrer nofollow\">helmwave</a>. В нем мы решаем\n    повседневные проблемы при работе с helm, не вмешиваясь в функционал чартов.\n</p>",
    "author": "petrov",
    "category": "администрирование",
    "image": "e9c8e7e28cdf05808d18569bdd853e05.jpg",
    "status": "moderation",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": ""
  },
  {
    "title": "Миграция данных из различных RDBMS в HADOOP",
    "preview": "В статье будет рассмотрен процесс экспорта данных в Hadoop из различных РСУБД посредством фреймворка Spark. Для взаимодействия с фреймворком Spark будет использован язык программирования Python с применением api pySpark.",
    "body": "<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/851/d0f/07b/851d0f07bb84cc9d09955d635aa29d1f.png\" style=\"height:541px; width:958px\" /></p>\n\n<p style=\"font-size:18px\">В статье будет рассмотрен процесс экспорта данных в Hadoop из различных РСУБД посредством фреймворка Spark. Для взаимодействия с фреймворком Spark будет использован язык программирования Python с применением api pySpark.</p>\n\n<h2>Основные понятия</h2>\n\n<ul>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Реляционная СУБД (Relational Database Management System, RDBMS)</strong>&nbsp;&ndash; это система, обеспечивающая доступ к реляционной базе данных, в основе которой лежат данные, хранящиеся в табличном виде;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Apache Hadoop</strong>&nbsp;&ndash; это коллекция утилит, библиотек и фреймворк с открытым исходным кодом, предназначенных для разработки и выполнения распределенных программ, работающих на кластерах из множества узлов;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Apache Spark</strong>&nbsp;&ndash; фреймворк для распределенной пакетной и потоковой обработки больших неструктурированных и слабоструктурированных данных, с открытым исходным кодом, входящий в экосистему Hadoop.</p>\n\t</li>\n</ul>\n\n<h3>Взаимодействие SPARK с Реляционными СУБД</h3>\n\n<p style=\"font-size:18px\">В основе взаимодействия фреймворка Spark с реляционными базами данных лежит JDBC (Java Database Connectivity) Driver, реализованный на языке Java. При использовании JDBC происходит подключение к базе данных по специальному URL, который включает в себя адрес сервера и порт, по которому происходит отправка запросов.</p>\n\n<p style=\"font-size:18px\">Для того, чтобы приступить к реализации взаимодействия Spark и RDBMS, сначала необходимо сконфигурировать базовые свойства создаваемого application при создании SparkSession:</p>\n\n<ul>\n\t<li>\n\t<p style=\"font-size:18px\">executors (количество исполнителей) &ndash; параллельные процессы, отвечающие за выполнение Spark Tasks.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">executor cores (количество ядер для каждого исполнителя) &ndash; максимальное количество параллельно выполняемых задач, на одном исполнителе.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">executor memory (память, выделяемая для каждого исполнителя) &ndash; количество ОЗУ, выделяемое системой на одного исполнителя.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">driver memory (память, выделяемая для драйвера) &ndash; количество ОЗУ, выделяемое для драйвера Spark.</p>\n\t</li>\n</ul>\n\n<p style=\"font-size:18px\"><strong>SparkSession</strong>&nbsp;&ndash; это способ инициализации базовой функциональности API (точка входа) для программного создания RDD, Dataframe и Dataset.</p>\n\n<p style=\"font-size:18px\">Рассмотрим пример, отвечающий за конфигурирование базовых свойств создаваемого application и создание SparkSession:</p>\n\n<pre>\n<code>from pyspark.sql import SparkSession\n\nspark = SparkSession.builder \\\n  .config(&quot;spark.executor.instances&quot;, &quot;2&quot;) \\\n  .config(&quot;spark.executor.cores&quot;, &quot;2&quot;) \\\n  .config(&quot;spark.executor.memory&quot;, &quot;2g&quot;) \\\n  .config(&quot;spark.driver.memory&quot;, &quot;4g&quot;) \\\n  .appName(&quot;application_name&quot;) \\\n  .getOrCreate()</code></pre>\n\n<p style=\"font-size:18px\">Теперь, когда SparkSession создана, можно приступать к отправлению запросов в базу данных.</p>\n\n<p style=\"font-size:18px\">Основные опции JDBC для взаимодействия с базой данных:</p>\n\n<table>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">№</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Название опции</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Описание</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Ограничения</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">1</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">url</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">URL-адрес для подключения к базе данных по JDBC</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">2</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">dbtable</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Таблица или запрос, обернутый в скобки, который может быть добавлен в блок FROM SQL- запроса</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">3</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">query</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Запрос, который будет обернут в скобки и вставлен в блок FROM в качестве подзапроса.</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">4</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">partitionColumn</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Описание того, как разделить таблицу при параллельном чтении. Название колонки по которой будет проводиться разделение объекта.</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Идет в группе с опциями 5, 6 и 7. Столбец раздела должен быть цифровым столбцом, датой или меткой времени из рассматриваемой таблицы.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">5</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">lowerBound</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Описание того, как разделить таблицу при параллельном чтении. Нижняя граница колонки по которой будет проводить разделение объекта. Используется для задания шага раздела, а не фильтрации данных. P.S.: более подробное описание опций будет рассмотрено на примерах в статье.</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Идет в группе с опциями 4, 6 и 7</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">6</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">upperBound</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Описание того, как разделить таблицу при параллельном чтении. Верхняя граница колонки по которой будет проводить разделение объекта. Используется для задания шага раздела, а не фильтрации данных. P.S.: более подробное описание опций будет рассмотрено на примерах в статье.</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Идет в группе с опциями 4, 5 и 7</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">7</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">numPartitions</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Максимальное количество разделов, которые можно использовать для параллелизма при чтении таблицы. Это также определяет максимальное количество одновременных подключений JDBC. P.S.: более подробное описание опций будет рассмотрено на примерах в статье.</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Идет в группе с опциями 4, 5 и 6</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">8</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">fetchsize</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Размер выборки JDBC, который определяет, сколько строк нужно извлекать за один проход. Это может повысить производительность драйверов JDBC, которые по умолчанию имеют низкий размер выборки (например, для ORACLE с 10 строками)</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">9</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">user</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Пользователь, из-под которого происходит подключение к базе данных.</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">10</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">password</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Пароль к пользователю (из опции 9)</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"font-size:18px\">Для того, чтобы отправить запрос в базу, необходимо выбрать формат соединения. Форматом, отвечающим за соединения с базой данных является JDBC. После того, как был выбран формат, необходимо добавить опции, которые предоставят нужную информацию для подключения к БД, инициализируют требуемый запрос и, при необходимости, сообщат драйверу о том, каким образом необходимо произвести чтение данных из БД.</p>\n\n<p style=\"font-size:18px\">Рассмотрим пример, иллюстрирующий отправку запроса в базу данных:</p>\n\n<pre>\n<code>dataframe = spark.read.format(&quot;jdbc&quot;) \\\n    .option(&quot;url&quot;, &quot;jdbc:oracle:thin:@127.0.0.1:1521/testdb&quot;) \\\n  .option(&quot;dbtable&quot;, &quot;myOwner.myTableName&quot;) \\\n  .option(&quot;partitionColumn&quot;, &quot;ID&quot;) \\\n  .option(&quot;lowerBound&quot;, 1) \\\n  .option(&quot;upperBound&quot;, 1000) \\\n  .option(&quot;numPartitions&quot;, 10) \\\n  .option(&quot;fetchsize&quot;, 100) \\\n  .option(&quot;user&quot;, &quot;myUser&quot;) \\\n  .option(&quot;password&quot;, &quot;myPass&quot;) \\\n  .load()</code></pre>\n\n<p style=\"font-size:18px\">Мы видим, что&nbsp;<code>spark</code>, используя&nbsp;<code>JDBC</code>&nbsp;драйвер, пытается подключиться к БД&nbsp;<code>jdbc:oracle:thin:@127.0.0.1:1521/testdb</code>&nbsp;и прочитать из нее&nbsp;<code>myOwner.myTableName</code>, при этом используя разделение таблицы по колонке&nbsp;<code>ID</code>&nbsp;на&nbsp;<code>10</code>&nbsp;разделов, для возможности параллельного чтения, где нижняя граница колонки ID =&nbsp;<code>1</code>, верхняя граница =&nbsp;<code>1000</code>. При этом размер выборки JDBC будет равняться&nbsp;<code>100</code>&nbsp;строкам.</p>\n\n<p style=\"font-size:18px\">После того, как выполнится выше представленный код, мы получим НЕ данные из этой таблицы, а фрейм данных (dataframe).&nbsp;<strong>Dataframe</strong>&nbsp;&ndash; это абстракция данных в SparkSQL, которые организованы в строки и типизированы по столбцам. Получая фрейм данных, мы можем узнать информацию о:</p>\n\n<ul>\n\t<li>\n\t<p style=\"font-size:18px\">названиях полей объекта;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">типах полей объекта;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">свойстве nullable полей объекта.</p>\n\t</li>\n</ul>\n\n<pre>\n<code>fields = dataframe.schema.fields\nnames = [_.name.lower() for _ in fields] #названия полей объекта\ntypes = [_.dataType for _ in fields] # типы полей объекта\nnullable = [_.nullable for _ in fields] # свойство nullable полей объекта</code></pre>\n\n<p style=\"font-size:18px\">Когда фрейм данных получен, мы можем перейти к записи данных в Hadoop Distributed File System (HDFS). Для этого необходимо вызвать у dataframe метод write, после чего объявить формат выходных данных (parquet, orc, csv, avro, etc), при необходимости добавить опции для записи и вызвать метод save().</p>\n\n<p style=\"font-size:18px\">Рассмотрим наиболее часто встречаемые опции/методы для записи:</p>\n\n<table>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">№</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Название</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Тип</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Описание</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Ограничения</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">1</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">compression</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">опция</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">кодек сжатия, используемый при сохранении фрейма данных в файл. Наиболее распространенные кодеки: none, bzip2, gzip, snappy и др. Самым популярным кодеком для сжатия является snappy: он<em>&nbsp;не нацелен на максимальное сжатие или совместимость с любой другой библиотекой сжатия. Вместо этого, он нацелен на увеличение скорости при работе со сжатыми файлами и разумное сжатие.</em>&nbsp;Более подробно можно почитать по ссылке:&nbsp;<a href=\"http://google.github.io/snappy/\">http://google.github.io/snappy/</a></p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">2</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">partitionBy(*cols)</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">метод</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">метод, применяемый для партицирования по заданным наименованиям колонок</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">3</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">mode(str)</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">метод</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">режим записи данных. Наиболее часто используемые: overwrite (перезапись)/append (дозапись)</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">4</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">delimiter</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">опция</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">задает один символ в качестве разделителя для каждого поля и значения. Если значение не задано, используется значение по умолчанию &quot;,&quot;</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Применяется для формата csv</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">5</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">header</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">опция</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">использует первую строку в качестве имен столбцов. Если значение не задано, используется значение по умолчанию false.</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Применяется для формата csv</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">6</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">inferSchema</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">опция</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">автоматически формирует схему из входных данных. Для определения будет выполняться один дополнительный проход по данным. Если значение не задано, используется значение по умолчанию false.</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Применяется для формата csv</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">7</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">repartitoin(numPartitions, *cols)</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">метод</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">возвращает новый фрейм данных, который разделен по хешу. Целочисленный параметр numPartitions указывает целевое количество разделов. Строковый параметр&nbsp;<em>*cols&nbsp;</em>задает столбец, по которому будет произведено деление данных. Метод используется для увеличения или уменьшения выходных разделов. При использовании будет произведено полное перемешивание данных и создаются разделы одинакового размера.</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">8</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">coalesce(numPartitions)</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">метод</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">возвращает новый фрейм данных, разделенный на numPartitions разделов. Целочисленный параметр numPartitions указывает целевое количество разделов. Метод используется для увеличения или уменьшения выходных разделов, но при этом создает разделы с разным объемом данных за счет объединения уже имеющихся разделов. При использовании не будет произведено полное перемешивание данных.</p>\n\t\t\t</td>\n\t\t\t<td>&nbsp;</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"font-size:18px\">Когда дело доходит до выбора формата хранения данных, разработчики часто бросают свой взгляд в сторону parquet файлов.&nbsp;<strong>Parquet</strong>&nbsp;&ndash; это бинарный, колоночно-ориентированный формат хранения данных, изначально созданный для экосистемы hadoop.</p>\n\n<p style=\"font-size:18px\"><em>Достоинства хранения данных в Parquet:</em></p>\n\n<ul>\n\t<li>\n\t<p style=\"font-size:18px\"><em>это файлы, а значит с ними легко работать, перемещать, бэкапить и реплицировать;</em></p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><em>колончатый вид позволяет значительно ускорить работу аналитика, если ему не нужны все колонки сразу;</em></p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><em>нативная поддержка в Spark из коробки обеспечивает возможность просто взять и сохранить файл в любимое хранилище;</em></p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><em>эффективное хранение с точки зрения занимаемого места;</em></p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><em>обеспечивает самую быструю работу чтения по сравнению с использованием других файловых форматов.</em></p>\n\t</li>\n</ul>\n\n<p style=\"font-size:18px\">Более подробную информацию о формате PARQUET можно почитать по ссылке:&nbsp;<a href=\"https://parquet.apache.org/documentation/latest/\">https://parquet.apache.org/documentation/latest/</a></p>\n\n<p style=\"font-size:18px\">Рассмотрим пример записи полученного фрейма данных в HDFS в формат Parquet:</p>\n\n<pre>\n<code>dataframe.repartition(2).write \\\n  .mode(&quot;overwrite&quot;) \\\n  .partitionBy(&quot;myColumn&quot;) \\\n  .format(&quot;parquet&quot;) \\\n  .option(&quot;compression&quot;, &quot;snappy&quot;) \\\n  .save(&quot;/path/to/target/dir&quot;)</code></pre>\n\n<p style=\"font-size:18px\">Из примера выше мы видим, что полученный&nbsp;<code>dataframe</code>&nbsp;будет разделен на&nbsp;<code>2</code>&nbsp;равномерных раздела, после чего перед записью сотрет все данные (<code>overwrite</code>), имеющиеся по пути /path/to/target/dir, произведет партицирование по колонке&nbsp;<code>myColumn</code>&nbsp;и сохранит данные в формате&nbsp;<code>parquet</code>&nbsp;по пути&nbsp;<code>/path/to/target/dir</code>, применив сжатие&nbsp;<code>snappy</code>.</p>\n\n<h3>Анализ процесса миграции данных из различных RDBMS в HADOOP</h3>\n\n<p style=\"font-size:18px\">На наших проектах часто приходится решать задачи переноса больших данных между системами.<br />\nНапример, есть таблицы, содержащие десятки Тб данных, на основании которых необходимо построить различные аналитические витрины. Первым шагом является вынос данных из продуктивной среды бизнес-приложений в среду аналитических хранилищ, чтобы работа с этими данными не повлекла деградацию сервиса бизнес-приложений. Самый распространенный пример, когда бизнес приложения работают с некоторой РСУБД, а анализируются в Hadoop. Как можно выполнить процесс выноса данных в Hadoop с помощью Spark, мы увидим ниже.</p>\n\n<p style=\"font-size:18px\">Проанализируем процесс выполнения следующего кода:</p>\n\n<p style=\"font-size:18px\">Запрос создания/структура таблицы &quot;GRIGOREVDS.myTable&quot; в БД:</p>\n\n<pre>\n<code>create table GRIGOREVDS.myTable (\n        id         NUMBER,\n        field1     VARCHAR2(1000),\n        field2     NUMBER,\n        field3     VARCHAR2(1000),\n        field4     NUMBER,\n        field5     VARCHAR2(1000),\n        field6     NUMBER\n);</code></pre>\n\n<p style=\"font-size:18px\">Заполнение таблицы &quot;GRIGOREVDS.myTable&quot; 100 строками, где колонка &quot;ID&quot; имеет целочисленный тип данных с шагом 1:</p>\n\n<pre>\n<code>INSERT INTO GRIGOREVDS.myTable VALUES (1,&#39;field1&#39;,2,&#39;field3&#39;,4,&#39;field5&#39;,6);\nINSERT INTO GRIGOREVDS.myTable VALUES (2,&#39;field1&#39;,2,&#39;field3&#39;,4,&#39;field5&#39;,6);\nINSERT INTO GRIGOREVDS.myTable VALUES (3,&#39;field1&#39;,2,&#39;field3&#39;,4,&#39;field5&#39;,6);\nINSERT INTO GRIGOREVDS.myTable VALUES (4,&#39;field1&#39;,2,&#39;field3&#39;,4,&#39;field5&#39;,6);\nINSERT INTO GRIGOREVDS.myTable VALUES (5,&#39;field1&#39;,2,&#39;field3&#39;,4,&#39;field5&#39;,6);\n...\nINSERT INTO GRIGOREVDS.myTable VALUES (99,&#39;field1&#39;,2,&#39;field3&#39;,4,&#39;field5&#39;,6);\nINSERT INTO GRIGOREVDS.myTable VALUES (100,&#39;field1&#39;,2,&#39;field3&#39;,4,&#39;field5&#39;,6);</code></pre>\n\n<p style=\"font-size:18px\">Python скрипт &quot;migration.py&quot; экспорта данных из RDBMS в HDFS, использующий API pyspark:</p>\n\n<pre>\n<code>from pyspark.sql import SparkSession\n\nspark = SparkSession.builder \\\n    .config(&quot;spark.dynamicAllocation.enabled&quot;, &quot;false&quot;) \\\n    .config(&quot;spark.executor.instances&quot;, &quot;1&quot;) \\\n    .config(&quot;spark.executor.cores&quot;, &quot;2&quot;) \\\n    .config(&quot;spark.executor.memory&quot;, &quot;1g&quot;) \\\n    .config(&quot;spark.driver.memory&quot;, &quot;1g&quot;) \\\n    .appName(&quot;test_migration&quot;) \\\n    .getOrCreate()\n\ndf = spark.read.format(&quot;jdbc&quot;) \\\n    .option(&quot;url&quot;, &quot;jdbc:oracle:thin:@localhost:1521/oradb&quot;) \\\n    .option(&quot;user&quot;, &quot;GRIGOREVDS&quot;) \\\n    .option(&quot;password&quot;, &quot;***&quot;) \\\n    .option(&quot;dbtable&quot;, &quot;GRIGOREVDS.myTable&quot;) \\\n    .option(&quot;partitionColumn&quot;, &quot;id&quot;) \\\n    .option(&quot;lowerBound&quot;, 1) \\\n    .option(&quot;upperBound&quot;, 100) \\\n    .option(&quot;numPartitions&quot;, 10) \\\n    .load()\n\ndf.repartition(2).write \\\n    .mode(&quot;overwrite&quot;) \\\n    .partitionBy(&quot;field1&quot;) \\\n    .format(&quot;parquet&quot;) \\\n    .option(&quot;compression&quot;, &quot;snappy&quot;) \\\n    .save(&quot;/tmp/migration/test&quot;)</code></pre>\n\n<p style=\"font-size:18px\">После того, как скрипт будет запущен через YARN (например:&nbsp;<code>spark-submit --master yarn ~/migration.py</code>) создастся Spark application, где можно будет отследить процесс выполнения запущенного скрипта в Spark History (Web сервер для визуализации создаваемых Jobs, Stages, Tasks, а также отображения логов выполнения приложений Spark в удобном виде).</p>\n\n<p style=\"font-size:18px\">Любое приложение в момент своей работы, состоит из драйвера &ndash; программы, которая выполняет основную функцию приложения (точка входа в приложение (main)), и исполнителей, которым на вход поступают данные и инструкция, по которой будет производиться выполнение на узлах кластера. После чего, исполнители отдают результат драйверу, чтобы получить новую задачу. При этом каждый исполнитель может выполнять обработку более чем в один поток, где каждый поток будет работать со своим блоком данных независимо друг от друга. Таким образом, если посмотреть на наш код выше, то можно заметить, что при запуске нашего приложения мы запросили у менеджера кластера одного исполнителя с двумя ядрами (потоками). Это говорит о том, что нам будет доступно (<code>spark.executor.instances * spark.executor.cores</code>) 1 * 2 = 2 потока и в лучшем случае мы сможем обрабатывать два блока данных одновременно. При необходимости данные показатели можно увеличить.</p>\n\n<p style=\"font-size:18px\">Ниже приведен снимок экрана, на котором видна общая информация о создаваемых Jobs, после запуска нашего скрипта:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Вкладка JOBS\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/2a7/dcc/92d/2a7dcc92d21dc72d6a96a4e6330e33e0.png\" style=\"height:343px; width:1919px\" title=\"Вкладка JOBS\" /></p>\n\n<p style=\"font-size:18px\">Вкладка JOBS</p>\n\n<p style=\"font-size:18px\"><img alt=\"Прогресс по выполнению задач рассматриваемого Job\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/466/5d5/148/4665d5148401d0134554fac5eb1b00b3.png\" style=\"height:78px; width:526px\" title=\"Прогресс по выполнению задач рассматриваемого Job\" /></p>\n\n<p style=\"font-size:18px\">Прогресс по выполнению задач рассматриваемого Job</p>\n\n<p style=\"font-size:18px\">Можно заметить, что запущенный процесс состоит из 1-ого Job (save), который, в свою очередь, делится на 12 задач.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Детализация рассматриваемого Job \" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/b10/ecc/0e3/b10ecc0e338ddba7bf330cc7e6b5774c.png\" style=\"height:355px; width:1919px\" title=\"Детализация рассматриваемого Job \" /></p>\n\n<p style=\"font-size:18px\">Детализация рассматриваемого Job</p>\n\n<p style=\"font-size:18px\">На скриншоте выше, можно увидеть, что созданный Job был разбит на 2-а этапа:</p>\n\n<ol>\n\t<li>\n\t<p style=\"font-size:18px\">Чтение данных из базы данных (Stage Id: 0), который состоит из 10 задач;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Запись данных в HDFS (Stage Id: 1), который состоит из двух задач;</p>\n\t</li>\n</ol>\n\n<p style=\"font-size:18px\">Перейдя в этап чтения данных можно увидеть, что были созданы и успешно выполнены 10 Tasks (tasks: 0 9).</p>\n\n<p style=\"font-size:18px\"><img alt=\"Детализация этапа чтения данных\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/fbd/485/591/fbd48559185f706cc858a398b8c52557.png\" style=\"height:886px; width:1859px\" title=\"Детализация этапа чтения данных\" /></p>\n\n<p style=\"font-size:18px\">Детализация этапа чтения данных</p>\n\n<p style=\"font-size:18px\"><code>1 - количество созданных задач, в рамках рассматриваемого этапа<br />\n2 - созданные задачи и их детальная информация<br />\n3 - детальная информация о задействованных исполнителях, в рамках рассматриваемого этапа</code></p>\n\n<p style=\"font-size:18px\">Разберемся, откуда взялись 10 задач, если чтение производилось одной таблицы (GRIGOREVDS.myTable). Посмотрев внимательно на код, можно заметить, что были применены дополнительные опции (<code>partitionColumn, lowerBound, upperBound, numPartitions</code>), которые позволили распараллелить чтение данных из нашей таблицы. В результате, после применения данных опций мы получили 10 (<code>numPartitions</code>), сгенерированных JDBC драйвером, запросов в БД.</p>\n\n<p style=\"font-size:18px\">Посмотрим детальнее на процесс генерации запросов. Когда задаются данные опций, часто возникает вопрос: А что же делают опции lowerBound и upperBound? Могу ли я наложить таким образом фильтр на данные и выгрузить только те, которые попали в диапазон данных опций? Ответ - нет. При указании данных опций мы лишь задаем крайние границы значений выбранной колонки&nbsp;<code>partitionColumn</code>, чтобы в дальнейшем получить наиболее равномерное распределение данных, с помощью запросов выборки. В рассматриваемом примере мы увидим, что у нас имеется в таблице 100 записей, которые должны быть разбиты на 10 блоков по колонке &quot;ID&quot;. В результате мы получим:</p>\n\n<table>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Блок</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Запрос выборки</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">Накладываемый фильтр на данные</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">1</p>\n\t\t\t</td>\n\t\t\t<td rowspan=\"10\">\n\t\t\t<p style=\"font-size:18px\">SELECT<br />\n\t\t\t&quot;ID&quot;,<br />\n\t\t\t&quot;FIELD1&quot;,<br />\n\t\t\t&quot;FIELD2&quot;,<br />\n\t\t\t&quot;FIELD3&quot;,<br />\n\t\t\t&quot;FIELD4&quot;,<br />\n\t\t\t&quot;FIELD5&quot;,<br />\n\t\t\t&quot;FIELD6&quot;<br />\n\t\t\tFROM GRIGOREVDS.myTable</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &lt; 11 or &quot;ID&quot; is null</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">2</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 11 and &quot;ID&quot; &lt; 21</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">3</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 21 and &quot;ID&quot; &lt; 31</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">4</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 31 and &quot;ID&quot; &lt; 41</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">5</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 41 and &quot;ID&quot; &lt; 51</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">6</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 51 and &quot;ID&quot; &lt; 61</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">7</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 61 and &quot;ID&quot; &lt; 71</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">8</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 71 and &quot;ID&quot; &lt; 81</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">9</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 81 and &quot;ID&quot; &lt; 91</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">10</p>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<p style=\"font-size:18px\">WHERE &quot;ID&quot; &gt;= 91</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"font-size:18px\">Примеры отправленных запросов в Oracle представлены на скриншотах ниже:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Снимок детализации создаваемой сессии в Oracle (session 1)\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/b1c/c0e/932/b1cc0e9328cf88169593939fc0bd7578.png\" style=\"height:120px; width:726px\" title=\"Снимок детализации создаваемой сессии в Oracle (session 1)\" /></p>\n\n<p style=\"font-size:18px\">Снимок детализации создаваемой сессии в Oracle (session 1)</p>\n\n<p style=\"font-size:18px\"><img alt=\"Снимок детализации создаваемой сессии в Oracle (session 2)\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/ea6/204/c86/ea6204c86abcbf1dcf00c1de34b1dde7.png\" style=\"height:115px; width:727px\" title=\"Снимок детализации создаваемой сессии в Oracle (session 2)\" /></p>\n\n<p style=\"font-size:18px\">Снимок детализации создаваемой сессии в Oracle (session 2)</p>\n\n<p style=\"font-size:18px\">Посмотреть информацию о том, было ли применено параллельное чтение данных, сколько строк было обработано в процессе работы каждого из этапов, количество выходных файлов, размер выходных данных и др., можно на вкладке SQL, перейдя в интересующий Query ID:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Вкладка SQL\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/586/1b2/ac9/5861b2ac94c7c499013eb6728fa375a9.png\" style=\"height:252px; width:1854px\" title=\"Вкладка SQL\" /></p>\n\n<p style=\"font-size:18px\">Вкладка SQL</p>\n\n<p style=\"font-size:18px\"><code>1 - SQL блок<br />\n2 - колонка для идентификации Queries<br />\n3 - ссылка на конкретный Query ID</code></p>\n\n<p style=\"font-size:18px\"><img alt=\"Детализация рассматриваемого Query\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/527/5cf/4e2/5275cf4e2c96a2e014a05b66d1762ec0.png\" style=\"height:546px; width:647px\" title=\"Детализация рассматриваемого Query\" /></p>\n\n<p style=\"font-size:18px\">Детализация рассматриваемого Query</p>\n\n<p style=\"font-size:18px\"><code>1 - время выполнения блока<br />\n2 - параллельное чтение данных (разбиение на разделы) + количество разделов<br />\n3 - количество выходных файлов<br />\n4 - размер выходных данных<br />\n5 - количество выходных строк</code></p>\n\n<p style=\"font-size:18px\">После того, как фрейм данных получен, запускается блок записи в HDFS. В рамках рассматриваемого приложения в Spark History - это Stage Id: 1.</p>\n\n<p style=\"font-size:18px\">Так как все выходные данные решено было поделить на две, близкие к равенству по размеру части&nbsp;<code>repartition(2)</code>, то в Spark History мы, соответственно, увидим две созданные задачи на запись. См. скриншот ниже:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Детализация этапа записи данных\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/dec/f2e/2cd/decf2e2cd0ea08712c31d8c6b8365529.png\" style=\"height:630px; width:1859px\" title=\"Детализация этапа записи данных\" /></p>\n\n<p style=\"font-size:18px\">Детализация этапа записи данных</p>\n\n<p style=\"font-size:18px\"><code>1 - количество созданных задач, в рамках рассматриваемого этапа<br />\n2 - созданные задачи и их детальная информация<br />\n3 - детальная информация о задействованных исполнителях в рамках рассматриваемого этапа</code></p>\n\n<p style=\"font-size:18px\">В итоге, после успешного завершения работы скрипта, в директории HDFS (<code>/tmp/migration/test</code>) мы увидим<br />\nфайл &quot;_SUCCESS&quot;, который будет сигнализировать пользователю о том, что запись была произведена успешно. А также директорию, которая была создана в результате выполнения партицирования по колонке &quot;field1&quot; (<code>partitionBy(&quot;field1&quot;)</code>), в которой будут лежать два файла&nbsp;<code>repartition(2)</code>, содержащие в себе экспортируемые из БД данные в формате parquet с применением кодека сжатия snappy.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/533/ad1/c86/533ad1c86e2fba26b9afdcaa87ca8792.png\" style=\"height:157px; width:1354px\" /></p>\n\n<p style=\"font-size:18px\"><code>1 - файл, сигнализирующий успешную запись<br />\n2 - директория, создавшаяся в результате партицирования<br />\n3 - два файла с данными</code></p>\n\n<p style=\"font-size:18px\">Название директории, по которой проводится партицирование, будет состоять из двух частей: название колонки, по которой проводится партицирование и сгруппированные значения из этой колонки.</p>\n\n<p style=\"font-size:18px\"><strong>Заключение</strong></p>\n\n<p style=\"font-size:18px\">В рамках данной статьи мы рассмотрели вариант экспорта данных из реляционной базы данных в HDFS, с применением фреймворка Apache Spark. Кроме того, проанализировали поэтапно процесс выполнения исполняемого кода, а также рассмотрели возможные методы и опции для оптимизации и ускорения процесса выгрузки данных.</p>",
    "author": "sidorov",
    "category": "администрирование",
    "image": "851d0f07bb84cc9d09955d635aa29d1f.png",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "18.09.21 01:55:19"
  },
  {
    "title": "Детектив с Wi-Fi на огромном складе: сетевая икс-команда на выезде",
    "preview": "Приходит заказчик с проблемой: есть просто огромный склад (побольше некоторых стадионов), на котором плохо работает Wi-Fi. Выражается это в том, что терминалы сбора данных у сотрудников тупят, виснут и теряют сессии, а это ведёт к тому, что работники склада не могут собрать отгрузку.",
    "body": "<p style=\"font-size:18px\"><img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/pq/7v/vo/pq7vvofomnvu_bzpa9qv5q_p3qo.jpeg\" /><br />\n<br />\nПриходит заказчик с проблемой: есть просто огромный склад (побольше некоторых стадионов), на котором плохо работает Wi-Fi. Выражается это в том, что терминалы сбора данных у сотрудников тупят, виснут и теряют сессии, а это ведёт к тому, что работники склада не могут собрать отгрузку.<br />\n<br />\nПоначалу проблема казалось очень простой: радиообследование, подтюнить настройки на контроллере или перепроектировать размещение ТД &mdash; хэппи-энд. Это работает даже на взрывозащищённом производстве и на складе блистерных упаковок таблеток, так что остаётся один маленький момент &mdash; убедиться, что проблема именно в Wi-Fi, а не в чём-то ещё. На объект до нас приезжало несколько интеграторов, и все они предложили новые проекты сети.<br />\n<br />\nМы попросили заказчика показать нам другой склад, где есть грамотно спроектированный Wi-Fi и тот же зоопарк терминалов работает без нареканий. Оказалось, что такого склада нет.<br />\n<br />\nВ этот момент и начался детектив по поиску проблем.<br />\n&nbsp;</p>\n\n<h2>Зачем нас позвали</h2>\n\n<p style=\"font-size:18px\"><br />\nЗаказчик изначально предполагал, что проблема &mdash; в архитектуре сети и её реализации. Сеть на складе появилась в тот момент, когда строители отдали здание с инфраструктурой. В инфраструктуру входил Wi-Fi, и его сделали очень простым образом: прикрепили к потолку на высоте 12 метров всенаправленные точки доступа из обычного офисного арсенала. То есть вроде бы и работает, но это не есть best practice. Как только склад заполнился и начались проблемы с работой ТСД, заказчик начал подозревать, что дело именно в этом. Дальше они долго бодались по бумагам, соответствуют ли ТЗ исполнению гарантии со строителями, но строители выиграли этот спор. В итоге склад примерно года три страдал от безумно бесивших терминалов, и настало время это как-то поправить.<br />\n&nbsp;</p>\n\n<h2>Что именно было на месте</h2>\n\n<p style=\"font-size:18px\"><br />\nСначала мы приехали на радиообследование. Увидели эти самые омниточки на потолке, почувствовали &laquo;на глаз&raquo;, что они зверски расходуют энергию на создание интерференции, обеспечение устойчивой связью потолка, стен и попытки победить соседнюю точку.<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/1r/vy/pj/1rvypjte4oaovn5c-h8zgzh_euy.jpeg\" /><br />\n<br />\nХорошей практикой на складах считается установка направленных антенн, которые &laquo;светят&raquo; сектором ровно на потребителя, то есть на места появления ТСД: это ряды между стеллажами. Если задача стоит сделать предельно дёшево &mdash; они ставятся по одной или двум торцевым сторонам и светят в проходы горизонтально. Метод применим для складов c подходящей длиной ряда и плох тем, что в ряд можно поставить погрузчик или другое препятствие, которое будет мешать сигналу. Поэтому, если бюджет есть, то правильно вешать направленные точки на потолок и &laquo;светить&raquo; ими вниз.<br />\n<br />\nПо примерно похожей схеме мы обеспечивали даже стадион HD-вайфаем, а там потребителей на порядки больше, и интерференционная картина хуже: монтировали на козырёк сверхузконаправленные сектора. Вот этот&nbsp;<a href=\"https://habr.com/ru/company/croc/blog/269585/\">пример стадиона</a>&nbsp;из Краснодара.<br />\n<br />\nС этого объекта я не могу показывать детали, но на стадионе антенна выглядела так:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/fr/gw/3y/frgw3y-afwnjbw2sfvo9yb6zwgu.jpeg\" /><br />\n<br />\nСобственно, заказчик думал, что проблема &mdash; именно во всенаправленных точках и зонах интерференции/недопокрытия между ними, и считал, что если поменять реализацию сети, то всё заработает как по щелчку. Те интеграторы, которые были на объекте до нас или вместе с нами, собственно, занимались именно тем, что предлагали проекты новой сети.<br />\n<br />\nМы же поняли, что при всей несостоятельности архитектуры на практике эта сеть работает и покрытие у неё более-менее стабильное для текущих задач. Да, зоны точек не изолированы, не раскиданы нормально по каналам, но покрытие есть. Скажем так, на 90 % площади всё в порядке или удовлетворительно.<br />\n<br />\nТо есть проблема как минимум не только в Wi-Fi.<br />\n&nbsp;</p>\n\n<h2>Может, дело в самих ТСД?</h2>\n\n<p style=\"font-size:18px\"><br />\nНа складе использовались терминалы трёх разных производителей. Глючили из них два, но по-разному:<br />\n&nbsp;</p>\n\n<ul>\n\t<li>Один вендор грешил постоянно и регулярно, эти ТСД рабочие не любили.</li>\n\t<li>Второй имел визуально те же баги с сессиями, но более редкие. Более того, от рабочих мы узнали, что есть &laquo;счастливые&raquo; устройства, которые не надо перезагружать почти никогда, и &laquo;проклятые&raquo; тех же моделей, которые глючат регулярно.</li>\n</ul>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h2>Может, дело в магнитной аномалии в какой-то части склада?</h2>\n\n<p style=\"font-size:18px\"><br />\nСледующий наш вопрос был про то, где именно происходят глюки. Выяснилось, что они &laquo;размазаны&raquo; по складу примерно равномерно, и чётких мест их дислокации нет. На складе, кстати, хранится очень много всего разного, но переизбытка металла или каких-то других вещей вроде источников мелкодисперсной проводящей пыли, как&nbsp;<a href=\"https://habr.com/ru/company/croc/blog/470453/\">вот в этом примере</a>&nbsp;на складе одежды из синтетической ткани, там нет. В целом, если вы будете считать основным товаром продукты питания, то не сильно ошибётесь в свойствах, которые имела продукция с точки зрения радиопокрытия.<br />\n<br />\nПокрытие 2,4/5:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/1i/ax/hc/1iaxhcmpwiyse7odj7ta-dkr0fe.png\" /><br />\n<br />\nИнтерференция 2,4/5:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/bu/55/wy/bu55wyme-enjyjki7fotzvx9cri.png\" /><br />\n&nbsp;</p>\n\n<h2>Начинаем исследовать баг</h2>\n\n<p style=\"font-size:18px\"><br />\nБаг проявляется как потеря связи между ТСД и сервером WMS, с которым терминалы работают. Терминал использует TCP, в котором использует старый добрый Telnet (не спрашивайте, почему так), через который бросает уже что-то в верхнеуровневом протоколе приложения.<br />\n<br />\nМы развернули два решения братской компании NETSCOUT &mdash; старых добрых вендоров софта для сетевиков. Мы использовали nGenius One и nGenius Pulse. Пульс &mdash; это инфраструктурный мониторинг, который собирает статистику с контроллеров и помогает отыскать аномалии. Он же может устанавливаться на устройства для разных видов тестирования. Единичка &mdash; это софт, который собирает реальный трафик между узлами сети и позволяет расковыривать протоколы с вопросами: &laquo;А что это у вас в пакете?&raquo;<br />\n<br />\nЕщё мы поставили зонд с Пульсом &mdash; это может быть как коробочное решение, которое что-то пингует или делает что-то ещё с сетью с точки зрения оконечного устройства пользователя, либо же это софт, который ставится на один из узлов. Мы поставили на промышленный ноутбук и оставили его на складе посмотреть, что случится. Зонд находился внутри сети заказчика и занимался тем, что пинговал сервера WMS и проверял доступность порта.<br />\n<br />\nВообще-то эти два компонента нужны не только для поиска проблем, но и для планирования сети на развитие: они показывают, как делается доставка приложений по сети, показывают нормальные дашборды про доступность всех ресурсов и помогают посчитать, под какое приложение сколько какого ресурса надо.<br />\n<br />\nДля зеркалирования трафика и минимизации влияния мониторинга на прод (там вообще-то всё ещё склад с живыми людьми, и ничего останавливать нельзя) мы использовали пакетные брокеры Niagara Networks и NETSCOUT.<br />\n<br />\nЧто сделали:<br />\n&nbsp;</p>\n\n<ol>\n\t<li>Так как трафик от ТСД мог отправляться двумя путями (ТСД &mdash; ТД &mdash; сервер WMS или ТСД &mdash; ТД &mdash; Wi-Fi-контроллер в ЦОДе &mdash; сервер WMS), мы собирали трафик от склада до серверов WMS и от ЦОДа (тут живут Wi-Fi-контроллеры) до серверов WMS.</li>\n\t<li>Провели тесты доступности серверов со склада.</li>\n\t<li>Собрали метрики сети (доступность оборудования).</li>\n</ol>\n\n<p style=\"font-size:18px\"><br />\nВот зонд пингует сервер WMS:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/t2/01/cf/t201cfgxwjyemwtkompjdgziuuu.png\" /><br />\n<br />\nКак видите, всё хорошо.<br />\n<br />\nВот то же самое, но уже на уровне TELNET:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/nn/6q/c3/nn6qc3vaszeoi5v8zxkpenvjeeo.png\" /><br />\n<br />\nПровал ночью &mdash; это регламентные работы, там всё хорошо. То есть Telnet тоже ходит.<br />\n<br />\nВот оценка качества работы точек доступа Wi-Fi и хит-парад наихудших показателей в диапазоне 5 ГГц:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/jt/g9/fc/jtg9fcn3vgbnfxnd3zzkqgx9iog.png\" /><br />\n<br />\nА вот общие показатели работы точки доступа:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/ig/m1/np/igm1npntizjkvhtn66yrmr3esf8.png\" /><br />\n<br />\nИ детальные показатели работы точки доступа в диапазоне 5 ГГц:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/ph/uf/n3/phufn3rswly494rdtmh0ma3e4to.png\" /><br />\n<br />\nКак видите, проблем особо нет.<br />\n<br />\nТеперь начинаем ковыряться в сетевых взаимодействиях чуть повыше уровнем. Нашлось вот что, смотрите:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/k2/-2/p6/k2-2p6ij4doacguduwejcyfu5ak.png\" /><br />\n<br />\nЭто сам момент возникновения проблемы. Разрывается TCP-сессия и устанавливается новая.<br />\n<br />\nИ исходная сессия, и новая сессия выглядят нормально. Ковыряемся дальше.<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/le/qr/05/leqr056_nuf9ym0guoejw23omxy.png\" /><br />\n<br />\nДальше смотрим на DHCP и видим большое количество тайм-аутов на DHCP-запросы от терминалов:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/_o/1a/nc/_o1anchxkwm29cj2_hexfsosbtg.png\" /><br />\n<br />\nКаждый конкретный терминал запрашивал новый IP-адрес у DHCP-сервера в случайный момент времени. Выяснилось, что это происходит в момент роуминга ТСД на другую точку доступа, то есть при физическом перемещении терминала из-под одной точки к другой. То есть просто при движении работника по складу.<br />\n<br />\nВыглядит это так: устройство делает запрос к DHCP-серверу, ждёт пять секунд тайм-аута, потом сбрасывает стек и стартует всю процедуру подключения к сети заново. В этот момент и сбрасывается верхнеуровневая сессия в приложении.<br />\n<br />\nТакже время от времени терминалы запрашивают новый IP просто так, никуда не двигаясь, и ловят ту же проблему.<br />\n<br />\nВот что по этому поводу думает DHCP:<br />\n<br />\n<img alt=\"image\" src=\"https://habrastorage.org/r/w1560/webt/zx/ou/w_/zxouw_da6ngj_5htu-im2nkixqm.png\" /><br />\n&nbsp;</p>\n\n<h2>А что дальше?</h2>\n\n<p style=\"font-size:18px\"><br />\nДальше по просьбе заказчика мы сделали новую архитектуру сети (точки с направленными антеннами над аллеями склада) но сказали, что это не решит проблему с терминалами, потому что дело не в Wi-Fi. Точнее, по большей части &mdash; не в покрытии. Главное, что нашли истинный корень зла и локализовали проблему с неработающими терминалами. Еще мы посоветовали заказчику приобрести и развернуть решение NETSCOUT на своей инфраструктуре для дальнейшего проактивного анализа работы бизнес сервисов и приложений. Так они смогут сократить время простоя при возникновении новых проблем. ИТ-отдел заказчика думает, что с этим делать, потому что нужно решить проблему и с ответом сервера, и со случайными сбросами IP устройств (прошивка или драйвер, скорее всего), и с покрытием в тех местах, где оно всё же плохое.<br />\n<br />\nЧем все закончится, расскажу потом в комментариях. Или это будет уже новая история&hellip;<br />\n&nbsp;</p>\n\n<h2>Почему ИТ-отдел не сделал всё сам?</h2>\n\n<p style=\"font-size:18px\"><br />\nПотому что у них есть другой фокус и потому что задача относилась к анализу и проектированию сети (с возможными последующими реализацией, гарантией и поддержкой). То есть они хотели получить решение как сервис.<br />\n&nbsp;</p>\n\n<h2>А можно где-то пощупать этот софт?</h2>\n\n<p style=\"font-size:18px\"><br />\nДа. Мы регулярно показываем, что и как мы делаем.&nbsp;<a href=\"https://promo.croc.ru/meetup_wi-fi_1111\">Ближайший вебинар &mdash; 11 ноября</a>, там будем разбирать тему беспроводных сетей и их анализ. Покажем два решения: мониторинг от NETSCOUT и Wi-Fi 6 от Huawei, покажем, как они работают вместе. Разберём ещё пару примеров похожих сетевых детективов.<br />\n<br />\nПрошлые посты про Wi-Fi вот: стадион в&nbsp;<a href=\"https://habr.com/ru/company/croc/blog/269585/\">Краснодаре</a>,&nbsp;<a href=\"https://habr.com/ru/company/croc/blog/415163/\">особо охраняемый экранированный объект</a>.</p>",
    "author": "petrov",
    "category": "администрирование",
    "image": "pq7vvofomnvu_bzpa9qv5q_p3qo.jpeg",
    "status": "draft",
    "comment_moderator": "",
    "moderator_id": "",
    "published_at": ""
  },
  {
    "title": "Мимо наборной кассы: феерическая профанация шрифтового дела от компании «Паратайп»",
    "preview": "Это история о том, как я разочаровался в компании «Паратайп» и шрифтах, которые она производит.",
    "body": "<p style=\"text-align:justify; font-size:18px\">Это история о&nbsp;том, как я&nbsp;разочаровался\n    в&nbsp;компании &laquo;Паратайп&raquo; и&nbsp;шрифтах, которые она\n    производит.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Я&nbsp;делал PDF\u2060-\u2060презентацию, чтобы показать\n    европейским иностранцам. И&nbsp;что\u2060-\u2060то меня пробило на гиперкачественную\n    вёрстку с&nbsp;образцовым типографингом. Пускай, думаю, у&nbsp;иностранцев\n    сорвёт шаблон: они\u2060-\u2060то привыкли, что все русские верстают по\u2060-\u2060колхозному,\n    особенно если думают, что нет.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Пока я&nbsp;размечал сетку страницы, меня упорола\n    ещё одна идея: использовать шрифт отечественного производства. Пусть\n    европейцы дважды офигеют.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Я&nbsp;выбрал PT&nbsp;Sans, потому что графика\n    этого шрифта&nbsp;&mdash; вполне на мировом уровне. Однако бесплатной\n    версии, которую &laquo;Паратайп&raquo; раздаёт всем желающим, не&nbsp;хватало\n    для полного дзена. Мне были нужны капители и&nbsp;минускульные цифры, и&nbsp;сейчас\n    объясню, для чего.</p>\n\n<h2 style=\"text-align:justify\">Чтобы не оттопыривалось</h2>\n\n<p style=\"text-align:justify; font-size:18px\">&laquo;Эффект оттопыривания&raquo; особенно\n    нагляден в&nbsp;книгах петровской эпохи, где многочисленные еры и&nbsp;яти\n    по пластике сделаны как прописные, а&nbsp;используются в&nbsp;качестве\n    строчных. Они торчат из строки, как &laquo;Лахта\u2060-\u2060центр&raquo;, и&nbsp;создают\n    то самое колхозие:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img alt=\"«Юности честное зерцало» (1717)\"\n                                   src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/cd8/f81/2da/cd8f812da6c79bfc089a1a072d796087.jpg\"\n                                   style=\"width:378px\"\n                                   title=\"«Юности честное зерцало» (1717)\"/>\n</p>\n\n<p style=\"text-align:justify; font-size:18px\">&laquo;Юности честное зерцало&raquo; (1717)</p>\n\n<p style=\"text-align:justify; font-size:18px\">Такая лажа встречается в&nbsp;печати вплоть до\n    самой революции, хотя большинство издателей к&nbsp;этому времени уже\n    подправили шрифты:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        alt=\"Л. Н. Толстой. Война и мир. Москва, издание Сытина (1912)\"\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/419/e9e/bac/419e9ebace848bc77472c10e88ad72f2.jpg\"\n        style=\"width:520px\"\n        title=\"Л. Н. Толстой. Война и мир. Москва, издание Сытина (1912)\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Л. Н. Толстой. Война и&nbsp;мир. Москва, издание\n    Сытина (1912)</p>\n\n<p style=\"text-align:justify; font-size:18px\">В&nbsp;XX&nbsp;веке оттопыривание вернулось с&nbsp;новой\n    силой, когда стало появляться всё больше научных, деловых и&nbsp;юридических\n    текстов с&nbsp;обилием цифр и&nbsp;аббревиатур. Если в&nbsp;царские времена&nbsp;<em>ъ</em>&nbsp;и&nbsp;<em>ѣ</em>&nbsp;в&nbsp;основном\n    торчали из текста поодиночке, то теперь чи́сла и&nbsp;аббревиатуры выпирают\n    целыми шеренгами. Многие привыкли к&nbsp;этому безобразию и&nbsp;не&nbsp;обращают\n    внимания, что текст выглядит неэстетично:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/fef/1dd/df2/fef1dddf28a7c9d6bde1a4a7ebcd2df5.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Как бороться с&nbsp;такой бедой, знали ещё до\n    Петра: использовать строчные (минускульные) цифры и&nbsp;капительные буквы\n    вместо скоплений прописных:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/cf9/100/8b9/cf91008b96ba70398947ee274aa2bcfc.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Конечно, оттопыривание&nbsp;&mdash; не&nbsp;единственная\n    проблема типографского набора, однако здесь мы фокусируемся именно на ней,\n    потому что надо&nbsp;же на чём\u2060-\u2060то фокусироваться.</p>\n\n<p style=\"text-align:justify; font-size:18px\">И&nbsp;да: в&nbsp;последних примерах был не&nbsp;упоминавшийся\n    выше PT&nbsp;Sans, а&nbsp;обычный Calibri, потому что PT&nbsp;Sans сосёт.\n    Подробности&nbsp;&mdash; после лирического отступления.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Лирическое отступление</strong></p>\n\n<p style=\"text-align:justify; font-size:18px\">Хуже вёрстки по\u2060-\u2060колхозному может быть только\n    вёрстка в&nbsp;манере колхозного агронома, чей слегка повышенный уровень\n    образования больше вредит, чем помогает.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Например, бывает, что человек умеет грамотно\n    увязывать друг с&nbsp;другом формат страницы, ширину полей, кегль шрифта,\n    сетку и&nbsp;межстрочные интервалы,\u2060&mdash; а&nbsp;цифры и&nbsp;аббревиатуры\n    при этом выпирают самым безвкусным образом.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Иные носятся с&nbsp;&laquo;типографскими\n    кавычками&raquo; или &laquo;висячей пунктуацией&raquo;, как с&nbsp;писаной\n    торбой, но при этом верстают сущую кулебяку, где и&nbsp;кавычки четырёх\n    сортов, и&nbsp;пунктуация отовсюду свисает,\u2060&mdash; а&nbsp;эстетики\n    нет.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Я&nbsp;буду рад, если после этой статьи вы\n    начнёте обращать больше внимания на &laquo;эффект оттопыривания&raquo; и&nbsp;бороться\n    с&nbsp;ним, но будет ещё душеполезнее, если вы этим не&nbsp;ограничитесь, а&nbsp;овладеете\n    мастерством набора и&nbsp;вёрстки во всю мощь, чтобы европейские иностранцы\n    на вас равнялись.</p>\n\n<h2 style=\"text-align:justify\">С&nbsp;коммунистическим приветом</h2>\n\n<p style=\"text-align:justify; font-size:18px\">PT&nbsp;Sans&nbsp;&mdash; часть шрифтовой системы\n    &laquo;ПТ&raquo;, которую разработала Александра Королькова при участии\n    других коллег из &laquo;Паратайпа&raquo;. Первая версия шрифта вышла в&nbsp;2009&nbsp;году.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Официальную информацию об этом проекте можно\n    прочесть&nbsp;<a href=\"http://rus.paratype.ru/pt-sans-pt-serif\"\n                     rel=\"noopener noreferrer nofollow\">на сайте &laquo;Паратайпа&raquo;</a>,\n    в&nbsp;<a\n            href=\"https://ru.wikipedia.org/wiki/%D0%A1%D0%B2%D0%BE%D0%B1%D0%BE%D0%B4%D0%BD%D1%8B%D0%B5_%D1%88%D1%80%D0%B8%D1%84%D1%82%D1%8B_%D0%9F%D0%A2\"\n            rel=\"noopener noreferrer nofollow\">статье из Википедии</a>&nbsp;и&nbsp;по\n    многочисленным ссылкам в&nbsp;подвале той статьи. Хотя если у&nbsp;вас\n    аллергия на патриотическую пропаганду, то лучше не&nbsp;читайте: писания\n    &laquo;Паратайпа&raquo; составлены в&nbsp;кондовейших традициях газеты\n    &laquo;Правда&raquo;:</p>\n\n<blockquote>\n    <p style=\"text-align:justify; font-size:18px\">&hellip;именно письменность является тем\n        объединяющим и&nbsp;идентифицирующим фактором, который позволяет нам\n        ощущать себя единым народом единой страны.</p>\n</blockquote>\n\n<p style=\"text-align:justify; font-size:18px\">Там&nbsp;же&nbsp;&mdash; пассажи про &laquo;развитие\n    и&nbsp;сохранение письменной культуры народов, населяющих нашу страну&raquo;,\n    про то, что &laquo;право на такой шрифт должно быть гарантировано\n    конституцией&raquo;, а&nbsp;также обязательный для советских изданий плевок\n    в&nbsp;сторону загнивающего Запада: оказывается, в&nbsp;тамошних шрифтах не&nbsp;только\n    кириллица &laquo;не&nbsp;очень удачная с&nbsp;точки зрения дизайна&raquo;,\n    но и&nbsp;вообще они &laquo;часто совершенно непригодны для полиграфии,\n    коммуникативного дизайна и&nbsp;других повседневных нужд&raquo;. Возможно,\n    эта оголтелая агитация объясняется тем, что разработку шрифта финансировала\n    ныне упразднённая &laquo;Роспечать&raquo;.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Впрочем, несмотря на господдержку, графически PT&nbsp;Sans\n    превосходен. По&nbsp;сути, это единственный гротеск постсоветского\n    производства, которым я&nbsp;бы рискнул набирать сплошной текст. Все эти\n    годы я&nbsp;использовал бесплатную версию шрифта, но чтобы выпендриться\n    перед иностранцами, понадобился платный&nbsp;<a\n            href=\"https://www.paratype.ru/fonts/pt/pt-sans-pro\"\n            rel=\"noopener noreferrer nofollow\">PT&nbsp;Sans Pro</a>.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Лирическое отступление</strong></p>\n\n<p style=\"text-align:justify; font-size:18px\">Может быть, на этом месте вы поперхнулись\n    недоумением: неужели я&nbsp;реально купил шрифт за настоящие деньги? Ну,\n    упс: я&nbsp;и&nbsp;правда его купил. За&nbsp;полную пачку PT&nbsp;Sans Pro\n    без всяких ограничений &laquo;Паратайп&raquo; хочет около 37&nbsp;млн&nbsp;рублей,\n    но мои запросы были скромнее: я&nbsp;заплатил всего 7&nbsp;500&nbsp;₽ за\n    два начертания (Regular и&nbsp;Narrow Regular), причём только за\n    минимальную десктопную лицензию с&nbsp;лимитом\n    в&nbsp;5&nbsp;компьютеров.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Подробное объяснение того, почему я&nbsp;не&nbsp;скачал\n    шрифт на халяву с&nbsp;торрентов, вышло&nbsp;бы настолько далеко за рамки\n    этой статьи, как вы себе даже не&nbsp;представляете. Но&nbsp;в&nbsp;качестве\n    рабочей гипотезы можно считать, что для вящего эффекта.</p>\n\n<h2 style=\"text-align:justify\">Капитель не&nbsp;капитель</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Всякий выпендрёж несёт в&nbsp;себе риск облома,\n    ну вот я&nbsp;его и&nbsp;огрёб.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Если помните, капитель была мне нужна, прежде\n    всего чтобы обуздывать торчащие прописные буквы в&nbsp;аббревиатурах, как\n    здесь:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/baf/184/7ea/baf1847ea6928ab32573475fb3a0b26f.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">С&nbsp;буржуйскими шрифтами это неплохо\n    получается: даже человек, далёкий от типографинга, видит, что одни буквы\n    здесь по смыслу строчные, а&nbsp;другие&nbsp;&mdash; прописные. (Шрифт в&nbsp;обоих\n    примерах&nbsp;&mdash;&nbsp;<a\n            href=\"https://www.lucasfonts.com/fonts/corpid\"\n            rel=\"noopener noreferrer nofollow\">Corpid</a>.)</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/c78/019/e3a/c78019e3a1672611ae653a9bc52f6ab8.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">PT&nbsp;Sans&nbsp;&mdash; совсем другая петрушка.\n    Если заранее не&nbsp;знать, то можно подумать, что тут все символы&nbsp;&mdash;\n    строчные:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/477/f98/2e8/477f982e89bdc588d3c08ae6334e8512.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Для пущего сравнения заменим вообще все буквы на\n    обычные строчные и&nbsp;поставим полученную надпись под предыдущей:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/c2a/4d7/3eb/c2a4d73ebc5686619262ee1af7a6268d.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Разница ощутима только на букве &laquo;А&raquo;,\n    потому что ей в&nbsp;кириллице посчастливилось в&nbsp;верхнем регистре\n    выглядеть не&nbsp;так, как в&nbsp;нижнем. И&nbsp;тут самое время углубиться\n    в&nbsp;теорию.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Теоретическое отступление</strong></p>\n\n<p style=\"text-align:justify; font-size:18px\">В&nbsp;профессиональных шрифтах капитель делают\n    примерно на&nbsp;30&nbsp;% выше строчных букв, чтобы в&nbsp;сочетании с&nbsp;ними\n    она была хорошо различима. Однако капитель годится не&nbsp;только для\n    утопыривания аббревиатур; в&nbsp;мировой практике её широко применяют и&nbsp;вместе\n    с&nbsp;прописными буквами, и&nbsp;с&nbsp;цифрами, и&nbsp;саму по себе.</p>\n\n<p style=\"text-align:justify; font-size:18px\">OpenType предусматривает для капители\n    теги&nbsp;<code>smcp</code>&nbsp;(если она выполняет функцию строчных букв)\n    и&nbsp;<code>c2sc</code>&nbsp;(если прописных).</p>\n\n<p style=\"text-align:justify; font-size:18px\">Капитель особенно выразительна в&nbsp;латинице,\n    потому что у&nbsp;большинства букв этого алфавита (19 из&nbsp;26) рисунок\n    строчных знаков существенно отличается от рисунка прописных. Кириллице\n    повезло меньше: разную форму строчных и&nbsp;прописных имеют только &laquo;Аа&raquo;,\n    &laquo;Бб&raquo; и&nbsp;&laquo;Ее / Ёё&raquo;.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Поскольку кириллическая капитель не&nbsp;может\n    выделяться рисунком, ей остаётся выделяться только высотой. Однако в&nbsp;PT&nbsp;Sans\n    Pro разница по высоте между строчными и&nbsp;капительными буквами настолько\n    мизерна, что даже специалисты по шрифтам не&nbsp;распознают её без\n    специальной наводки. По&nbsp;сути, &laquo;Паратайп&raquo; засунул в&nbsp;гарнитуру\n    дублирующий комплект строчных букв, чья польза по меньшей мере\n    сомнительна.</p>\n\n<p style=\"text-align:justify; font-size:18px\">В&nbsp;иностранных шрифтах (которые, по мнению\n    &laquo;Паратайпа&raquo;, &laquo;совершенно непригодны для полиграфии&raquo;)\n    изредка бывает ещё один вид капители, которая действительно по высоте\n    равняется на строчные буквы. По\u2060-\u2060английски она называется&nbsp;<em>petite\n        caps</em>&nbsp;(теги OpenType&nbsp;<code>pcap</code>&nbsp;и&nbsp;<code>c2pc</code>)\n    и&nbsp;неплохо работает, например, чтобы выделять отдельные слова в&nbsp;сплошном\n    тексте. Но&nbsp;это снова достигается из\u2060-\u2060за разницы в&nbsp;рисунке букв,\n    которой нет в&nbsp;кириллице.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Так&nbsp;что &laquo;Паратайп&raquo; налажал\n    дважды: в&nbsp;шрифте PT&nbsp;Sans Pro он намутил &laquo;петитную&raquo;\n    капитель, которая вообще неуместна для кириллицы, однако позиционирует её\n    как обычную капитель и&nbsp;сопровождает тегами&nbsp;<code>smcp</code>&nbsp;и&nbsp;<code>c2sc</code>&nbsp;вместо\n    положенных&nbsp;<code>pcap</code>&nbsp;и&nbsp;<code>c2pc</code>.</p>\n\n<h2 style=\"text-align:justify\">Цифр много, толку мало</h2>\n\n<p style=\"text-align:justify; font-size:18px\">После облома с&nbsp;капителью оставалось\n    надеяться на цифры. Их в&nbsp;PT&nbsp;Sans Pro, почти как у&nbsp;взрослых,\n    четыре начертания (не считая индексов):</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/d48/7b8/8a2/d487b88a25e7f91d62e5713590b2461e.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Почему &laquo;почти&raquo;? Потому что серьёзные\n    производители шрифтов, если уж включают в&nbsp;набор и&nbsp;капитель, и&nbsp;расширенные\n    цифры, то непременно добавляют и&nbsp;<em>капительные цифры</em>. Вот,\n    например, уже упоминавшийся Corpid:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/67a/05b/2cd/67a05b2cd8b300e0985b24429890ea27.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Без этого получается логическая дыра: всё равно\n    что &laquo;шрифт поддерживает кириллицу, шрифт поддерживает прописные\n    буквы, но при этом в&nbsp;нём нет прописной кириллицы&raquo;. Впрочем, я&nbsp;не&nbsp;рассчитывал\n    на логику &laquo;Паратайпа&raquo; и&nbsp;был готов обойтись без капительных\n    цифр. Но&nbsp;ведь и&nbsp;со строчными цифрами тоже вышла упячка.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Дело в&nbsp;том, что цифры часто употребляются с&nbsp;единицами\n    измерения и&nbsp;другими специальными знаками\n    (<em>100&nbsp;%</em>,&nbsp;<em>дом №&nbsp;2/1</em>). В&nbsp;профессиональных\n    шрифтах предусмотрены особые глифы для этих знаков, совместимые со\n    строчными и&nbsp;капительными цифрами. В&nbsp;PT&nbsp;Sans Pro ни&nbsp;черта\n    нет, а&nbsp;прописные знаки со строчными цифрами смотрятся позорно:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/b0b/afa/efb/b0bafaefb7d3caf0e86c68240cee4fc9.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Если&nbsp;бы я&nbsp;использовал в&nbsp;презентации\n    минускульные цифры, но знаки процентов и&nbsp;валют при них продолжали&nbsp;бы\n    оттопыриваться&nbsp;&mdash; вышло&nbsp;бы ещё хуже, чем если вообще не&nbsp;выпендриваться\n    с&nbsp;цифрами.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Вот и&nbsp;получается, что нужные символы в&nbsp;шрифте\n    есть, но пользоваться ими нельзя. А&nbsp;если убрать из PT&nbsp;Sans Pro\n    строчные цифры и&nbsp;капитель, то останется бесплатная версия шрифта. Так&nbsp;что,\n    выходит, я&nbsp;выкинул 7&nbsp;500&nbsp;₽ на воздух. Внимание, сейчас будет\n    ещё одно лирическое отступление.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Лирическое отступление</strong></p>\n\n<p style=\"text-align:justify; font-size:18px\">Конечно, я&nbsp;связался с&nbsp;&laquo;Паратайпом&raquo;,\n    попробовал объяснить проблему и&nbsp;попросил деньги назад. Что\n    удивительно, мне оттуда ответили живые (пока ещё) люди вплоть до начальника\n    технологического отдела Геннадия Фридмана и&nbsp;начальника отдела\n    технического контроля Бориса Левина.</p>\n\n<p style=\"text-align:justify; font-size:18px\">И&nbsp;это оказались два колхозных агронома. С&nbsp;одной\n    стороны, они разбираются в&nbsp;шрифтах немного лучше, чем\n    среднестатистические пользователи ПК, но, с&nbsp;другой стороны, в&nbsp;упор\n    не&nbsp;понимают, чем их профессиональный уровень отличается от\n    мирового.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Даже не&nbsp;знаю, что расстраивает меня больше:\n    то, что мне не&nbsp;вернули денег, или то, что ключевые роли в&nbsp;отечественной\n    культуре (будь то шрифтовое дело, дизайн, архитектура, музыка, кинематограф\n    или даже спорт) аннексировали закоренелые полу\u2060-\u2060специалисты. С&nbsp;петровских\n    времён они подают массам примеры, как делать шрифты, логотипы, пассажирские\n    самолёты, популярные песни и&nbsp;благоустройство улиц почти как на Западе,\n    но в&nbsp;этом &laquo;почти&raquo;&nbsp;&mdash; фундаментальная\n    проблема.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Стоит копнуть тот&nbsp;же PT&nbsp;Sans Pro\n    поглубже&nbsp;&mdash; и&nbsp;полезет столько компоста, сколько ни&nbsp;в&nbsp;один\n    компостер не&nbsp;влезет.</p>\n\n<h2 style=\"text-align:justify\">Наш позор за&nbsp;ваши деньги</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Если&nbsp;я&nbsp;продолжу пример с&nbsp;конфигурацией\n    компьютера, то не&nbsp;смогу вписать туда монитор. Дело в&nbsp;том, что его\n    диагональ&nbsp;24&Prime;, а&nbsp;в&nbsp;PT&nbsp;Sans Pro нет знака дюйма (&Prime;,\n    U+2033), как и&nbsp;фута (&prime;, U+2032). Эти&nbsp;же символы традиционно\n    используются для минут и&nbsp;секунд в&nbsp;интервалах времени (5&prime;10&Prime;)\n    и&nbsp;координатах (17&deg;59&prime;06&Prime; N 76&deg;47&prime;48&Prime; W),\n    так что если вы работаете с&nbsp;таким контентом, то шрифт от &laquo;Паратайпа&raquo;\n    вам не&nbsp;подойдёт.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Моя оторопь по этому пункту связана с&nbsp;тем,\n    что дюйм и&nbsp;фут исторически входят в&nbsp;джентльменский набор\n    типографских знаков вместе с&nbsp;вашими любимыми кавычками, тире,\n    многоточием и&nbsp;крестиком&nbsp;&times;. Этот набор закрепился во всех\n    мыслимых цифровых шрифтах ещё с&nbsp;прошлого века, и&nbsp;сложно\n    представить гарнитуру, в&nbsp;которой были&nbsp;бы кавычки\u2060-\u2060&laquo;ёлочки&raquo;,\n    но при этом не&nbsp;было бы&nbsp;длинного тире. Или была&nbsp;бы левая\n    кавычка, но без правой. Тем не&nbsp;менее &laquo;Паратайп&raquo; нещадно\n    ломает шаблон&nbsp;&mdash; видимо, ради &laquo;развития и&nbsp;сохранения\n    письменной культуры народов&raquo;.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Это не&nbsp;всё, чего не&nbsp;хватает в&nbsp;PT\n    Sans Pro. Ещё в&nbsp;нём нет латинских лигатур, кроме пяти: ff, fi, fl, ffi\n    и&nbsp;ffl. Для сравнения, в&nbsp;латинице Calibri 106&nbsp;штук одних\n    только стандартных строчных лигатур (<code>liga</code>). Зачем так много? А&nbsp;вот\n    сравните:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/ec4/bd5/04f/ec4bd504f0cb0ed131cc613a897551ed.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Надпись, набранная PT&nbsp;Sans&rsquo;ом,\n    выглядит несогласованно, потому что нет лигатуры tti. Можно отключить\n    лигатуры вовсе, но тогда зачем они нужны в&nbsp;шрифте? В&nbsp;общем,\n    профессиональный набор латиницей с&nbsp;PT&nbsp;Sans не&nbsp;светит.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Не&nbsp;получится использовать шрифт и&nbsp;&laquo;в&nbsp;различных\n    дорожных указателях, табличках, информационных щитах и&nbsp;прочих объектах\n    коммуникативного дизайна городской среды&raquo;, как обещают в&nbsp;той&nbsp;же\n    передовице на сайте &laquo;Паратайпа&raquo;, потому что при крупном размере\n    бросаются в&nbsp;глаза уродливые заусенцы в&nbsp;углах знаков:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/90d/770/7b5/90d7707b5b1f5cbce0896eaa563ea06c.png\"\n        style=\"width:420px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">В&nbsp;переписке Геннадий Фридман утверждал, что\n    такие деформации называются&nbsp;<em>компенсаторами</em>&nbsp;и&nbsp;что\n    &laquo;это не&nbsp;простой элемент дизайна, который работает не&nbsp;только\n    при печати, но и&nbsp;на экране и&nbsp;имеет значение именно в&nbsp;мелком\n    кегле&raquo;.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Такой вопиющий случай агрономства требует\n    отдельного теоретического отступления.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Теоретическое отступление</strong></p>\n\n<p style=\"text-align:justify; font-size:18px\">&laquo;Компенсаторы&raquo;, которые вы видели на\n    предыдущей картинке,&mdash; это сделанные по всем правилам&hellip; ловушки\n    для чернил (ink traps). Они применялись во времена металлического набора,\n    чтобы при высокой печати (особенно на плохой бумаге) в углах не\n    образовывались кляксы. Чернила затекали в вырезы, и на странице\n    отпечатывались более-менее чистые формы знаков.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Однако ловушки нужны, если есть проблема с\n    кляксами. А в печатном деле её нет с тех пор, как мир перешёл на офсет,&mdash;\n    то есть несколько десятилетий. На экране кляксы и вовсе отсутствовали\n    изначально, а декольтированные углы PT Sans всё равно лезут в глаза и\n    портят красоту.</p>\n\n<p style=\"text-align:justify; font-size:18px\">&laquo;Паратайп&raquo; перепутал давно вымершую\n    технологическую заморочку с действительно существующей перцептивной\n    проблемой: человеческое зрение устроено так, что геометрически правильные\n    формы иногда воспринимаются как неправильные, одинаковые размеры &mdash;\n    как разные, ровная насыщенность &mdash; как неровная и наоборот. Если\n    изобразить букву&nbsp;<em>О</em>&nbsp;в точности такой же высоты, как&nbsp;<em>П</em>,\n    то глазам будет казаться, будто&nbsp;<em>О</em>&nbsp;меньше, чем хотелось\n    бы.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Чтобы компенсировать зрительные искажения,\n    профессиональные шрифтовики применяют массу геометрических и художественных\n    хитростей &mdash; однако это всё не имеет отношения к средневековым ink\n    traps. Возьмите любой шрифт мирового уровня (хоть Times New Roman, хоть\n    Bierstadt) и изучите буквы под микроскопом. Увидите много интересного по\n    части борьбы с оптическими иллюзиями, но уж никак не чернильные\n    ловушки.</p>\n\n<h2 style=\"text-align:justify\">Медведь на торте</h2>\n\n<p style=\"text-align:justify; font-size:18px\">И&nbsp;под конец&nbsp;&mdash; вишенка на торте,\n    хотя по смыслу это больше медведь на теремке. Я&nbsp;всё\u2060-\u2060таки сверстал\n    пример с&nbsp;конфигурацией компьютера шрифтом PT&nbsp;Sans Pro с&nbsp;тамошней\n    капителью и&nbsp;строчными цифрами, сохранил в&nbsp;PDF и&nbsp;обнаружил\n    ахтунг: обычный поиск по тексту&nbsp;<em>не&nbsp;работает</em>. В&nbsp;моём\n    примере три вхождения аббревиатуры &laquo;LGA&raquo;, но программа\n    просмотра PDF считает, что ни&nbsp;одного:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/635/d49/059/635d490595bd45663aba6f98d9d8fc79.png\"\n        style=\"width:542px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Ни&nbsp;с&nbsp;одним нормальным шрифтом такой\n    проблемы нет, какие&nbsp;бы свойства OpenType ни&nbsp;использовать:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/761/3a4/b25/7613a4b25f013263aa53b0b4b5a8d6e2.png\"\n        style=\"width:542px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Будьте уверены: проблема не&nbsp;в&nbsp;софте,\n    который генерирует файлы PDF, и&nbsp;не&nbsp;в&nbsp;софте, которым я&nbsp;их\n    просматривал. Я&nbsp;протестировал ситуацию в&nbsp;разных приложениях, с&nbsp;разными\n    настройками создания и&nbsp;просмотра PDF: всё ПО спотыкается именно о&nbsp;PT&nbsp;Sans\n    Pro.</p>\n\n<p style=\"text-align:justify; font-size:18px\">То&nbsp;есть, если с&nbsp;этим шрифтом часть\n    текста набрать капителью или строчными цифрами, то эта часть окажется\n    невидимой для компьютера: её не&nbsp;найдёт поиск, на ней не&nbsp;сработает\n    проверка орфографии. Если выложить файл PDF в&nbsp;Интернет, то поисковые\n    системы не&nbsp;смогут его правильно проиндексировать и&nbsp;не&nbsp;выдадут\n    по релевантным запросам.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Чтобы разобраться, в&nbsp;чём затык, я&nbsp;тупо\n    скопировал содержимое PDF&rsquo;а в&nbsp;&laquo;Блокнот&raquo;:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/13a/4f6/b0e/13a4f6b0e017b745be39a2e5950ba363.png\"\n        style=\"width:388px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Что за хрень? Оказывается, если в&nbsp;PT&nbsp;Sans\n    Pro применять свойства OpenType (такие, как капитель&nbsp;<code>c2sc</code>&nbsp;или\n    строчные цифры&nbsp;<code>onum</code>), то подменяется не&nbsp;только глиф,\n    но&nbsp;и&hellip; код символа. Буквы и&nbsp;цифры перестают быть таковыми с&nbsp;точки\n    зрения компьютерного представления.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Поскольку &laquo;Блокнот&raquo; не&nbsp;смог\n    отобразить всю полноту ахтунга, вот ещё шестнадцатеричный редактор:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/eb2/812/a87/eb2812a872d418b8505cc2dc33e5e27e.png\"\n        style=\"width:646px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Всем изменённым символам достались коды&hellip; в&nbsp;диапазоне\n    контрольных кодов ASCII. Например, первая буква текста&nbsp;&mdash;\n    капительная&nbsp;<em>C</em>&nbsp;&mdash; получила код&nbsp;1F (вместо\n    положенного 0043), а&nbsp;строчная цифра&nbsp;0 стала&nbsp;1A (вместо\n    0030).</p>\n\n<p style=\"text-align:justify; font-size:18px\">&bull;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Здесь было&nbsp;бы уместно ещё одно лирическое,\n    техническое или даже административно-процессуальное отступление, но мне\n    кажется, что и&nbsp;без него всё понятно. Все описанные проблемы (и&nbsp;гораздо\n    больше неописанных, а&nbsp;также неописуемых) характерны не&nbsp;только для\n    шрифта PT&nbsp;Sans Pro, но и&nbsp;в&nbsp;целом для продукции компании\n    &laquo;Паратайп&raquo;, в&nbsp;которой (<a\n            href=\"https://info.paratype.ru/o-kompanii/\"\n            rel=\"noopener noreferrer nofollow\">по её собственным словам</a>)\n    &laquo;собрался коллектив высококвалифицированных шрифтовых дизайнеров,\n    программистов, инженеров и&nbsp;менеджеров, по\u2060-\u2060настоящему влюблённых в&nbsp;своё\n    дело&raquo;.</p>\n\n<p style=\"text-align:justify; font-size:18px\">И&nbsp;весь этот влюблённый коллектив уже лет\n    тридцать занимается феерической профанацией шрифтового искусства, пользуясь\n    тем, что бракоделов некому одёрнуть. На&nbsp;родине незамутнённые\n    сограждане принимают паратайповскую лажу за чистую монету, а&nbsp;за\n    границей ни&nbsp;одному специалисту просто в&nbsp;голову не&nbsp;придёт\n    заморачиваться перевоспитанием какой\u2060-\u2060то русской словолитни.</p>",
    "author": "sidorov",
    "category": "дизайн",
    "image": "cd8f812da6c79bfc089a1a072d796087.jpg",
    "status": "archive",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": ""
  },
  {
    "title": "Консольное приложение, которое рисует сердечко на C#",
    "preview": "Данный код не является оптимизированным или идеализированным, он очень простой и будет понятен новичкам(кем я и являюсь), потому надеюсь на понимание). Ну и еще это приложение было создано скорей смеха ради.",
    "body": "<h2>Пролог</h2>\n\n<p style=\"font-size:18px\">Данный код не является оптимизированным или идеализированным, он очень простой и будет понятен новичкам(кем я и являюсь), потому надеюсь на понимание). Ну и еще это приложение было создано скорей смеха ради.<br />\n<br />\nВот, что в результате получилось у меня:</p>\n\n<p style=\"font-size:18px\"><img alt=\"СЕРДЕЧКО СО СЛОВОМ &quot;LOVE&quot;\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/3f9/e58/dcf/3f9e58dcf21a7e45c13f28c1999f6cfe.png\" style=\"height:847px; width:823px\" title=\"СЕРДЕЧКО СО СЛОВОМ &quot;LOVE&quot;\" /></p>\n\n<p style=\"font-size:18px\">СЕРДЕЧКО СО СЛОВОМ &quot;LOVE&quot;</p>\n\n<p style=\"font-size:18px\"><img alt=\"ПОРВАНОЕ СЕРДЕЧКО ИЗ СИМВОЛОВ\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/562/993/374/562993374c2bd56fb7f530140ccf5c9b.png\" style=\"height:808px; width:821px\" title=\"ПОРВАНОЕ СЕРДЕЧКО ИЗ СИМВОЛОВ\" /></p>\n\n<p style=\"font-size:18px\">ПОРВАНОЕ СЕРДЕЧКО ИЗ СИМВОЛОВ</p>\n\n<p style=\"font-size:18px\"><img alt=\"ГИПЕРБОЛА С ОСЯМИ ИЗ ТОЧЕК\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/442/34c/469/44234c469559e329fbb90fd02d26cac8.png\" style=\"height:808px; width:821px\" title=\"ГИПЕРБОЛА С ОСЯМИ ИЗ ТОЧЕК\" /></p>\n\n<p style=\"font-size:18px\">ГИПЕРБОЛА С ОСЯМИ ИЗ ТОЧЕК</p>\n\n<p style=\"font-size:18px\"><img alt=\"КРУГ ИЗ ТОЧЕК\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/977/a9a/a01/977a9aa019dc9b93cc67be2ab3790ca5.png\" style=\"height:839px; width:802px\" title=\"КРУГ ИЗ ТОЧЕК\" /></p>\n\n<p style=\"font-size:18px\">КРУГ ИЗ ТОЧЕК</p>\n\n<h2>Суть работы</h2>\n\n<p style=\"font-size:18px\">У нас есть массив(экран) так же такой массив называют экранный буффер, который выводит на экран пиксели(символы) в определенном порядке. По-сути мы делаем программу которая рисует графики функций(сердечко это тоже просто график функции), минусом такого приложения же будет то, что графики будут крайне не точны, потому что содержат в себе только целые числа, но для вывода фигур по-типу круга, сердца вполне подходит, чем больше масштаб - тем точнее будет.</p>\n\n<h2>Создание</h2>\n\n<p style=\"font-size:18px\">В самой консоле лучше выбрать шрифт &quot;Raster Fonts 8x8&quot; дабы ширина символа = высоте, чтоб в дальнейшем не делить высоту на два.</p>\n\n<pre>\n<code>Console.Title = &quot;HABR @Frog_cry_too&quot;; //TITTLE КОНСОЛИ\nConsole.ForegroundColor = ConsoleColor.Red; //ЦВЕТ ТЕКСТА В КОНСОЛЕ\n\n//ИНИЦИАЛИЗИРУЕМ МАССИВ\nint height = 100, width = 100;\nchar[,] buffer = new char[height, width];\n\n//ЗАДАЕМ РАЗМЕРЫ КОНСОЛИ(РАЗМЕРЫ ТУТ ОПРЕДЕЛЯЮТСЯ ПО-СИМВОЛЬНО, ТОЕСТЬ &#39;СИМВОЛ&#39; = 1)\nConsole.SetWindowSize(width, height);\nConsole.SetBufferSize(width, height);\n\n//ЗАПОЛНЯЕМ МАССИВ\nfor(int i = 0; i &lt; height; i++)\n{\n    for(int j = 0; j &lt; width; j++)\n    {\n        //ВЫВОДИМ ТОЧКУ В ЦЕНТР БУФФЕРА\n        int x = j - width / 2;\n        int y = -1 * (i - height / 2); //ПО-СКОЛЬКУ РЯДЫ МАССИВА БУДУТ ИНИЦИАЛИЗИРОВАТЬСЯ СВЕРХУ ВНИЗ (ОТ 0 ДО 100), НАМ НАДО ДОМНОЖИТЬ НА -1\n\n         //ЗАДАЕМ УСЛОВИЕ ОТБОРА(ПИШЕМ ФУНКЦИИ ПО КОТОРОЙ БУДЕТ РИСОВАТЬСЯ ГРАФИК)\n         //ПО-СКОЛЬКУ ФУНКЦИЯ БОЛЬШАЯ, Я ДЕЛЮ ЕЕ НА ДВЕ ЧАСТИ\n         int firstPart = x * x;\n         int secondPart = (int)((y - Math.Sqrt(Math.Abs(x))) * (y - Math.Abs(x)));\n\n          int heartSize = 500; //РАЗМЕР СЕРДЦА\n\n          if (firstPart + secondPart &lt;= heartSize)\n          {\n              buffer[i, j] = &#39;&hearts;&#39;; //ЗАПОЛНЯЕМ СЕРДЦЕ СИМВОЛОМ КОТОРЫМ ХОТИМ\n          }\n          else\n          {\n              buffer[i, j] = &#39; &#39;; //ЗАПОЛНЯЕМ НЕ НУЖНУЮ НАМ ЧАСТЬ БУФФЕРА СИМВОЛОМ КОТОРЫМ ХОТИМ\n          }\n     }        \n}\n\n//ВЫВОДИМ МАССИВ\nfor(int i = 0; i &lt; height; i++)\n{\n    for(int j = 0; j &lt; width; j++)\n    {\n        Console.Write(buffer[i, j]);\n    }\n    Console.WriteLine();\n}\n\n//ЧТОБ НЕ ВЫВОДИЛСЯ ТЕКСТ ЗАВЕРШЕНИЯ ПРОГРАММЫ\nConsole.ReadLine();</code></pre>\n\n<pre>\n<code>/*РЕЗУЛЬТАТ\nПРАВДА ТУТ ОН ВЫТЯНУТЫЙ, ИБО ШРИФТ ДРУГОЙ), ЧТОБ ОН СТАЛ МЕНЬШЕ ПО\nВЫСОТЕ, ДОСТАТОЧНО X ПОДЕЛИТЬ НА НУЖНЫЙ КООФИЦИЕНТ, НУ ЭТО ПОНЯТНО ИЗ ОСНОВНЫХ\nПОНЯТИЯХ ПО ФУНКЦИЯМ*/\n\n\n                                    &hearts;&hearts;&hearts;&hearts;                     &hearts;&hearts;&hearts;&hearts;\n                                &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;             &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                               &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;       &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                             &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;   &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                             &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts; &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                            &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                            &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                            &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                            &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                             &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                             &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                              &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                              &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                               &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                               &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                 &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                 &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                  &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                   &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                   &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                    &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                     &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                      &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                       &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                        &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                         &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                          &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                           &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                            &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                             &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                              &hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;&hearts;\n                                                &hearts;&hearts;&hearts;&hearts;&hearts;\n                                                 &hearts;&hearts;&hearts;\n                                                  &hearts;</code></pre>\n\n<p style=\"font-size:18px\">ЭПИЛОГ</p>\n\n<p style=\"font-size:18px\">В моем коде я сделал методы вызова разных графиков - для легкого использования (ну и убрал их в отдельный класс). Возможно сделаю вторую часть где покажу код с отдельными методами и возможными вариациями закраски (ну и покажу их принцип).</p>",
    "author": "petrov",
    "category": "дизайн",
    "image": "3f9e58dcf21a7e45c13f28c1999f6cfe.png",
    "status": "archive",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": ""
  },
  {
    "title": "Добавляем ботов в мультиплеерный шутер на Unity",
    "preview": "С ростом проекта в него приходит постоянно приходит новая аудитория: как матерые игроки, так и новички в жанре. Закинуть всех в один матч можно, но первым будет скучно, а вторым — сложно. В итоге всех можно потерять уже на старте.",
    "body": "<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/208/9ea/4ce/2089ea4cee6b90ec6b1eab6f301e7348.jpg\" style=\"height:900px; width:1600px\" /></p>\n\n<p style=\"font-size:18px\">С ростом проекта в него приходит постоянно приходит новая аудитория: как матерые игроки, так и новички в жанре. Закинуть всех в один матч можно, но первым будет скучно, а вторым &mdash; сложно. В итоге всех можно потерять уже на старте.</p>\n\n<p style=\"font-size:18px\">Боты &mdash; не только хороший способ восполнить недостающих игроков в комнате и быстрее начать матч, но и отличная возможность для онбординга новичков. Нам они понадобились, чтобы обучать новичков в тренировочных матчах и давать им нужный пользовательский опыт. Настоящий, живой, который при этом мы могли бы контролировать.</p>\n\n<p style=\"font-size:18px\">В этой статье расскажу, как мы добавляли ботов в свой шутер, настраивали логику, динамическое изменения скилла и многое другое. Все подробности под катом.</p>\n\n<p style=\"font-size:18px\">Изначально в Pixel Gun 3D вообще не было мультиплеера. Уже в процессе быстрого роста и неожиданной популярности мы поняли, что без него нам не обойтись. Когда он был готов, то встал вопрос сделать комфортный онбординг новичков &mdash; чтобы они не страдали в самом начале от ветеранов шутера и не уходили навсегда.&nbsp;</p>\n\n<p style=\"font-size:18px\">Задачей стало добавить ботов, которые бы сами адаптировались под навыки приходящих геймеров. То есть если приходят сильные игроки, то боты автоматически становятся сильнее, если слабые &mdash; слабее. И это бы не зависело от уровня пользователя и наигранных часов, например, даже на максимальном уровне игрок может быть слабым по скиллу.</p>\n\n<p style=\"font-size:18px\">Сделать это нужно было максимально быстро и с минимально возможными ресурсами (мы тогда с головой были в разработке нового контента). Второй момент &mdash; боты должны быть реалистичными, чтобы новичкам было не скучно и они не могли определить, что играют не против людей.</p>\n\n<p style=\"font-size:18px\">С этими вводными приступили к разработке.</p>\n\n<h3>Поведение ботов</h3>\n\n<p style=\"font-size:18px\">Изначально при реализации мультиплеера внедрение ботов не учитывалось. Для управления игроком у клиента и его отображения по сети для других клиентов используется один и тот же префаб с контроллером игрока. Работает это так: если ты являешься владельцем контроллера, ты им управляешь и сообщаешь его состояние остальным. Если нет (чужой игрок), то используется только внешняя часть, ее состояние управляется командами по сети (то есть его владельцем).&nbsp;</p>\n\n<p style=\"font-size:18px\">Получается, что логика управления плотно связана с инпутом клиента, контроллером движения и так далее, но у ботов должно быть реализовано иначе. Решили не изобретать велосипед, не писать новых механик и к уже существующему префабу написать новую логику. Чтобы она управляла ботами будто живой человек.</p>\n\n<p style=\"font-size:18px\">Для быстрой реализации было решено использовать такую схему: контроллер игрока бота для всех является &laquo;чужим&raquo; (в том числе и для клиента, который им управляет) и только отображает его состояние, которое с помощью сетевых команд управляется из отдельного контроллера бота.&nbsp;</p>\n\n<p style=\"font-size:18px\">Таким образом реализуется свой способ движения (контроллер движения по NavMesh) и прочее без серьезной переделки контроллера. При этом контроллер бота синхронизирует свое состояние между всеми игроками, чтобы управление между клиентами перехватывалось незаметно.&nbsp;</p>\n\n<p style=\"font-size:18px\">У нас сетевая игра, где персонажем управляет человек. Есть формат данных, который нам присылает игрок &mdash; где находится, куда смотрит, какая у него анимация, состояние, шмот, пушка. Логика бота про префабу игрока отсылает то же самое, в том же формате, чтобы сократить время реализации, подключения к уже существующей логике.</p>\n\n<p style=\"font-size:18px\">Глобально у ботов есть три состояния:</p>\n\n<ol>\n\t<li>\n\t<p style=\"font-size:18px\">Покоя &mdash; когда противников рядом нет и бот просто передвигается по карте.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Атаки &mdash; когда обнаружен противник и начинается перестрелка.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Поиска &mdash; когда противник, с которым бот перестреливался, исчез из прямой видимости.</p>\n\t</li>\n</ol>\n\n<h3>Состояние покоя</h3>\n\n<p style=\"font-size:18px\">Боты не стоят на картах, они постоянно передвигаются по маршрутам, что-то исследуют и ведут себя так, будто ими управляет реальный игрок. Здесь было две реализации.&nbsp;</p>\n\n<p style=\"font-size:18px\"><strong>Первая реализация</strong></p>\n\n<p style=\"font-size:18px\">Решили, что боты должны бегать по заранее записанным маршрутам &mdash; для этого мы написали инструмент записи таких маршрутов. Во время проектирования новых карт геймдизайнеры и левел-дизайнеры играли на них: бегали, прыгали, осматривались, сохраняя свои действия и маршруты.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Вид глазами геймдизайнера. Так происходила запись маршрутов между точками.\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/9d9/a17/a7b/9d9a17a7b746c93b6f504a9fb4648ab8.png\" style=\"height:704px; width:1251px\" title=\"Вид глазами геймдизайнера. Так происходила запись маршрутов между точками.\" /></p>\n\n<p style=\"font-size:18px\">Вид глазами геймдизайнера. Так происходила запись маршрутов между точками.</p>\n\n<p style=\"font-size:18px\"><em>Вид глазами геймдизайнера. Так происходила запись маршрутов между точками.&nbsp;</em></p>\n\n<p style=\"font-size:18px\">Эти маршруты в дальнейшем использовали боты &mdash; выходили на один из сохраненных путей и шли по нему пока не встречали противника. При этом они не только двигались из точки А в точку Б, но и смотрели по сторонам, останавливались, оглядывались. В общем, имитировали человеческое поведение.</p>\n\n<p style=\"font-size:18px\">Как это выглядело в редакторе:</p>\n\n<p style=\"font-size:18px\"><img alt=\"Первая реализация маршрутов для ботов\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/70e/105/95d/70e10595de440d48da6bbe34f739ec8b.png\" style=\"height:647px; width:916px\" title=\"Первая реализация маршрутов для ботов\" /></p>\n\n<p style=\"font-size:18px\">Первая реализация маршрутов для ботов</p>\n\n<p style=\"font-size:18px\">Красные круги &mdash; путевые точки, а красные черточки с розовой линией &mdash; путь между путевыми точками. Маршрут хранился в массиве, каждый объект которого включал: координаты точки, временем, через которое бот должен быть там, скорость бота, и информацию нужно ли прыгать в этом месте.</p>\n\n<p style=\"font-size:18px\">Маршрутов было много, поэтому одинаковое поведение было крайне сложно заметить. Хотя вариант был хороший и правдоподобный, на их запись уходило много времени, поэтому от него отказались.</p>\n\n<p style=\"font-size:18px\"><strong>Вторая итерация</strong></p>\n\n<p style=\"font-size:18px\">Сейчас на проде &mdash; система с контрольными точками по карте. Теперь играть самому стало не нужно: открывается сцена, расставляются точки, проверяются связи между ними. Сами связи для создания маршрутов добавляются либо автоматически, либо настраиваются вручную. Можно сохранить систему для конкретного режима игры, например, для захвата флагов у ботов одни кластеры с точками интереса, а для командного боя &mdash; другие.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Окно редактора для новой системы контрольных точек. Синие линии на сцене между зелеными точками показывают примерный путь бота по NavMesh.\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/854/00c/5b1/85400c5b1f8ae657d79ab6eee1893927.png\" style=\"height:737px; width:1387px\" title=\"Окно редактора для новой системы контрольных точек. Синие линии на сцене между зелеными точками показывают примерный путь бота по NavMesh.\" /></p>\n\n<p style=\"font-size:18px\">Окно редактора для новой системы контрольных точек. Синие линии на сцене между зелеными точками показывают примерный путь бота по NavMesh.</p>\n\n<p style=\"font-size:18px\">В состоянии покоя бот не ищет врага, в том смысле, что он наверняка не знает его позиции. Бот передвигается по точкам на основе случайного выбора с учетом расставленных весов. Наиболее весомые точки расположены в популярных местах сражений.&nbsp;</p>\n\n<p style=\"font-size:18px\">Для использования трамплинов и других вертикальных перемещений были расставлены и настроены OffMeshLink, чтобы бот мог перемещаться между разными поверхностями карты по кратчайшим путям к нужному месту. В итоге, двигаясь от точки к точке по NavMesh, бот непременно зайдет в одно из таких мест и обнаружит там скопление игроков.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Окно редактора с расставленными контрольными точками. Голубым цветом выделены поверхности NavMesh, по которым бот может прокладывать путь. Синие стрелки — OffMeshLink. Когда их достигает бот, то попадает в блок кода, который управляет его перемещением по ним.\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/b68/7d2/eed/b687d2eed118840fcebcc0dd8e577710.png\" style=\"height:738px; width:1128px\" title=\"Окно редактора с расставленными контрольными точками. Голубым цветом выделены поверхности NavMesh, по которым бот может прокладывать путь. Синие стрелки — OffMeshLink. Когда их достигает бот, то попадает в блок кода, который управляет его перемещением по ним.\" /></p>\n\n<p style=\"font-size:18px\">Окно редактора с расставленными контрольными точками. Голубым цветом выделены поверхности NavMesh, по которым бот может прокладывать путь. Синие стрелки &mdash; OffMeshLink. Когда их достигает бот, то попадает в блок кода, который управляет его перемещением по ним.</p>\n\n<p style=\"font-size:18px\">В этом же состоянии бот может искать аптечки и броню. Он проверяет, нужно ли ему подлечиться, потом вычисляется шанс по AI-level (об этом ниже) &mdash; пойдет он в итоге за бонусом или нет.</p>\n\n<p style=\"font-size:18px\">Если бот решил, что ему нужна аптечка или броня, то с помощью NavMesh вычисляется путь до бонуса через NavMesh.CalculatePath. Местоположение всех активных бонусов на карте он получает из отдельного класса, который управляет бонусами &mdash; BonusController. Выберется тот бонус, путь к которому имеет состояние NavMeshPathStatus.PathComplete или NavMeshPathStatus.PathPartial. В последнем случае начнется проверка: далеко ли самая последняя точка вычисленного пути (ууспело рассчитать) лежит от бонуса. Если приемлемое расстояние, то бот побежит даже по не до конца построенному пути.</p>\n\n<h3>Состояние атаки</h3>\n\n<p style=\"font-size:18px\">Бот знает только об игроках, которые находятся непосредственно в его зоне видимости (препятствия тоже мешают его обзору). Здесь никаких читов &mdash; все по-честному. Боты обнаруживают игроков в стандартном для всех пользователей Field of View. Если ему на глаза попался противник (если их несколько, то выбирает случайного), то он решает атаковать или нет.</p>\n\n<p style=\"font-size:18px\">Чтобы бои были действительно интересными, поведение ботов настраивается под поведение настоящих игроков: бот может убежать, перейти в ближний бой и даже использовать гаджеты, при движении стрейфится. Для этого в состоянии атаки выполняется цикл с различными проверками: сколько HP у бота, сколько у него целей, где расположена цель и так далее. Бот принимает определенное решение по результатам проверки и случайного выбора на основе своего AI-level.</p>\n\n<h3>Динамический AI-level</h3>\n\n<p style=\"font-size:18px\">Чтобы разноуровневым игрокам было одинаково интересно играть, боты автоматически меняют свой AI-level (скилл), основываясь на киллрейте (количество убийств к смертям) бота, игроков и текущем счете. Таких уровней у нас сейчас настроено 4, но их может быть любое количество.</p>\n\n<p style=\"font-size:18px\">Когда киллрейт выходит за заданные границы диапазона для своего уровня, то меняется в какую-либо сторону. Если нам нужно, чтобы бот стал сильным и напал на кого-то, ставим высокий AI-level: он почти не промахивается, чаще бежит, от него сложнее скрыться, а поведение становится агрессивным. Если нужно, чтобы он был слабым, уменьшаем AI-level: он реже стреляет, чаще промахивается, медленнее бегает, меньше стрейфится.</p>\n\n<p style=\"font-size:18px\">От AI-level зависит множество параметров (чем он выше, тем бот сильнее в своих параметрах):</p>\n\n<ul>\n\t<li>\n\t<p style=\"font-size:18px\">расстояние для выбора цели;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">выбор другого бота или игрока, если есть и те и другие на доступном расстоянии;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">должен ли попытаться пойти за бонусом (патроны, броня, хп);</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">должен ли уклоняться при сражении в ближнем/дальнем бою;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">должен ли прыгать при сражении в ближнем/дальнем бою;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">должен ли догонять цель при сражении;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">как долго будет догонять игрока;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">должен ли стрелять бот с уроном, или только визуально показывает стрельбу;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">минимальные и максимальные значения для прицеливания у бота;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">делает паузы при стрельбе или нет;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">скорость поворота в бою (когда у бота есть цель в прямой видимости);</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">скорость наведения на врага;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">переключение на стреляющего в него игрока;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">бросает ли гранаты или меняет оружие, когда нужно перезарядиться;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">какой тип оружия он может взять;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">для баланса команд, если вдруг команда начинает проигрывать, и у нее есть боты, то им поднимается уровень.</p>\n\t</li>\n</ul>\n\n<p style=\"font-size:18px\">Все параметры мы можем регулировать удаленно из конфига приложения, чтобы сделать поведение еще лучше.</p>\n\n<p style=\"font-size:18px\">Параметры задают шанс для выбора действия или значения параметра. Он определяется довольно просто. Есть число 0.88 в качестве параметра, выбираем от 0 до 1 с плавающей точкой: если попали в диапазон от 0 до 0,88 &mdash; успех, действие будет выбрано, от 0,89 до 1 &mdash; неудача. Значение параметра выбирается случайно от заданного минимального значения до максимального, чтобы, например, та же точность не была всегда одинаковой. Некоторые параметры считаются каждый раз, когда нужно совершить какое-либо действие (точность выстрела), другие &mdash; несколько раз в секунду (для выбора решения о действии, например, бросок гранаты).&nbsp;</p>\n\n<p style=\"font-size:18px\">В первых матчах пока идет онбординг игрок должен победить, поэтому боты смотрят еще и на счет в матче: если команда игрока начинает проигрывать, силы корректируются &mdash; в ней повышается уровень ботов, а в другой снижается. И наоборот, если команда игрока начинает выигрывать с сильным перевесом, то скилл ботов противоположной команды увеличивается, чтобы игроку не было скучно играть. Таким образом, незаметно для игроков все время поддерживается интерес: сильная команда получает достойных противников, а слабая &mdash; не теряет надежду на победу.</p>\n\n<h3>Состояние поиска</h3>\n\n<p style=\"font-size:18px\">И, наконец, последнее состояние. Если противник скрылся, например, забежал за препятствие, то бот следует на последнюю видимую позицию врага. Если он его там не находит, то переходит в состояние покоя и возвращается к ближайшей контрольной точке, чтобы дальше перемещаться по карте.</p>\n\n<h3>Вместо заключения</h3>\n\n<p style=\"font-size:18px\">Всеми этими настройками боты подводятся под нужное нам поведение. Мы добавили их почти во все режимы, но нужны они далеко не всегда и не везде. Например, у нас их нет в батлрояле, так как режим очень популярный и 100 человек на комнату находятся крайне быстро.</p>\n\n<p style=\"font-size:18px\">Боты вообще очень гибкая штука. Мы их включаем, когда нужно заонбордить новичка или когда не хватает игроков, чтобы заполнить комнату. При этом, если реальные пользователи подключаются, то они бесшовно вытесняют ботов. Это все происходит без участия пользователей и какого-либо голосования &laquo;добавляем ботов или нет&raquo; &mdash; матчмейкинг видит, что комната занята ботами, поэтому он коннектит игрока, а бот просто уничтожается со всем своим прогрессом на карте. Для внимательного игрока это будет выглядеть будто один игрок ушел и на его место быстро нашлась замена.</p>",
    "author": "sidorov",
    "category": "дизайн",
    "image": "2089ea4cee6b90ec6b1eab6f301e7348.jpg",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "18.10.21 01:55:19"
  },
  {
    "title": "Система «Мёртвая рука»: автоматизация ядерного армагеддона",
    "preview": "Как я писал в одной из предыдущих статей, в 70-е годы советское руководство столкнулось с новым стратегическим вызовом. В связи с появлением высокоточного ядерного оружия и развёртывания в Европе ракет, способных за считаные минуты достичь Москвы и других важнейших целей на западе СССР, время реакции на ядерное нападение сократилось с часов и десятков минут до нескольких минут или даже секунд.",
    "body": "<p style=\"text-align:justify; font-size:18px\"><a href=\"https://habr.com/ru/company/ruvds/blog/582544/\"><img src=\"https://habrastorage.org/r/w780/webt/jd/ri/-n/jdri-nj8f3xeszpxng3ry3mtkiq.jpeg\" /></a></p>\n\n<p style=\"text-align:justify; font-size:18px\"><br />\nКак я писал в одной из&nbsp;<a href=\"https://habr.com/ru/company/ruvds/blog/581140/\">предыдущих статей</a>, в 70-е годы советское руководство столкнулось с новым стратегическим вызовом. В связи с появлением высокоточного ядерного оружия и развёртывания в Европе ракет, способных за считаные минуты достичь Москвы и других важнейших целей на западе СССР, время реакции на ядерное нападение сократилось с часов и десятков минут до нескольких минут или даже секунд.<br />\n<br />\nОдним из ответов стала разработка советского &laquo;ядерного чемоданчика&raquo;: абонентского терминала автоматизированной системы управления стратегическими ядерными силами &laquo;Казбек&raquo;, получившего кодовое наименование &laquo;Чегет&raquo;. Из него руководитель СССР мог отдать приказ о ядерном ударе из любой точки страны в любой момент: была бы связь.<br />\n<br />\nОднако, во-первых, никто не гарантировал, что &laquo;Чегетом&raquo; успели бы воспользоваться. Во-вторых, проблемой была именно связь: и в условиях электромагнитных последствий ядерных ударов, и в связи со всё более совершенными системами радиоэлектронной борьбы и глушения этой самой связи.<br />\n<br />\nПоэтому в СССР было принято решение создать систему, которая могла бы инициировать ответный ядерный удар даже в том случае, если бы никто из отвечающих за это лиц не имел бы возможности это сделать. Для надёжности новая система дублировала главную систему управления, связи и взаимодействия советских ракетных войск стратегического назначения &ndash; тот самый &laquo;Казбек&raquo;. Она получила название &laquo;Периметр&raquo;.<br />\n&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img src=\"https://habrastorage.org/r/w780/getpro/habr/post_images/bf8/761/2fb/bf87612fb176f26bbc89b2e4df020518.jpg\" /></p>\n\n<p style=\"text-align:justify; font-size:18px\"><br />\n&laquo;Периметр&raquo; до сих пор стоит на вооружении и продолжает модернизироваться. Подробности о нём, естественно, глубоко засекречены &mdash; но самая суть этой системы заключается в том, чтобы вероятный противник знал о её существовании, и лишний раз подумал перед радикальными шагами. В том числе поэтому о ней регулярно пишут в российской прессе.<br />\nНасколько можно судить, система &laquo;Периметр&raquo; представляет собой резервную систему кодированной связи между военными объектами и кораблями, оснащёнными ядерным оружием, и специальным очень мощным передатчиком. Этот транслятор в &laquo;час Ч&raquo; должен передать всем терминалам сигнал о применении спецбоеприпасов по заранее предписанным на такой случай планам и целям.<br />\nПередатчик установлен на специальной ракете (или ракетах), находящейся (или находящихся) в глубоко законспирированных местах. Хотя бы какие-то подробности и фотографии имеются только про раннюю модель, командную ракету 15А11 (она же 15П011) разработки и производства КБ &laquo;Южное&raquo; в Днепропетровске, испытывавшуюся в 1980-е годы на Байконуре и первой поставленную на вооружение.<br />\n&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img src=\"https://habrastorage.org/r/w780/getpro/habr/post_images/509/36a/fc6/50936afc63fcad5b2b05d187ae89ab44.jpg\" /></p>\n\n<p style=\"text-align:justify; font-size:18px\"><br />\nРазработку будущей системы &laquo;Периметр&raquo; начали по секретному решению руководства СССР в августе 1974 года, когда опасность потенциального обезглавливающего удара высокоточными ракетами средней дальности из Европы была осознана в Москве.<br />\nРазработка ключевого элемента системы, тех самых ракет с трансляторами, была поручена днепропетровскому КБ &laquo;Южное&raquo;. За основу взяли их же межконтинентальную баллистическую ракету УР-100, она же SS-17.<br />\nОсобую головную часть с мощным передатчиком разработали в Ленинградском политехе и пустили в производство в оренбуржском НПО &laquo;Стрела&raquo;. В 1979 году начались первые испытательные старты.<br />\n<br />\n<br />\nНа ключевых испытаниях в ноябре 1984 года стартовавшая из-под Полоцка 15А11 вышла на высоту около 4 километров и передала сигнал на шахту с межконтинентальной баллистической ракетой Р-36М под Байконуром. Та, в свою очередь, стартовала и поразила условную цель на полигоне Кура на Камчатке. Испытания признали успешными.<br />\n<br />\nСистема &laquo;Периметр&raquo; заступила на боевое дежурство в январе 1985 года, когда перспектива открытой ядерной войны между СССР и США выглядела до опасного реальной. Естественно, установки с ракетами &laquo;Периметра&raquo; обслуживают военнослужащие, но многое в её работе предельно автоматизировано для исключения человеческого фактора.<br />\n<br />\nВ то же время, есть данные, что она работает не в режиме постоянной готовности, а может включаться и выключаться по решению высшего руководства России. Это делается для минимизации шансов на возможную ошибку, которая может стоить жизни всему человечеству. &laquo;Периметр&raquo; должен включаться в режим готовности тогда, когда вероятность ядерной войны становится реальной.<br />\n<br />\nПри этом в некоторой степени он страхует от слишком быстрого нажатия &laquo;кнопки&raquo; в нервной обстановке: у принимающих решение о начале или не начале ядерной войны есть некоторая уверенность, что даже при прилёте непосредственно в них спецбоеприпаса ответный удар всё равно состоится, и потому можно лишний раз выдохнуть и всё взвесить.<br />\n&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img src=\"https://habrastorage.org/getpro/habr/post_images/71a/14b/ad1/71a14bad12bcb0bee92a7ed3cce8f423.webp\" /></p>\n\n<p style=\"text-align:justify; font-size:18px\"><br />\nРешение о запуске процедуры автоматизированного ядерного удара включённый &laquo;Периметр&raquo; &mdash; насколько известно широкой публике &mdash; принимает автоматически на основе поступающих на его объекты данных с развёрнутой по всей территории России системы сенсоров. Они &laquo;снимают&raquo; множество показателей: уровень радиационного фона и электромагнитного излучения, ионизацию, сейсмические волны, температуру воздуха у потенциальных целей, интенсивность военного и гражданского радиообмена, не говоря уже о сведениях с систем раннего оповещения РВСН.<br />\n<br />\nЭти данные непрерывно поступают в системы даже &laquo;спящего&raquo; Периметра. Если складывающаяся на основе этих данных картина (мощные сейсмические импульсы на месте городов и важных целей, резкий рост радиационного фона, электромагнитные импульсы) недвусмысленно указывает на множественные ядерные удары по российской территории &mdash; система запрашивает связь с российским Генштабом. Если связь есть, то дальнейшие решения она оставляет ему. Если связи нет &mdash; она запрашивает контакт с основной системой управления ядерным оружием &laquo;Казбек&raquo;. Если не отвечает и &laquo;Казбек&raquo;, идёт запрос на прописанные в программе командные бункеры в поисках хотя бы кого-то из ответственных лиц, имеющих полномочия принимать решения о ядерной войне.<br />\n<br />\nЕсли сенсоры указывают на массированные ядерные удары, но никто из людей не отвечает на запросы, то искусственный интеллект &laquo;Периметра&raquo; говорит &laquo;Зовите меня &laquo;Скайнет&raquo;, и автоматически принимает решение о запуске процедуры ответного ядерного удара. Ракеты с передатчиками стартуют, дают сигналы на уцелевшие пусковые.<br />\n<br />\nДальнейшее понятно.<br />\n<br />\nТакже поговаривают, что &laquo;Периметр&raquo; может работать в режиме &laquo;будильника Апокалипсиса&raquo;: если он запущен, но так не был выключен за некоторое время, то автоматическое применение ядерного оружия также становится неизбежным. Правда, это, на мой взгляд, уже выглядит немного сомнительным, и заставляет вспомнить что-то из &laquo;Доктора Стрейнджлава&raquo;.<br />\n&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img src=\"https://habrastorage.org/r/w780/getpro/habr/post_images/834/0cc/bf6/8340ccbf6bfc1b72740b6b7e085e798c.jpg\" /></p>\n\n<p style=\"text-align:justify; font-size:18px\"><br />\nВ оставшиеся годы существования СССР система &laquo;Периметр&raquo; была сугубо секретной. Всё изменилось в октябре 1993 года, когда в The New York Times вышла статья Уильяма Брода &laquo;Машина Судного дня России&raquo; (https://www.nytimes.com/1993/10/08/opinion/russias-doomsday-machine.html). В ней со ссылкой на эксперта Брукингского института Брюса Блейра и его интервью с выходцами из бывшего СССР утверждалось, что в СССР была создана &laquo;машина судного дня&raquo;. Блейр вкратце описал вышесказанное. И предположил, что при любых степенях защиты подобные автоматизированные системы всё равно могут стать жертвой ошибок и случайностей, тем более, в состоянии только что распавшегося СССР &mdash; не забыв упомянуть в качестве примера всё того же &laquo;Доктора Стрейнджлава&raquo;.<br />\n<br />\nИз этой статьи пошло и более известное название системы &laquo;Периметр&raquo;: &laquo;Мёртвая рука&raquo;. По словам автора, так её прозвали в СССР, но из российских источников этого не следует &mdash; вполне возможно, Уилл Брод слегка досочинил ради хлёсткой фразы.<br />\n<br />\nСтатья вызвала оживлённые споры в американских военных и разведывательных кругах: одни считали это полной выдумкой, другие считали нужным разобраться. Директор Центральной разведки (не путать с директором входящего в её состав ЦРУ) Роберт Гейтс назвал сведения &laquo;невероятными, но не невозможными&raquo; в свете &laquo;уже ставших известными сюрпризов&raquo;, и предложил запросить пояснений у президента Ельцина, функционирует ли эта система после распада СССР. Правда, и ЦРУ, и руководство Пентагона, о Госдеп с Белым домом от комментариев воздержались, а в Москве тем более промолчали.<br />\n&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img src=\"https://habrastorage.org/r/w780/getpro/habr/post_images/044/ba5/a55/044ba5a559009410dd9e2abea0966331.jpg\" /></p>\n\n<p style=\"text-align:justify; font-size:18px\"><br />\nНасколько, опять же, известно из открытых источников &mdash; изначальные ракеты-передатчики 15А11 сняли с вооружения ещё в середине 90-х по договору СНВ-1. Впрочем, через некоторое время их заменили на какие-то другие, уже на базе ракет, собиравшихся на территории Российской Федерации.<br />\n<br />\nСекрет, во-первых, перестал быть секретом, во-вторых, система давно уже не та, какой была на момент утечек в начале 90-х, и, третьих и главных, в широко известном &laquo;Периметре&raquo; гораздо больше смысла, чем в засекреченном. Поэтому с начала 2010-х в российской прессе эта тема стала всё более открыто обсуждаться. В декабре 2011 года существование и продолжение функционирования &laquo;Периметра&raquo; открыто подтвердил &laquo;Комсомольской правде&raquo; тогдашний командующий РВСН Сергей Каракаев. Появились подробности и от разработчиков, к примеру, Владимира Ярынича.<br />\n<br />\nНекоторые источники, к примеру, сотрудник НИЦ прикладной информатики Пётр Казульский утверждают о наличии в сердце системы суперкомпьютеров на самых защищённых и сверхсекретных военных базах, способных некоторое время продолжать функционировать даже после попаданий боеприпасов редкого ныне мегатонного класса. Он же говорит, что ракеты &mdash; не единственный контур передачи команд &laquo;Периметра&raquo; на пусковые.<br />\nПоговаривают даже о нейросетях &ndash; хотя их некоторая непредсказуемость вызывает сомнения в возможности применения в настолько ответственном деле.<br />\n<br />\nВедь мы вряд ли хоnим породить настоящий &laquo;Скайнет&raquo;.</p>",
    "author": "petrov",
    "category": "менеджмент",
    "image": "jdri-nj8f3xeszpxng3ry3mtkiq.jpeg",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "25.09.21 01:55:19"
  },
  {
    "title": "4 способа для поиска креативов конкурентов",
    "preview": "Одним из наиболее важных этапов запуска дропшиппинг-магазина является создание рекламных креативов. Вы можете грамотно подобрать товар, собрать сайт и настроить рекламу, но если ваши креативы не будут цеплять, рекламный бюджет будет использоваться неэффективно даже при условии попадания в целевую аудиторию. Чтобы избежать этого, необходимо изначально продумать концепцию и структуру ролика, подобрать качественные видео и изображения, написать продающий текст.",
    "body": "<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/f3c/a5f/c90/f3ca5fc903d82295c2efc7516123a2e5.jpg\" style=\"height:457px; width:942px\" /></p>\n\n<p style=\"font-size:18px\">Одним из наиболее важных этапов запуска дропшиппинг-магазина является создание рекламных креативов. Вы можете грамотно подобрать товар, собрать сайт и настроить рекламу, но если ваши креативы не будут цеплять, рекламный бюджет будет использоваться неэффективно даже при условии попадания в целевую аудиторию. Чтобы избежать этого, необходимо изначально продумать концепцию и структуру ролика, подобрать качественные видео и изображения, написать продающий текст.</p>\n\n<p style=\"font-size:18px\">Существует несколько разных вариантов креативов: картинки, слайд-шоу, видео, видео с подписями, анимация, смешанные креативы. В случае, когда вы хотите узнать, что вероятнее всего сработает хорошо, лучше для начала проанализировать креативы конкурентов. Таким образом, мы сможем узнать, какие креативы являются наиболее эффективными, а также, наберем несколько идей для создания собственных креативов. Сегодня разберем 4 основных бесплатных способа поиска креативов магазинов-конкурентов.</p>\n\n<h3>1. Лента Facebook, Instagram</h3>\n\n<p style=\"font-size:18px\">Переходим в ленту, видим рекламное объявление конкурента либо магазина из ниши, которая нам может быть интересна.</p>\n\n<p style=\"font-size:18px\">Лайкаем, сохраняем, переходим по ссылке, добавляем товар в корзину, переходим в чекаут и выходим.</p>\n\n<p style=\"font-size:18px\">После прохождения нами такого алгоритма Facebook начнет рассматривать нас как целевую аудиторию магазинов-конкурентов и, соответственно, будет показывать нам больше рекламы.</p>\n\n<h3>2. Поисковая строка в Facebook</h3>\n\n<p style=\"font-size:18px\">Если вам не показывается реклама, которая нужна, заходим в Facebook, в поисковую строку вбиваем названия товаров, которые мы собираемся крутить. Слева в столбце выбираем необходимый нам временной промежуток.</p>\n\n<p style=\"font-size:18px\">Переходим на вкладку видео, заходим на страницы конкурентов, таким же образом лайкаем посты, кликаем на магазин и доходим до чекаута. Достаточно проделать так с 10 магазинами, после чего вам начнет литься реклама в инсте.</p>\n\n<h3>3. Библиотека объявлений</h3>\n\n<p style=\"font-size:18px\">Крутой, но не всем известный способ поиска креативов конкурентов. Переходим на активную страницу магазина-конкурента в Facebook. Находим страницы через поисковую строку, либо переходим на Facebook напрямую с сайта. Самое важное - найти именно активную страницу, которая подключена к рекламному кабинету.</p>\n\n<p style=\"font-size:18px\">На странице справа находим блок &quot;Прозрачность страницы&quot;, кликаем на &quot;Еще&quot;, затем &quot;Перейти в библиотеку рекламы&quot;.</p>\n\n<p style=\"font-size:18px\">В фильтре выбираем все страны, и нам открывается список активных рекламных объявлений, которые крутятся с данной страницей. Мы можем увидеть количество объявлений, даты запуска, выбранные плейсменты, тексты, ссылки, а также можем легко скачать видео.</p>\n\n<p style=\"font-size:18px\">Чтобы посмотреть активные рекламные объявления в приложении Instagram, переходим на аккаунт магазина, нажимамаем в правом верхнем углу на три точки - об этом аккаунте - активные объявления. Таким образом, мы попадаем в ту же библиотеку объявлений, только с телефона. Важно, чтобы инстаграм аккаунт был привязан к странице, которая подключена к рекламному кабинету.</p>\n\n<h3>4. Поиск через spy-сервисы</h3>\n\n<p style=\"font-size:18px\">В интернете большое количество сервисов, с помощью которых можно находить трендовые товары, описания, креативы, аудитории и др. У большинства сервисов есть бесплатные подписки, ограниченные сроком (обычно 7 дней) или количеством запросов в день. Обычно бесплатной версии достаточно, но, возможно, при регистрации придется цеплять банковскую карту (подписку можно будет отменить, и деньги с карты не спишутся).</p>\n\n<p style=\"font-size:18px\">Для поиска креативов одним из самых эффективных сервисов является AdSpy. С его помощью можно находить рекламные объявления по ключевым словам, фильтровать по странам, плейсментам, языку, формату, сортировать по лайкам и комментариям и т.д. Цена на официальном сайте &ndash; $149/мес. Подписчикам нашего сообщества мы даем&nbsp;<a href=\"https://ru.ecomlife.pro/blog/obzor-spy-servisa-adspy\" rel=\"noopener noreferrer nofollow\">полный доступ к сервису с 90% скидкой</a>.</p>\n\n<p style=\"font-size:18px\">Также, можно рассмотреть другие сервисы, перечисленные ниже:</p>\n\n<p style=\"font-size:18px\"><a href=\"https://www.salesource.io/\" rel=\"noopener noreferrer nofollow\">SaleSource</a><br />\n<a href=\"https://www.sellthetrend.com/\" rel=\"noopener noreferrer nofollow\">SellTheTrend</a><br />\n<a href=\"https://bigspy.com/\" rel=\"noopener noreferrer nofollow\">BigSpy</a><a href=\"https://ecomhunt.com/\" rel=\"noopener noreferrer nofollow\">EcomHunt</a></p>\n\n<p style=\"font-size:18px\">Используйте все вышеперечисленные методы в совокупности, чтобы создать наиболее эффективные и продающие креативы для вашего интернет-магазина.</p>",
    "author": "sidorov",
    "category": "менеджмент",
    "image": "f3ca5fc903d82295c2efc7516123a2e5.jpg",
    "status": "correction",
    "comment_moderator": "Тема поста не соответствует содержанию.",
    "moderator_id": "ivanov",
    "published_at": ""
  },
  {
    "title": "«За что я плачу вам деньги если всё работает?»",
    "preview": "Держать своего «сетевика» или отдать всё на аутсорсинг? И как выстроить с ним отношения?",
    "body": "<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/webt/ks/zy/0h/kszy0hxh8tqsmddw87cppudnuny.png\" /></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><em>Держать своего &laquo;сетевика&raquo; или отдать всё на аутсорсинг? И как выстроить с ним отношения?</em></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><em>Нужно ли дополнительно стимулировать, мотивировать и контролировать такого сотрудника или возможно изобрести какой-то свой способ, чтобы управлять процессом?</em></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><em>Как не навредить своему бизнесу?</em></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><em>Нужна ли экономия на всём и везде?</em></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><em>Статья аккумулирует многолетний опыт общения системного администратора с разными заказчиками. Почитать будет полезно как исполнителям, так и заказчикам. Первым, чтобы знать, что требовать и где &laquo;соломки подстелить&raquo;, вторым, чтобы не придумывать &laquo;сферического коня в вакууме&raquo;, а реально подходить к делу при постановке задачи и оплате.</em></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h2>Приходящий специалист или штатный сотрудник на весь рабочий день?</h2>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<blockquote><strong>Важное замечание.</strong><br />\n<br />\nМы не говорим о крупных аутсорсинговых компаниях и системных интеграторах, где практикуется целенаправленный сбор и подготовка специалистов, с целью последующего предоставления услуг.<br />\n<br />\nХотим мы этого или нет, но российское IT до сих пор состоит из малых организационных единиц. Даже в крупных городах-миллионниках большую роль играют небольшие предприятия (звучит как каламбур). Какая-нибудь торговая фирма до 200 человек, работающая частично на &laquo;удалёнке&raquo; &mdash; для многих российских компаний это предел самостоятельного развития бизнеса с нуля.<br />\n<br />\nТакая компания не может нанять себе целый штат сотрудников, занимающихся исключительно сетевым сегментом. И, чтобы воспользоваться услугами &laquo;сетевика&raquo;, приходится искать хорошего специалиста, работающего по договору.</blockquote>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h3>Когда штатный сотрудник превращается в приходящего специалиста</h3>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">У многих сетевых администраторов и инженеров достаточно высокие шансы перейти в разряд приходящего специалиста с выгодой для себя.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<ol>\n\t<li>При настройке сетевого оборудования гораздо больше подходит принцип &laquo;Работает? Нормально работает? &mdash; Не трогай!&raquo;. Некоторые вещи, такие как настройка маршрутизации, испортить достаточно просто, а быстро разобраться в проблеме не всегда получается. Поэтому рабочий день у сетевика в малой организации часто превращается в &laquo;просиживание штанов&raquo;, и на него стремятся повесить любые технические работы от вкручивания лампочек до пожарной сигнализации. Когда ему это надоедает, и чтобы сохранить себя в профессии &mdash; он либо уходит из компании, либо переходит в разряд приходящих админов.</li>\n\t<li>Сетевые технологии, как область знания, достаточно консервативны. Это не разработка ПО, где каждые полгода рождается очередной &laquo;кадавр&raquo;, и всё срочно начинают соображать, что с этим &laquo;чудом&raquo; делать, мигрировать на него или нет? Сетевое оборудование может годами работать без кардинальных изменений. И если не выходит новых прошивок, то бывает, что и делать особо нечего.</li>\n\t<li>Хочется чего-то нового. У штатного админа даже не в малой, в средней компании часто ничего особенного не происходит. Один и тот же набор оборудования, купленного &laquo;на века&raquo;, одна и та же корпоративная политика, не меняющаяся годами из разряда &laquo;этих пускать, а этих &mdash; блокировать&raquo;, в общем тоска.</li>\n</ol>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Отлично, когда всё &laquo;тихо едет, не скрипит&raquo;, но, в то же время особых возможностей для саморазвития не появляется. А в IT сфере как: если не изучать что-то новое, то сегодня ты востребованный специалист, завтра &mdash; вроде ещё ничего, послезавтра &mdash; отстал и выброшен на обочину.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h3>Преимущества превращения в приходящего админа/инженера</h3>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Во-первых, больше шансов с толком использовать своё время. Не просиживать штаны или вкручивать лампочки, попутно помогая дамам из бухгалтерии формировать отчёт, а успевать выполнить заявки большего числа организаций, и получить суммарно больший доход.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Во-вторых, большее разнообразие. У кого-то новый маршрутизатор появился, с которым надо разобраться, у кого-то сеть целиком переделывают, где-то требуется переделать WiFi, потому что старая схема не справляется с нагрузкой...</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h3>А это действительно выгодно?</h3>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">На сегодня сложилась практика, что приходящему админу можно платить меньше. С другой стороны, эта же практика стимулирует заказчиков заключать контракты с внешними подрядчиками, проще говоря, искать приходящих специалистов</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">На данный момент ситуация, когда выгодней свой постоянный сетевой администратор на полный рабочий день, не так уж часто встречается. Разве что текущий сотрудник работает суперкачественно за предельно маленькую зарплату и от него совершенно не требуется повышать свой профессиональный уровень. И всё равно начальство нет-нет да задаётся вопросом: &laquo;А так ли уж нам нужен этот &laquo;сиделец на одном месте&raquo;?&raquo; Потому поиск хорошего приходящего профильного специалиста взамен штатного сотрудника &mdash; наиболее распространённое решение подобных противоречий.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">С другой стороны, за всё приходится платить.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Например, какие-то мелкие проблемы, которые в принципе не мешают в работе &mdash; проще проигнорировать, чем лишний раз вызывать приходящего админа.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Если посмотреть с точки зрения самого приходящего специалиста &mdash; недостатки &laquo;сидения в офисе&raquo; описаны выше.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В целом на вопрос о выгоде можно ответить кратко: &laquo;Для всех по-разному&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><strong>Ночной режим</strong></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Это отдельный вопрос для обсуждения, который каждый решает по-своему.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Бизнес часы &mdash; это как раз время, когда большинство организаций работает и зарабатывает деньги. Поэтому проводить какие-либо действия, которые могут затронуть деловой процесс &mdash; нежелательно. Приходится смещать основную активность на нерабочее время. С этим приходится мириться, подстраивать рабочий график сетевого инженера. В этом плане с приходящим сотрудником проще.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Итак, взвесив все &laquo;за и против&raquo;, организация решила вместо штатной единицы нанять приходящего админа/инженера.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Какие при этом могут возникнуть нюансы?</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Если не брать в расчёт какие-то юридические и бухгалтерские вопросы, связанные с оформление трудовых отношений и выплатой вознаграждения за труд, то основная проблема &mdash; в желании одной из сторон не переплатить лишнего.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Давайте посмотрим на проблему с нейтральной точки зрения.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h2>За что я вам плачу деньги если всё работает???</h2>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">За что в общем платить, оно понятно &mdash; за обеспечение&hellip; и за поддержание&hellip; и за устранение&hellip; и так далее.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Другое дело, какой критерий выбрать.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h3>Вариант с почасовой оплатой</h3>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Сколько времени человек за работой провёл, столько денег получил.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Справедливо, не правда ли? Не будем спешить с выводами....</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Приходящие специалисты &mdash; живые люди. А при такой схеме оплаты возникает соблазн работать не особо напрягаясь. Не так чтобы очень медленно, и тем более, не бездельничать, потому что это сразу заметно. Но всё выполнять по принципу: &laquo;идёшь в тайгу на день, бери продуктов на два...&raquo;</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Чем плохо &mdash; организации всё-таки работать надо. Если каждая минута на счету, то такой &laquo;неторопливо-обстоятельный подход&raquo;, при котором основные бизнес-процессы простаивают, может обойтись дороговато. Но некоторые не особо умные руководители это не понимают и не стремятся понять.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Если посмотреть с точки зрения самих специалистов, то тут другая беда. При таком подходе абсолютно не учитывается этап подготовки, приобретения знаний, поиска информации и так далее. Заказчик готов платить только за завершающий момент, когда приходящий специалист что-то вводит на клавиатуре в серверной, но не берёт в расчёт время на поиск решения. Хорошо если задача простая из разряда &laquo;взял и сделал&raquo;. Но если надо найти причину проблемы или выбрать оптимальный вариант и при этом желательно не ошибиться, тут вариант: &laquo;вот гвоздь, вот подкова, раз, два и готово!&raquo; &mdash; далеко не всегда подходит.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Получается, что высококлассный специалист, решающий сложные задачи, подразумевающие &laquo;домашнее задание&raquo;, будет зарабатывать меньше, чем простой начинающий админ, которые выполняет только очень простые поручения.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В случае с крупной аутсорсинговой компанией эту проблему можно решить за счёт перераспределения доходов от большого числа сотрудников, например, в виде доплаты за квалификацию. Но в случае с фрилансером-одиночкой этот вариант не возможен. Приходится изображать кипучую деятельность. Такие временные &laquo;накрутки&raquo; делаются отнюдь не от хорошей жизни.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h3>Оплата по количеству вызовов</h3>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Ещё один, казалось бы, справедливый вариант оплаты. Сколько раз пришёл, столько денег получил. По мнению недалёкого начальства &mdash; стимул побольше работать, а не &laquo;просиживать штаны&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В целом схема чем-то похожа на повременную оплату, но есть большое отличие. Дело в том, что просто так приходящего специалиста не вызывают. Обычно для этого должно что-то случиться, например, пропал доступ в Интернет, перестала ходить почта или вообще легла вся сеть. И тут как нельзя вовремя появляется нужный специалист, который быстренько всё чинит. Понимаете, куда всё клонится?</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">При такой схеме оплаты приходящий &laquo;волшебник&raquo; не просто не заинтересован обеспечивать бесперебойную работу, ему выгодно, когда что-то постоянно ломается, что-то не работает, чего-то не хватает. Ещё это выгодно некоторым другим сотрудникам в организации, которые могут побездельничать во время сбоев. В общем, всем хорошо, кроме бизнеса.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Прямо как в репризе Райкина &laquo;Дефицит&raquo;: &laquo;Ты меня уважаешь, я тебя уважаю, мы с тобой уважаемые люди&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><strong>Ты меня уважаешь, я тебя уважаю, мы с тобой уважаемые люди</strong></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Ну а если ничего не ломается и &laquo;оно само всё работает&raquo;, то такую &laquo;поломку&raquo; можно организовать искусственно. Говоря языком &laquo;героя&raquo; из репризы Райкина: &laquo;Пусть всё будет, но пусть всегда чего-то не хватает&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Некоторые владельцы бизнеса сами помогают в решении такого &laquo;вопроса&raquo;. Если в финансовая политика организации определяется словами &laquo;нахаляву&raquo; и &laquo;поменьше платить&raquo;, то начальство само ставит задачу приходящему админу выбрать оборудование как можно дешевле: &laquo;У нас тут не Москва (не Париж, не Нью Йорк, не &laquo;Кремниевая долина&raquo; и т.&nbsp;д.) и крутые &laquo;навороты&raquo; вроде повышенной надёжности и этой самой безопасности нам не нужны...&raquo;</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В итоге приобретается самый дешёвый вариант из серии NoName, и это всё будет постоянно сбоить в силу не особо удачного аппаратно-программного решения. Ещё одна схема для &laquo;экономии&raquo; &mdash; установить самую слабую и простую модель &laquo;для домашнего пользования&raquo; под гораздо большую нагрузку офисной сети и наслаждаться постоянными &laquo;зависаниями&raquo;. Зато никто не скажет, что приходящий админ ничего не делает. Ещё и деньги при покупке оборудования сэкономил.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">На самом деле инициатором и проводником такой разрушительной &laquo;политики&raquo; является сам жадный заказчик, а исполнителю остаётся послушно &laquo;взять под козырёк&raquo; и исполнять пожелания, ведь как известно: &laquo;Заказчик всегда прав&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">А начиналось всё с той самой якобы &laquo;справедливой&raquo; схемы оплаты: &laquo;Не потопаешь, не полопаешь&raquo; ...</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h3>Ни минуты простоя!</h3>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Поклонники данной схемы приводят пример Генри Форда, который платил техникам, обслуживающим конвейер только за время, которое они &laquo;бездельничали&raquo; (а конвейер работал). Если конвейер ломался, то техники за время ремонта оплату не получали. Считалось, что это должно побудить людей работать более качественно и всё предусмотреть заранее, чтобы было меньше поломок.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Казалось бы, что здесь плохого. Сразу &laquo;взять и настроить всё как надо&raquo;, &laquo;нормально делай &mdash; нормально будет&raquo; и много других лозунговых истин прямо голосуют за такой подход.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Однако исповедуя данный принцип, заказчик невольно подталкивает исполнителя к самому примитивному подходу к работе.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Ещё хуже, когда заказчик открывает для себя библиотеку ITIL, и начинает манипулировать кучей терминов, плохо представляя, как на самом деле это всё работает.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Первое, что при этом происходит &mdash; Service Level Agreement или сокращённо SLA на деле превращается в примитивный инструмент &laquo;закручивания гаек&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Заказчик берёт самый высокий уровень, предназначенный для крупных предприятий, где высокий уровень отказоустойчивости и общей &laquo;живучести&raquo; системы достигается за счёт дублирования, резервирования и других мер, базирующихся на применение избыточности. И начинает слепо транслировать обретённое &laquo;знание&raquo; на свой местечковый уровень, на домашние роутеры, NoName коммутаторы, обжатые вручную патчкорды и другие &laquo;прелести&raquo; среднего и малого бизнеса.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><strong>Примечание</strong>. Service Level Agreement или SLA (соглашение об уровне сервиса) &mdash; документ, описывающий подход компании к организации ИТ процессов. Часто под SLA в более упрощённом понимании подразумевают договор, устанавливающий параметры качества предоставляемых бизнесу ИТ услуг.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Данный документ используется для двустороннего регулирования взаимоотношений между заказчиком и исполнителем,</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В SLA закрепляются договорённости об условиях предоставления услуг (сервисов), перечень таких услуг, а также правила, которые заказчик обязан соблюдать при эксплуатации предоставляемых сервисов. Поэтому SLA служит не только для контроля качества ИТ услуг, но и устанавливает допустимые ожидания потребителей.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В случае примитивного подхода это выглядит примерно так: &laquo;А обеспечьте-ка мне уровень простоев не более 30 секунд в год! Потому что&nbsp;<em>Я так хочу</em>, у нас с вами будет вот такой SLA. Всё, работайте, время пошло!&raquo;, &mdash; и&hellip; собственно, это надо как-то исполнять.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Например, поставить &laquo;watchdog&raquo; и лечить проблемы перезагрузкой устройств вместо того, чтобы разобраться в причинах перебоев, максимально долго оттягивать процесс модернизации ИТ инфраструктуры и так далее.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Да что там модернизация, даже простое обновление прошивки Интернет-шлюза &mdash; это же &laquo;несанкционированный простой!&raquo;, и поэтому &laquo;пока потерпит&raquo; ...</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В первую очередь при таком подходе жертвуют заботой о безопасности. Будет попытка взлома или DDoS атаки &mdash; неизвестно, а штраф за неудобство или перебои во время настройки исполнителю точно прилетит. Поэтому &laquo;как работает &mdash; так работает, и вообще, кому эта контора нужна, чтобы её взламывать&raquo; ...</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Во вторую очередь в жертву приносятся работы по профилактике, модернизации и так далее. Например, замена кулера в коммутаторе &mdash; это же остановка на целых 10 минут! Поэтому выкручиваем &laquo;холод&raquo; в кондиционере на самый максимум и продолжаем &laquo;работу&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">В итоге всё обслуживаемое сетевое хозяйство кое-как существует, пока технический долг по обслуживанию системы не достигнет определённой черты. И происходит количественно-качественный переход от кое-как работающей системы к полностью нерабочей.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Или до первого серьёзного взлома или мощной DDoS атаки. Тут уж комментарии излишни.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h2>А как надо?</h2>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Обозначить проблему, но не предложить внятного решения &mdash; означает сделать только половину работы.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Увы, как известно, &laquo;серебряной пули&raquo; не бывает, нет готовых решений по принципу &laquo;раз-два и всё хорошо&raquo;.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Однако можно выделить несколько рекомендаций по взаимодействию между приходящим амином/инженером и заказчиком, который хочет получить приемлемый результат.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<ol>\n\t<li>Не смешивать текущую работу по поддержанию сетевой инфраструктуры (в том числе устранение сбоев) с профилактическими работами и, тем более, с модернизацией сети. Для поддержания сети в рабочем состоянии должно быть заключено соглашение с разумными критериями, составленными на основе понимания конкретной ситуации. Если требовать для компании, работающей по 8 часов 5 дней в неделю того же уровня обслуживания, как и для крупных ЦОД, работающих 24/7/365 &mdash; это может вылиться в дополнительные расходы: явные или скрытые.</li>\n\t<li>Должны быть выделены часы для профилактических работ, их состав, длительность и время проведения должны быть заранее спланированы и согласованы.</li>\n\t<li>Для модернизации сети необходимо составлять отдельный проект. Речь не идёт о разовых заменах сгоревшего или сильно устаревшего оборудования. Но если меняется сетевой шлюз и это найдёт своё отражение в работе организации &mdash; это уже повод для описания решения, составления сметы на выполнение работ, акт приёмки и написания других полезных документов.</li>\n</ol>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Понятное дело, что бумажная работа мало кому нравится, но зачастую без неё никак.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Но даже несмотря на все подписанные документы, важным моментом является взаимное доверие и стремление к сотрудничеству.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Иначе любые трудовые отношения будут только во вред.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">И, разумеется, в рамках короткой статьи нельзя описать все нюансы, которые встречаются при достаточно сложных бизнес-процессах ИТ инфраструктуры.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Например, такой прекрасный сюжет, когда заказчик требует от приходящего админа наиподробнейший отчёт, на составление которого уходит больше времени, чем на решение технических вопросов с сетью, вместе взятых.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Или когда бухгалтерия заказчика &laquo;боится&raquo; заплатить специалисту слишком много, слишком часто: &laquo;А вдруг налоговая придёт и нас всех посадит в тюрьму? Нет уж, давайте-ка, раз вы уж такой хороший специалист, устраивайтесь к нам как положено, на целый день, по трудовой&hellip; А маленькую зарплату мы поднимем&hellip; потом&hellip; когда-нибудь, если &laquo;наверху&raquo; деньги выделят...&raquo;</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h2>Чисто технический момент</h2>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Компания Zyxel старается предложить для приходящих админов, инженеров (и не только для них) полезные инструменты, которые всегда под рукой.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Среди них стоит отметить Zyxel Nebula и Zyxel CNM SecuReporter.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Кому удобнее работать с Zyxel Nebula:</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<ul>\n\t<li><strong>Приходящим специалистам</strong>&nbsp;удобно использовать Zyxel Nebula &mdash; управление, мониторинг, локализация проблем (кроме аппаратных) &mdash; все доступно не вставая с дивана. Остаётся только лично являться на объект с важным лицом, чтобы изредка смонтировать оборудование, подключить кабели и патчкорды, и можно поехать домой все настраивать и конфигурировать. (Иногда этот этап можно поручить дежурным админам заказчика).</li>\n\t<li><strong>Штатным сотрудникам</strong>&nbsp;Nebula позволяет не ездить на удалённый объект по любой нужде (не посещать ЦОД, не ходить в серверную и вообще пореже куда-либо перемещаться) и часть времени работать из дома без потери эффективности. Все настраивать дистанционно, мониторить дистанционно. Даже такие мелкие, но очень ответственные задачи вроде подключения точки доступа WiFi путём втыкания патчкорда в розетку можно поручить любому более или менее технически грамотному сотруднику, а настраивать уже удалённо через &laquo;облако&raquo;.</li>\n</ul>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Для тех, кто любит &laquo;чистое небо&raquo; (то есть всё выполнять самостоятельно вручную) &mdash; есть локальное управление всем &laquo;железом&raquo; Zyxel, даже тем что поддерживает Nebula. И переключение из облака в режим локального управления и обратно &mdash; возможно в любой момент.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\"><strong>Zyxel CNM SecuReporter</strong>&nbsp;&mdash; это облачная интеллектуальная служба аналитики и отчётов с функциями сбора и корреляции данных, разработанная для межсетевых экранов Zyxel (в том числе в Nebula). Он предоставляет сетевым администраторам централизованное представление о сетевой активности. Подробнее&nbsp;<a href=\"https://www.zyxel.com/ru/ru/products_services/Security-Service-Cloud-CNM-SecuReporter\">здесь</a>.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<h3>Полезные ссылки</h3>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<ol>\n\t<li><a href=\"https://academy.zyxel.eu/zcne-ru\">Центр обучения Zyxel</a></li>\n\t<li><a href=\"https://t.me/zyxel_news\">Новостной канал в Telegram</a></li>\n\t<li><a href=\"https://t.me/zyxelru\">Телеграм-чат поддержки для специалистов</a></li>\n\t<li><a href=\"https://community.zyxel.com/ru/categories\">Форум для специалистов</a></li>\n\t<li><a href=\"https://www.facebook.com/Zyxel.Russia\">Свежие новости в Facebook</a></li>\n\t<li><a href=\"https://www.youtube.com/zyxel_russia\">Наш YouTube</a></li>\n\t<li><a href=\"https://www.zyxel.com/ru/ru/solutions/success_stories_list.shtml\">Реализованные проекты</a></li>\n\t<li><a href=\"https://www.zyxel.com/ru/ru/products_services/Security-Service-Cloud-CNM-SecuReporter\">Security Service Cloud CNM SecuReporter</a></li>\n\t<li><a href=\"https://www.zyxel.com/ru/ru/products_services/NCC-Nebula-Control-Center\">Центр управления &mdash; Nebula Control Center (NCC)</a></li>\n</ol>",
    "author": "petrov",
    "category": "менеджмент",
    "image": "kszy0hxh8tqsmddw87cppudnuny.png",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "30.09.21 01:55:19"
  },
  {
    "title": "Как управлять отделом джунов и не сойти с ума",
    "preview": "В компании «Арбис» используется стек, который давно оброс стереотипами и предрассудками — это 1С:Платформа. Более того, у большинства 1С прочно связана с бухгалтерией. И, хотя в Арбис программный продукт вообще с ней не связан — это облачное решение, сервис на 1000 пользователей — опытных спецов по 1С для него просто нет.",
    "body": "<p style=\"text-align:justify; font-size:18px\">В компании &laquo;Арбис&raquo; используется стек,\n    который давно оброс стереотипами и предрассудками &mdash; это 1С:Платформа.\n    Более того, у большинства 1С прочно связана с бухгалтерией. И, хотя в Арбис\n    программный продукт вообще с ней не связан &mdash; это облачное решение,\n    сервис на 1000 пользователей &mdash; опытных спецов по 1С для него просто\n    нет.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">И в довершение, компания базируется в\n    Архангельске, где есть утечка кадров в большие города и нет рынок вакансий\n    в принципе небольшой. Даже хуже. Процветает хантинг сотрудников, потому что\n    Абрис &mdash; единственная компания, которая воспитывает и учит\n    специалистов по 1С.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Где искать людей? Компания сделала ставку на\n    джунов. Об этом на конференции TeamLead Conf 2021 рассказала Маргарита\n    Маковеева, которая каждого сотрудника в своем отделе выращивала с нуля. И\n    сегодня мы опишем подробности ее решения. Видео ее выступления можно\n    посмотреть&nbsp;<a href=\"https://youtu.be/nLPJiZMF04A\"><u>здесь</u></a>.\n</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/9ee/437/741/9ee437741c9dee2534789ac716b3eee6.jpeg\"\n        style=\"width:100%\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Если вам вся описанная выше боль не знакома, то\n    есть еще ряд стратегических причин, почему стоит нанимать джунов:</p>\n\n<ul>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Кадровый резерв &mdash; люди вырастают,\n            кто-то должен их заменять.</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Решение простых задач (техдолг, мелкие\n            баги, простые автотесты) силами более дешевых специалистов.</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Внутренняя автоматизация, чтобы в будущем\n            сэкономит время других сотрудников, но старших специалистов на её\n            реализацию не поставить.</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Рутинные операции.</p>\n    </li>\n</ul>\n\n<p style=\"text-align:justify; font-size:18px\">Процесс подбора кандидатов должен быть выстроен в\n    целую воронку. Если вы хотите себе в команду, например, двух джунов, вам\n    нужно нанимать на старте больше, потому что кто-то из них не пройдет\n    обучение. Всем пришедшим дается задача, чтобы оценить их подход и само\n    решение. И будьте готовы услышать на собеседовании много нового.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/5e9/b66/d27/5e9b66d2736e8b05308fc3bdaf514f45.jpeg\"\n        style=\"width:100%\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Если у вас небольшой конкурс на место, то нет и\n    гарантии, что все пришедшие будут талантливыми. Поэтому имеет смысл даже\n    таким кандидатам дать второй шанс &mdash; например, пригласив их на\n    практику и выдав тему диплома. С их помощью получится закрыть некоторые\n    задачи:</p>\n\n<ul>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Правки и написание руководств\n            пользователей;</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Telegram-бот;</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Автотесты;</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Мелкие фиксы;</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Техдолг.</p>\n    </li>\n</ul>\n\n<p style=\"text-align:justify; font-size:18px\">Для тех, кто уже закончил обучение и не может\n    пойти на практику, можно составить список материалов, чтобы они изучили их\n    самостоятельно, а зачем перепровести интервью. Это позволит понять,\n    насколько человек обучаем в принципе и стоит ли его учить.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Так или иначе, но какое-то количество джунов вы\n    себе получите. Как можно с этим работать?</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/99c/367/6de/99c3676de23be1e9c7384569327ac14f.jpeg\"\n        style=\"width:100%\"/></p>\n\n<h2 style=\"text-align:justify\">График и оформление</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Стоит начать с ученического договора, а не\n    трудового, потому что первый позволяет проще расставаться с сотрудниками,\n    если они не подходят в процессе обучения или если ученик решил, что &laquo;это\n    не его&raquo;. Вторая причина &mdash;&nbsp; из-за антиковидных мер есть\n    ограничения для компаний по количеству увольняемых сотрудников. Чтобы не\n    попасть под внимательный взгляд надзора, ученический договор для джунов\n    подходит больше.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Это также дает ребятам возможность совмещать\n    работу с обучением. В рамках ученического договора у них может быть\n    почасовая работа, зарплата будет называться стипендией, а вместо\n    должностных обязанностей будет индивидуальный график обучения.</p>\n\n<h2 style=\"text-align:justify\">Стандартизация обучения</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Сидеть с каждым стажером, рисуя схемы и&nbsp;\n    объяснять каждый раз снова &mdash; будет абсолютно контрпродуктивно. Если\n    вы готовы нанимать много джунов, у вас должна быть возможность быстро\n    начать их обучение. Пример графика стажера, который еще нигде не работал и\n    не знаком со стеком и с окружением:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        alt=\"График для от стажёра до Junior’a. Слева — график в договоре, справа расшифровка\"\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/7c7/8e1/e3f/7c78e1e3fe54b1f60e47b36c58b73df7.jpeg\"\n        style=\"width:100%\"\n        title=\"График для от стажёра до Junior’a. Слева — график в договоре, справа расшифровка\"/>\n</p>\n\n<p style=\"text-align:justify; font-size:18px\">График для от стажёра до Junior&rsquo;a. Слева\n    &mdash; график в договоре, справа расшифровка</p>\n\n<p style=\"text-align:justify; font-size:18px\">График корректируется по срокам и содержанию с\n    учётом индивидуальных особенностей кандидата. Например, полная ставка или\n    полставки, есть или нет какая-либо база у ученика &mdash; всё это влияет на\n    графика обучения.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Пример графика джуна (он закрывает вопрос:\n    &laquo;Как стать миддлом?&raquo;, потому что джуны любят такие вопросы\n    задавать):</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img alt=\"График для от Junior’a до Middle\"\n                                   src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/7ac/9b3/d1e/7ac9b3d1e62d7092e627a882905029a5.jpeg\"\n                                   style=\"width:100%\"\n                                   title=\"График для от Junior’a до Middle\"/>\n</p>\n\n<p style=\"text-align:justify; font-size:18px\">График для от Junior&rsquo;a до Middle</p>\n\n<p style=\"text-align:justify; font-size:18px\">Понятное дело, у вас могут быть другие\n    потребности и другие графики. На практике это выглядит примерно так:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        alt=\"Это график сотрудника технической поддержки. Видно, что в начале, когда человек только пришел, он хорошо справлялся, потом не очень.\"\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/e7c/e81/17f/e7ce8117fd5ba53850f690634b4674a2.jpeg\"\n        style=\"width:100%\"\n        title=\"Это график сотрудника технической поддержки. Видно, что в начале, когда человек только пришел, он хорошо справлялся, потом не очень.\"/>\n</p>\n\n<p style=\"text-align:justify; font-size:18px\">Это график сотрудника технической поддержки.\n    Видно, что в начале, когда человек только пришел, он хорошо справлялся,\n    потом не очень.</p>\n\n<h2 style=\"text-align:justify\">Адаптация</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Многих прошедших собеседование нужно адаптировать\n    к новой среде. Потому что к вам могут прийти студенты, просто мечтающие\n    попасть в мир IT. Но они не знают ни как работать, ни какие правила в\n    компаниях &mdash; их придется этому учить.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Расписывайте в базе знаний шаблоны на все случаи,\n    потому что иначе в чатах появятся люди с никами типа Киберпреступник и\n    Пахан_228. Вроде бы очевидно, что так делать не надо &mdash; вы в компании\n    работаете &mdash; но для некоторых это не так. Некоторые даже не понимают,\n    как взаимодействовать с другими коллегами, и об этом тоже стоит не только\n    написать статью, но и включить ее чтение в чек-лист:</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/5b3/ae8/ab5/5b3ae8ab5fedac1980a837093324af4f.jpeg\"\n        style=\"width:100%\"/></p>\n\n<h2 style=\"text-align:justify\">Начинаем работу</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Нельзя просто посадить джуна и сказать: &laquo;Работай&raquo;.\n    Вы можете уехать на три дня на конференцию, и на следующий день получить\n    сообщение, что один из джунов на работу не пришел и не берет трубку. А по\n    возвращении увидеть этого джуна, вышедшего на работу вместе с вами как ни в\n    чем не бывало. Вы не проговорили, что на работу он должен приходить даже в\n    отсутствие руководителя, и он остался дома по принципу университета: нет\n    преподавателя &mdash; нет занятий.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Другой проблемой может быть то, что джун\n    несколько часов тратит на поиск решения выданной задачи в Google и не\n    просит о помощи. В процессе он может даже вам отвечать, что всё нормально и\n    ему всё понятно, но в результате задача на четыре часа так и не будет\n    сделана.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Чтобы бороться со всем этим, нужно понимать,\n    почему так происходит. Результат опроса джунов показал, что&nbsp; у них\n    просто еще не сформирована культура работы в компании. В университете их\n    учат тому, что самому делать лабораторные работы &mdash; это круто, и это в\n    общем-то правильный подход. Но одновременно они не хотят спрашивать, потому\n    что боятся показаться глупыми &mdash; как привыкли не спрашивать в чате с\n    одногруппниками.</p>\n\n<p style=\"text-align:justify; font-size:18px\">При этом они воспринимают свои&nbsp; задачи\n    несерьезно. Никто не доверит джунам серьезные задачи, которые могут сорвать\n    миллионные сделки &mdash; и они это знают. Поэтому они не хотят отвлекать\n    наставника, понимая, что его задачи важнее. И одновременно воспринимают\n    сроки как в том же университете: &laquo;Не сдам в этом семестре, сдам в\n    следующем&raquo;.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Как бороться?</p>\n\n<h2 style=\"text-align:justify\">Системная работа с джунами&nbsp;</h2>\n\n<h3 style=\"text-align:justify\">Шаг 1. Приставить наставника</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Это очевидное решение, но не всё так просто.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Во-первых, наставниками стоит делать&nbsp; тех\n    людей, которые готовы объяснять сложные вещи долго и простыми словами. Так,\n    чтобы даже бабушка могла понять. Если вы ей скажете, что работаете в\n    продуктовой команде, то бабушка, возможно, поймет два слова: команда и\n    продукт. Но продукт для нее &mdash; это молоко, творог и батон хлеба. Так и\n    для джунов &mdash; в сленге IT-мира им многое непонятно.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/c2f/a80/e08/c2fa80e08157243be204599bce913e71.jpeg\"\n        style=\"width:100%\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Во-вторых, человек должен хотеть курировать\n    джуна, то есть не только объяснять ему задачи, но и десять раз напоминать:\n    &laquo;Если тебе непонятно, скажи мне или напиши&raquo;. Потому что, как\n    уже говорилось, обычно джуны говорят, что всё понятно и всё получается.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Но даже при наличии всех этих качеств, у куратора\n    может не быть свободного времени. Чтобы ему не пришлось выбирать между\n    рабочими задачами и кураторством, закладывайте в его график работу с\n    джуном, причем желательно с запасом.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Кроме того, вы сами должны верить в назначенного\n    куратора. Этот пункт субъективный, но у людей, которые уполномочены\n    выбирать кураторов, обычно есть чуйка, что человек справится.</p>\n\n<h3 style=\"text-align:justify\">Лайфхак №1</h3>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Для кураторства достаточно среднего\n    джуна</strong>. Есть миф, что джунов должны курировать миддлы. Но у вас\n    никогда не будет столько миддлов с необходимыми для кураторства качествами,\n    это нереально. Вторая проблема в том, что миддл давно прошел стадию\n    обучения и он уже подзабыл, как это быть джуном и изъясняться простыми\n    словами. В итоге разрыв между куратором и курируемым будет очень сильно\n    ощущаться.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Но средний джун еще на одной волне с новеньким, у\n    них небольшой разрыв, они друг друга понимают. Разве средний джун не сможет\n    провести начальную стадию обучения, которую он прошел не так давно?\n    Наверняка сможет.&nbsp;</p>\n\n<h3 style=\"text-align:justify\">Лайфхак №2</h3>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Для одного джуна можно назначать разных\n    кураторов</strong>. Например, с начальным этапом поможет справиться даже не\n    программист, а кто-то из техподдержки или других направлений. И, в\n    зависимости от решаемой задачи можно выбирать других кураторов &mdash; из\n    тех, кто решал ту же задачу не так давно.</p>\n\n<h3 style=\"text-align:justify\">Шаг 2. Организовать инфополе</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Наверное, у всех есть рабочие чаты и база знаний.\n    Вопрос в их организации.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Для чатов можно использовать любую платформу, но\n    для джунов есть хорошее правило: никаких личных переписок по вопросам,\n    связанным с незнанием или непониманием, как решать задачу. Потому что джуны\n    из-за страха задавать вопросы в чат проекта любят писать сообщения лично\n    наставнику. Если у вас сразу четыре джуна, то остальные трое не получат\n    информацию, которая для них может быть важна. К тому же в общем чате любой\n    другой участник мог уже решить схожую проблему и помочь джуну.</p>\n\n<p style=\"text-align:justify; font-size:18px\">В использовании базы знаний есть один нюанс,\n    который вы можете проверить прямо сейчас. Она может быть понятна только\n    тем, кто уже освоился в компании. Но непонятна человеку со стороны,\n    особенно джуну &mdash; они не знают всей терминологии. Поэтому важно, чтобы\n    человек смог найти нужную информацию, даже если ни разу вашу базу знаний не\n    видел.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Пишите базу знаний как для тупеньких. Например,\n    статью, как написать автотесты, пишите для людей, которые вообще впервые\n    видят автотесты.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/35b/281/a35/35b281a353a5d47d864e375b57b18e1c.jpeg\"\n        style=\"width:100%\"/></p>\n\n<h3 style=\"text-align:justify\">Шаг 3. Отчеты о рабочем времени и контрольные\n    точки</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Как понять, что джун стал лучше, чем\n    вчера?&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Используйте отчеты о рабочем времени. Достаточно\n    проанализировать эти отчеты и оценку задачи опытным специалистом, чтобы\n    понять, насколько последний подрос за квартал или год.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Но сначала стоит дать джуну самому оценить себя.\n    Они, конечно, поначалу никогда не укладываются в свои оценки. Но этот опыт\n    позволяет им научиться правильно оценивать свои силы, потому что даже если\n    джун не угадывает с оценкой, потом можно обсудить, почему так получилось.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Также полезно джунам сначала самим написать ТЗ\n    &mdash; пусть они сами прикинут, как бы они это решили. А контрольные точки\n    можно создать в виде шаблона. Со временем джун начинает оценивать себя\n    правильно, что становится очень важным на стадии миддла и синьора.</p>\n\n<h4 style=\"text-align:justify\">Соотношение плана к факту</h4>\n\n<p style=\"text-align:justify; font-size:18px\">Установите коэффициенты отставания. Например, для\n    учеников-стажеров, которые еще даже не джуны, оставание может быть не более\n    20%. Если человек отстает, можно в дальнейшем проверить, точно ли вы\n    оценили график. И какой-то поток джунов даст этому подтверждение. В любом\n    случае это будет уже не субъективная оценка.</p>\n\n<p style=\"text-align:justify; font-size:18px\">У джунов, которые хотят стать миддлами, может\n    быть другое соотношение: первые полгода &mdash; 1:4 &ndash; 1:6 (джуна к\n    миддлу), следующие полгода &mdash; 1:2 &ndash; 1:4, и через год-полтора\n    &mdash;&nbsp; без отставаний.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Также вам помогут отчеты для мониторинга:</p>\n\n<ul>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Насколько текущий уровень отстает от\n            уровня миддла?</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Сколько времени прошло для достижения\n            текущих результатов?</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Сколько времени потенциально может\n            пройти?</p>\n    </li>\n    <li>\n        <p style=\"text-align:justify; font-size:18px\">Текущий уровень обучаемости по отношению\n            к команде.</p>\n    </li>\n</ul>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/423/943/a97/423943a9732538ef521b130f30529b36.jpeg\"\n        style=\"width:100%\"/></p>\n\n<h3 style=\"text-align:justify\">Шаг 4. Ретроспективы</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Обсуждение того, что происходит &mdash; очень\n    важно. Но бывает, команда собирается, и, если в ней есть джун, то он\n    достаточно скромно себя ведет на ретроспективе. Все рассказывают, что они\n    сделали, а он отмалчивается.&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Почему? Поставьте себя на место джуна &mdash; как\n    они ощущают себя, когда вы даете им задачу? Они считают, что делают то, что\n    абсолютно не влияет на общую картину, так как они делают всего лишь\n    маленькие задачки. Конечно, не нужно им давать большие задачи &mdash;\n    вероятность того, что она будет сделана, стремится к нулю.</p>\n\n<h3 style=\"text-align:justify\">Лайфхак №3</h3>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Много выполненных маленьких задач звучит\n    лучше, чем одна большая, но недоделанная задача</strong>.</p>\n\n<p style=\"text-align:justify; font-size:18px\">При этом объясняйте джуну, как его маленькая\n    задача влияет на весь проект и как она важна. Они смогут почувствовать, что\n    на самом деле проект &mdash; это единый механизм. И, если хотя бы одна\n    шестеренка, за которую отвечает джун, выпадет &mdash; механизм остановится,\n    а проект отложится (конечно, нет, но джуну лучше чувствовать\n    ответственность, чем считать свою работу никчемной).</p>\n\n<p style=\"text-align:justify; font-size:18px\">Даже небольшие задачи стоит разбивать на этапы,\n    например, по 4 часа. Не нужно писать целое ТЗ на каждую, но контрольные\n    точки у них должны быть, особенно для стажеров.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Все задачи джунам имеет смысл отдавать небольшими\n    партиями, например, по три. Он сможет, если вдруг по первой задаче\n    образовался перерыв, посмотреть вторую или третью. С другой стороны, не\n    отдавайте им в работу сразу много задач. Даже показывать не стоит больше\n    тех самых трех. Джун вполне может увидеть в трекере список задач и\n    подумать: &laquo;Эти три я не знаю как делать, а другую погуглю&raquo;. По\n    итогу у вас будет много задач, которые он пытался загуглить, но ничего не\n    сделал.</p>\n\n<h3 style=\"text-align:justify\">Лайфхак №4</h3>\n\n<p style=\"text-align:justify; font-size:18px\"><strong>Делитесь и успехами, и неудачами</strong>.\n</p>\n\n<p style=\"text-align:justify; font-size:18px\">Когда джун приходит в команду, он думает: &laquo;Вау,\n    какие тут все крутые, не то, что я&hellip;&raquo;. Он смотрит на всех, как\n    ребенок на взрослых. Покажите джуну и другую сторону медали: даже опытные\n    сотрудники могут ошибаться &mdash; это не страшно, но надо стремиться\n    исправлять ошибки. Даже опытные сотрудники могут просить совета. Но никто\n    не осуждает за ошибки или просьбы о помощи.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Это можно обсудить, например, на примере общего\n    чата разработки, где люди задают друг другу вопросы. Джуны почему-то всегда\n    считают, что тот, кто отвечает &mdash; опытный, много лет тут работает и\n    всё умеет. А тот, кто спрашивает &mdash; не очень.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Бывают истории, когда человек 15 лет работает в\n    компании и задает вопрос, как что-то сделать. А рабочий ответ приходит от\n    другого человека с 5 летним опыт в разработке. Для джуна это всегда\n    удивительно, и до него важно донести: неважно, сколько лет ты работаешь в\n    компании &mdash; ты в любом случае не можешь знать все. Даже если ты\n    задашься этой целью изучить всё, то всегда найдется задача, с которой&nbsp;\n    ты просто никогда не сталкивался. В информационных технологиях всё\n    постоянно движется вперед. Как бы ты ни пытался всё выучить, это\n    нереально.</p>\n\n<h3 style=\"text-align:justify\">Дружественная атмосфера</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Сейчас любят делать опенспейсы, и рабочие места\n    выглядят одинаково. Но даже в такой атмосфере нужно их персонализировать,\n    чтобы человек приходил и понимал: это мое, и я здесь, как у себя дома.\n    Потому что джуны ходят на работу не ради работы, им важна атмосфера\n    тусовки.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Эту атмосферу создают мелочи, например, плакаты,\n    подушки, фигурки, коврик для мышки, даже мопсы могут быть. Можно предлагать\n    джунам приносить любимые вещи из дома.</p>\n\n<h3 style=\"text-align:justify\">Неформальное общение</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Необязательно устраивать застолья. Это может быть\n    обсуждение в формате &laquo;У него день рождения, давайте закажем пиццу,\n    поздравим и просто пообщаемся, как у кого дела, у кого что наболело&raquo;,\n    &mdash; потому что наболеть может многое.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Чтобы отвлечься мыслями от работы и &laquo;поговорить\n    за жизнь&raquo;, можно не только отмечать дни рождения и праздники, но и\n    совершать вылазки на природу (нужна программа), общаться после работы,\n    вместе ходить в VR-клубы, караоке, бары, играть в недолгие настолки и,\n    конечно, проводить знаменитые встречи 1:1.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Причем это именно свободная атмосфера, а не\n    тимбилдинг. Не заставляйте джунов &laquo;дружить&raquo;. И помните, что в\n    коллективе всегда есть пара людей, которым это всё неинтересно: &laquo;Я\n    пойду лучше покодю&hellip;&raquo; Кому-то хочется пообщаться и рассказать\n    свою боль, а для кого-то это насилие над собой. Предложите пирог и\n    отпустите с миром. Пусть он делает свои задачи.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/1b2/ff1/c11/1b2ff1c11b79c16ba272099e7b13397f.jpeg\"\n        style=\"width:100%\"/></p>\n\n<h2 style=\"text-align:justify\">Но не все дойдут до конца&hellip;</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Мы не можем держать человека только потому, что\n    он прикольный, с джунами приходится расставаться. Это может быть очень\n    больно, потому что вы ведь стараетесь, душу в них вкладываете.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Но расставайтесь нежно, по-хорошему. В основном\n    джуны еще где-то учатся или поддерживают контакт с одногруппниками. Очень\n    часто в их компаниях работает сарафанное радио. И вас могут советовать\n    другим знакомым. А бывает так, что человек не вывозит, вы расстаетесь, а\n    потом из-за того, что ему нравилось работать у вас, он возвращается уже\n    более опытным.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Чтобы расставаться безболезненно для компании,\n    стройте процессы не от людей, а от ролей. Сотрудники должны быть\n    взаимозаменяемыми. И документируйте изменения, чтобы спустя время любой мог\n    ознакомиться с проектом и понять причину произошедшего.</p>\n\n<h3 style=\"text-align:justify\">Не привыкайте к джунам</h3>\n\n<p style=\"text-align:justify; font-size:18px\">Не все джуны справляются с обучением. А некоторые\n    могут уйти вслед за другом, не прошедшим испытательный срок. У большинства\n    джунов нет финансовых обязательств, историй с детьми, ипотеками и другими\n    обстоятельствами, требующими финансовой стабильности. Часто они живут с\n    мамами, их вообще не беспокоит, что они уйдут с работы. Поэтому уходят они\n    легко.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Другой момент расставания может наступить, когда\n    джун захочет сменить стек или сферу. Он может понять в процессе обучения,\n    что ему просто не зашел этот стек. Подумайте, можно ли ему предложить\n    желаемое направление внутри компании или подразделения.</p>\n\n<p style=\"text-align:justify; font-size:18px\">По статистике, за год 5-10% джунов уйдут в армию,\n    а 5% переедут, причем это может быть просто из-за учебы. Например, человек\n    учился на бакалавра, а в магистратуру решил поступить в более крупный\n    город. Это просто жизнь. Работа с джунами &mdash; это постоянный перебор,\n    поиск чего-то ценного.&nbsp; Вы всегда будете расставаться с людьми, просто\n    не привыкайте к ним.&nbsp;</p>\n\n<h2 style=\"text-align:justify\">Заключение</h2>\n\n<p style=\"text-align:justify; font-size:18px\">Думайте сегодня о завтра. Если вы всех уволите и\n    наймете новых людей, сможете ли вы решать задачи и выполнять работу так же,\n    как раньше?&nbsp;</p>\n\n<p style=\"text-align:justify; font-size:18px\">Всё ли у вас организовано так, что любая\n    информация, которая могла бы быть аккумулирована внутри одного человека,\n    распространена не только на людей, но и внутри базы знаний?</p>",
    "author": "ilyin",
    "category": "маркетинг",
    "image": "9ee437741c9dee2534789ac716b3eee6.jpeg",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "30.10.21 01:55:19"
  },
  {
    "title": "Как мы боролись с проблемой разлогинов в приложении «Магнита» и возвращали пользователей обратно",
    "preview": "Всем привет! Меня зовут Антон Огородников, и с начала этого года я руковожу отделом онлайн-разработки в «Магните». Не успел я заонбордиться, как столкнулся с  настоящим коллапсом — массовым лог-аутом пользователей из приложения лояльности «Магнит: акции и скидки». Клиентов разлогинивало в самые неподходящие моменты: например, на кассе во время оплаты товаров. Оценка приложения в сторах упала до 2 баллов, капали негативные комментарии.",
    "body": "<p style=\"font-size:18px\">Всем привет! Меня зовут Антон Огородников, и с начала этого года я руковожу отделом онлайн-разработки в &laquo;Магните&raquo;. Не успел я заонбордиться, как столкнулся с&nbsp; настоящим коллапсом &mdash; массовым лог-аутом пользователей из приложения лояльности &laquo;Магнит: акции и скидки&raquo;. Клиентов разлогинивало в самые неподходящие моменты: например, на кассе во время оплаты товаров. Оценка приложения в сторах упала до 2 баллов, капали негативные комментарии.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/4d6/d8c/625/4d6d8c6254c060a0d56de982c42379c9.jpg\" style=\"height:400px; width:800px\" /></p>\n\n<p style=\"font-size:18px\">В этой статье я расскажу, как мы искали причину разлогинов и как сумели побороть проблему.&nbsp;</p>\n\n<h3>Кардиограмма разлогинов</h3>\n\n<p style=\"font-size:18px\">Старая версия мобильного приложения лояльности &laquo;Магнита&raquo; появилось до моего прихода в компанию еще в 2020 году. Оно предоставляло клиентам скидки лояльности, но его проектировали без собственного бэкенда.&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">Интеграция телефона клиента происходила через CRM, при этом авторизация была односторонней &mdash; только клиентская.&nbsp;</p>\n\n<p style=\"font-size:18px\">При регистрации в приложении пользователь отражался в базе CRM, где ему присваивался логин и пароль. После авторизации он мог совершать действия в приложении, а компания видела регистрацию этих действий в CRM. Такая авторизация занимала время и не всегда корректно отрабатывала на вход, поэтому оценка приложения колебалась от 1 и до 2,5 баллов.</p>\n\n<p style=\"font-size:18px\">Летом было решено провести апгрейд приложения. Архитектурно за интерфейсом в телефоне разработали бэкенд magnit-API, под ним собрали три элемента:</p>\n\n<ol>\n\t<li>\n\t<p style=\"font-size:18px\">Keycloak &mdash; open-source сервис авторизации, написанный на Java;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Redis &mdash; хранилище или key value storage;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">CRM, название которой мы сохраним в тайне. Это платный enterprise-сервис для программ лояльности, хранения информации о клиентах и их операциях.</p>\n\t</li>\n</ol>\n\n<p style=\"font-size:18px\"><img alt=\"Архитектура приложения “Магнит: акции и скидки” 2020 г.\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/1a9/be2/08b/1a9be208b34997cbb66b34d86caf37a7.png\" style=\"height:610px; width:1117px\" title=\"Архитектура приложения “Магнит: акции и скидки” 2020 г.\" /></p>\n\n<p style=\"font-size:18px\">Архитектура приложения &ldquo;Магнит: акции и скидки&rdquo; 2020 г.</p>\n\n<p style=\"font-size:18px\">Архитектуру бэкенда выстроили, но пользователей продолжало выкидывать из приложения. После множества тестов и проверок стало ясно, что причина крылась в двойной авторизации между API и CRM. Она оставалась как в связке между телефоном и magnit-API по логину и паролю на базе Keycloak, так и между телефоном и CRM на базе бэкенда по логину и паролю клиента.</p>\n\n<p style=\"font-size:18px\">Таким образом, клиент заходил в приложение, вводил логин и пароль, которые падали на бэкенд. Оттуда они направлялись в CRM для создания токена авторизации, который хранился в Redis.&nbsp;</p>\n\n<p style=\"font-size:18px\">Итак, проблема была в неудачно построенной архитектуре. Стоит сказать, что на момент разработки приложения сделать по-другому было практически невозможно. API в CRM был только по логину и паролю.</p>\n\n<p style=\"font-size:18px\">Можно задать логичный вопрос &laquo;А зачем вообще была нужна CRM?&raquo; Все просто &mdash; в компании ее использовали с 2018 года, и в ней хранили информацию о клиентах. Это покупки, баллы лояльности и транзакции. Поэтому проще было привязать авторизацию сразу к ней.&nbsp;&nbsp;</p>\n\n<h3>Новое приложение, новые трудности&nbsp;</h3>\n\n<p style=\"font-size:18px\">В конце 2020 года &laquo;Магнит&raquo; выпустил новую версию приложения, и проблема разлогинов временно исчезла.&nbsp; Но уже через месяц все началось по новой &mdash; около 7 000 пользователей в день выбрасывало из приложения.&nbsp;</p>\n\n<p style=\"font-size:18px\">Я предположил, что проблема кроется в короткой жизни токенов в CRM. Тогда она составляла 30 дней без возможности пролонгирования. Не важно, как часто клиент пользовался приложением: он проходил авторизацию один раз и получал связку токенов на 30 дней. Спустя это время срок жизни токена подходил к концу, и клиента разлогинивало. CRM не предусматривала возможность пролонгирования токенов.&nbsp;</p>\n\n<p style=\"font-size:18px\">Тогда мы взялись за CRM. Проблему решил наш CIO Валентин. Он связался с представителями сервиса, объяснил наш запрос и контекст ситуации. Договорились, что разработчики CRM создадут для нас специальное обновление, продлевающее жизнь токенам. Казалось бы, загадку разгадали, проблему решили.</p>\n\n<p style=\"font-size:18px\">Однако через месяц ситуация стала ещё хуже.&nbsp; В начале марта показатель разлогинов вырос до 115 000 в сутки. Это был настоящий апокалипсис &mdash; выкидывало каждого четвертого пользователя. Это и недовольные клиенты, и финансовые затраты: например, на повторные sms-авторизации. Реагировать надо было срочно.&nbsp;&nbsp;</p>\n\n<h3>Выход из шторма</h3>\n\n<p style=\"font-size:18px\">Я начал анализировать ситуацию: смотрел код на бэкенде и на мобилке, снифал трафик между ними, смотрел, как хранятся токены. Чтобы откопать причину проблемы, нужно было полностью воспроизвести ситуацию, в которой она появлялась. Затем надо было отдебажить решение, устранить в нем проблему и внедрить новую версию в прод.</p>\n\n<p style=\"font-size:18px\">Озарение пришло в конце марта, когда я работал с хранилищем. Я удалял токен &mdash; и меня разлогинивало. Я портил код &mdash; и меня снова выкидывало. И тут я понял, что&hellip; Но давайте по порядку.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/9ea/596/7ec/9ea5967ecba788406a86b12c2dd00986.jpg\" style=\"height:768px; width:1366px\" /></p>\n\n<h3>Все под подозрением</h3>\n\n<p style=\"font-size:18px\">Однажды я копался в админке Keycloak и заметил, что время жизни офлайн-токена составляет 20 дней. Если за этот период пользователь заходил в приложение, то токен автоматически пролонгировался.</p>\n\n<p style=\"font-size:18px\">Мы поправили ситуацию: увеличили продолжительность жизни офлайн-токена до 90 дней. Решение казалось простым: пользователя не будет выкидывать на уровне Keycloak, если он хотя бы раз в 90 дней использует приложение.&nbsp;</p>\n\n<p style=\"font-size:18px\">Поскольку мы получали токены клиента из CRM и отправляли их на хранение в Redis, в теории они могли удаляться из него по TTL. Тогда мы подняли их TTL в Redis также до 90 дней.</p>\n\n<p style=\"font-size:18px\">Схему построили так:</p>\n\n<ol>\n\t<li>\n\t<p style=\"font-size:18px\">клиент приходит и авторизуется;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">мы выдаем ему токен Keycloak на 90 дней;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">получаем токен в CRM на 90 дней;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">кладем токены в Redis на 90 дней.</p>\n\t</li>\n</ol>\n\n<p style=\"font-size:18px\">Казалось, что схема правильная, и всё должно заработать без проблем. Но что-то опять пошло не так.</p>\n\n<p style=\"font-size:18px\">Следующее предположение было таким: мы неправильно интерпретируем&nbsp; ошибки CRM. Мы обрабатывали любую неизвестную ошибку из предположения, что у клиента &laquo;протух&raquo; токен. В связке magnit-API &mdash; CRM мы получали новый токен на 90 дней, а точнее два &mdash; access на 2-3 дня и refresh на 90 дней. После&nbsp; смерти access мы шли в CRM с живым refresh, чтобы получить новую связку. Проблема оказалась в самом подходе.&nbsp;</p>\n\n<p style=\"font-size:18px\">Мы начали внимательнее обрабатывать ошибки в CRM и сбрасывать токены только в том случае, если получали специальный код с конкретным телом.&nbsp;</p>\n\n<h3>Так в чем была проблема?&nbsp;</h3>\n\n<p style=\"font-size:18px\">Процесс авторизации в приложении был выстроен так:</p>\n\n<ol>\n\t<li>\n\t<p style=\"font-size:18px\">Клиент в первый раз заходит в приложение, логинится;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Получает токены Keycloak и CRM &mdash; access / refresh;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Мы записываем их в Redis. Когда access &laquo;протухает&raquo;, мы идем из нашего бэкенда в Redis, забираем связку, с refresh идем в CRM;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Запрашиваем новую связку access/refresh, получаем ее и кладем обратно в Redis. Но когда мы это делаем, мы не продлеваем время жизни токенов.&nbsp;&nbsp;</p>\n\t</li>\n</ol>\n\n<p style=\"font-size:18px\">И тут меня обдало холодным потом - это была детская ошибка.</p>\n\n<p style=\"font-size:18px\">Офлайн-токен жил 20 дней, и клиента стабильно выкидывало по истечении этого срока. И не важно, какие были ошибки &mdash; время жизни ключа access/refresh в Redis не обновлялось. Когда мы подняли время жизни офлайн-токена до 90 дней, ситуация наконец-то выровнялась.&nbsp;&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">Так, с 85 000 лог-аутов в день в конце марта мы вернулись к показателю в 5 000 уже в середине апреля. На этом мы не остановились &mdash; взялись за улучшение в CRM-системе.</p>\n\n<p style=\"font-size:18px\">В июле разработчики CRM выкатили для нас новую авторизацию b2b. Теперь между клиентской базой и Magnit-API есть только один токен, по которому мы обращаемся к CRM. Мы можем совершать с его помощью любые действия по всем клиентам.&nbsp;</p>\n\n<p style=\"font-size:18px\">Также мы отказались от хранения в Redis. У нас есть своя авторизация в телефоне на базе Keycloak и отдельная авторизация между нашим бэкендом и CRM.&nbsp; Количество пользователей нашего приложения выросло на 300 000 и достигло отметки в 800 000 (DAU).</p>\n\n<p style=\"font-size:18px\">В день только 0,001% от них теряет авторизацию. Эти разлогины происходят, если клиент заходит в приложение реже одного раза в 90 дней.&nbsp;По нашей бизнес-логике клиент может использовать приложение, если у него активна хотя бы одна карта лояльности. Примерно 1% пользователей продолжает сталкиваться с проблемой. Так происходит, когда у клиента нет ни одной активной виртуальной карты, либо она заблокирована.&nbsp;&nbsp;&nbsp;</p>\n\n<h3>Никогда такого не было, и вот опять&nbsp;</h3>\n\n<p style=\"font-size:18px\">Keycloak &mdash; это open-source продукт. В России мы не нашли коммьюнити, которое бы помогло нам решить вопрос с клиентскими авторизациями на долгий период времени с большим количеством пользователей. Большинство коллег по цеху используют Keycloak как внутренний корпоративный инструмент.&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">Я нашел только один русскоязычный Telegram-канал, где можно задать вопрос и обсудить проблемы с такими же разработчиками, как я сам. Еще есть платная поддержка от RedHat. Нам она не подошла, потому что они не дают поддержку &laquo;голого&raquo; Keycloak, а дополняют его разными фичами.&nbsp;</p>\n\n<p style=\"font-size:18px\">Сейчас у нас в Keycloak порядка 10 млн клиентов и 15 млн сессий. Нам понадобился не один месяц, чтобы настроить сервис авторизации под нашу нагрузку. Сейчас он потребляет 50 ГБ памяти, и этот объем растет каждую неделю.&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">В июле 2021 года, после релиза новой версии приложения, мы начали получать новые регистрации. Плюс это совпало с маркетинговой кампанией &laquo;Обратно в школу&raquo;. Прирост пользователей приложения составил 15%, что привело к новым проблемам с Keycloak.&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">В июле примерно раз в неделю нам приходилось перезапускать Keycloak. В ночь с субботы на воскресенье за 40 минут он прогревал в памяти все токены. Постепенно данных становилось все больше, 40 минут растягивались на несколько часов, а перезапуски требовались уже каждый день. Мы начали выдавать ему дополнительные CPU, но он продолжал падать.</p>\n\n<p style=\"font-size:18px\"><img alt=\"График рестартов и прогревов Keycloak \" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/d26/55a/cf8/d2655acf86c04cacaa40c222d3005dc1.png\" style=\"height:322px; width:904px\" title=\"График рестартов и прогревов Keycloak \" /></p>\n\n<p style=\"font-size:18px\">График рестартов и прогревов Keycloak</p>\n\n<p style=\"font-size:18px\">В августе 2021 года Keycloak начал падать уже по несколько раз в день. Вместе с ним падали и авторизации.&nbsp;&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">Мы думали, что после старта съедался весь CPU. Выдавали ему еще, но Keycloak продолжал падать. Тогда мы дали ему больше процессорной памяти, но он ее просто не потреблял.&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">Здесь важно помнить, что Keycloak это все-таки java-машина, а она может ограничивать себя по потреблению памяти системы. Мы нашли настройку Xmx, которая отвечает за максимальное количество памяти для java-машины в Keycloak. Когда все пофиксили, то CPU упала, а память начала расти:&nbsp;</p>\n\n<p style=\"font-size:18px\"><img alt=\"CPU Keycloak \" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/2c6/f27/fb4/2c6f27fb4f3acc0923a3684b2ad3c728.png\" style=\"height:723px; width:1600px\" title=\"CPU Keycloak \" /></p>\n\n<p style=\"font-size:18px\">CPU Keycloak&nbsp;</p>\n\n<p style=\"font-size:18px\"><img alt=\"Процессная память Keycloak\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/403/b5f/5ae/403b5f5ae11ec4f197611e86641b68b5.png\" style=\"height:587px; width:1600px\" title=\"Процессная память Keycloak\" /></p>\n\n<p style=\"font-size:18px\">Процессная память Keycloak</p>\n\n<h3>Помехи фрода</h3>\n\n<p style=\"font-size:18px\">Борьба с фродом в программах лояльности &laquo;Магнита&raquo; &mdash; важная тема как для нас, так и для наших клиентов. Начать нужно с точного определения: что именно мы считаем недобросовестными действиями. Мы считаем мошенниками тех, кто методом перебора номеров карт или логинов и паролей пытается получить доступ к программаме лояльности, чтобы воспользоваться баллами, специальным предложениями. Чаще всего их крадут, чтобы перепродать.</p>\n\n<p style=\"font-size:18px\">Причем тут мошенники, если мы уже нашли проблему в неудачно выстроенной архитектуре приложения? Фактор фрода есть всегда. Когда все возможные изменения настроек применены, а небольшое количество пользователей все еще выбрасывает из их аккаунтов, это сбивает разработчиков с толку. Мы не понимали, где реальная проблема с авторизацией, а где попытка фрода. Мошенники постоянно создавали нам шум, из-за чего решение проблемы оттягивалось.</p>\n\n<p style=\"font-size:18px\">Для примера, у фродеров есть метод &laquo;password spraying&raquo;. Это перебор паролей не отдельно для каждого логина, а сразу для нескольких сотен учетных записей. Так как многие пользователи используют пароли по типу &laquo;123&hellip;&raquo;, а у приложения раньше стоял лимит в 5 попыток ввода пароля до блокировки аккаунта, то мошенники с легкостью воровали учетные записи. Соответственно, пользователей разлогинивало, а наш Keycloak грузился еще больше.&nbsp;</p>\n\n<p style=\"font-size:18px\">Конечно, фрод и методы борьбы с ним в нашем приложении заслуживают отдельной статьи. Скажу только, что этой задачей занималась и продолжает это делать команда информационной защиты &laquo;Магнита&raquo;. Отделив проблемы с Keycloack от попыток воспользоваться данными со стороны мошенников, мы продвинулись в борьбе с лог-аутами вперед.&nbsp;</p>\n\n<h3>Как выглядит архитектура приложения сейчас?</h3>\n\n<p style=\"font-size:18px\">Итак, в нашей схеме есть телефон, magnit-API, Keycloak и CRM с b2b-токеном. Начиная с июля этого года авторизация производится по номеру телефона. Выдача логина разделена на два этапа: аутентификацию и авторизацию.&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">Аутентификация происходит на уровне Keycloak. Мы отправляем одноразовый код клиенту, выдаем ему токен access/refresh. Дальше авторизуем &mdash; проверяем, есть ли этот пользователь в CRM. Если не найден, то ведем его на регистрацию. Если есть, то запускаем его в приложение.&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\">Redis из схемы мы исключили, так как теперь у CRM один серверный токен.&nbsp;</p>\n\n<p style=\"font-size:18px\"><img alt=\"Архитектура приложения &quot;Магнит&quot; 2021 г.\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/e57/53b/381/e5753b381bbcb5ad84b86c1fbb6fae4a.png\" style=\"height:390px; width:709px\" title=\"Архитектура приложения &quot;Магнит&quot; 2021 г.\" /></p>\n\n<p style=\"font-size:18px\">Архитектура приложения &quot;Магнит&quot; 2021 г.</p>\n\n<h3>Как обойти грабли авторизации</h3>\n\n<p style=\"font-size:18px\">С января по март 2021 года мы перекопали весь код приложения, пофиксили все возможное и невозможное и перестроили архитектуру.&nbsp;</p>\n\n<p style=\"font-size:18px\">За это время мы выяснили, что информации о Keycloak в открытых источниках почти нет.&nbsp; Поэтому я собрал несколько полезных выводов из собственного расследования проблемы лог-аутов:</p>\n\n<ul>\n\t<li>\n\t<p style=\"font-size:18px\">Не стоит использовать Keycloak в качестве инструмента SSO для b2c-продукта. Такие решения лучше писать самим с помощью готовых инструментов. Оптимальная схема: команда авторизации пишет свой сервис на основе библиотек, используя любой язык программирования и реляционку. А обычный jwt access/refresh токен хранит в базе данных и оптимизирует запрос под свои нужды.&nbsp;</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Нужно разделять логин на аутентификацию и авторизацию с самого начала. Если аутентификация и авторизация объединены, проблему сложно идентифицировать. Именно поэтому мы не сразу поняли, в чем дело &mdash; это пользователь неправильно ввел код или у него проблемы с правами в его программе лояльности. До июля 2021 года в предыдущей версии приложения было две кнопки &mdash; для входа и для регистрации. Это приводило к тому, что пользователи не понимали, на какую кнопку нужно нажимать. Заставлять клиента напрягаться &mdash; точно не наш выбор.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\">Авторизация, как и любая другая фича, должна покрываться метриками. Да и само приложение должно проектироваться с фокусом на мониторинг возможных проблем. Если бы мы видели, что у нас каждые 20 дней пропадают ключи из Redis, мы могли сэкономить множество времени. Нужно мониторить запросы и статусы ответов, четко понимать, какой запрос клиента приводит к разлогину, смотреть на состояние активных истекающих сессий, количество созданных сессий и другие параметры.&nbsp;</p>\n\t</li>\n</ul>\n\n<p style=\"font-size:18px\">Кто еще сталкивался с проблемой разлогинов пользователей? Поделитесь своим опытом, расскажите, как настраивали память, CPU и авторизацию токен-exchange?&nbsp;</p>",
    "author": "petrov",
    "category": "маркетинг",
    "image": "4d6d8c6254c060a0d56de982c42379c9.jpg",
    "status": "correction",
    "comment_moderator": "Тема поста не соответствует содержанию.",
    "moderator_id": "ivanov",
    "published_at": ""
  },
  {
    "title": "OSINT для сбора информации о рекламных идентификаторах на сайтах",
    "preview": "Давайте поговорим об использовании уникальных рекламных идентификаторов на сайте и их применимости для использования в OSINT-исследованиях.",
    "body": "<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/c6b/7d8/625/c6b7d8625023225682858fa306f9ea9c.jpg\" style=\"height:1157px; width:1969px\" /></p>\n\n<p style=\"font-size:18px\">Давайте поговорим об использовании уникальных рекламных идентификаторов на сайте и их применимости для использования в OSINT-исследованиях.</p>\n\n<p style=\"font-size:18px\">Рекламные идентификаторы прячутся в коде вебсайта. Чтобы их увидеть необходимо открыть код страницы (в Chrome - CTRL+U) и найти в нем их упоминание. Ключевые слова для поиска даны ниже, применительно к популярным рекламным площадкам:</p>\n\n<p style=\"font-size:18px\"><strong>AdSense:</strong>&nbsp;Pub- или ca-pub</p>\n\n<p style=\"font-size:18px\"><strong>Analytics:</strong>&nbsp;UA-</p>\n\n<p style=\"font-size:18px\"><strong>Amazon:</strong>&nbsp;&amp;tag=</p>\n\n<p style=\"font-size:18px\"><strong>AddThis:</strong>&nbsp;#pubid / pubid</p>\n\n<p style=\"font-size:18px\"><strong>Metrika:</strong>&nbsp;mc.yandex / ym</p>\n\n<p style=\"font-size:18px\">Альтернативным средством обнаружения рекламных идентификаторов на сайте может стать использование таких сервисов:</p>\n\n<p style=\"font-size:18px\"><a href=\"https://themarkup.org/blacklight\">https://themarkup.org/blacklight</a></p>\n\n<p style=\"font-size:18px\"><a href=\"https://urlscan.io/\">https://urlscan.io/</a></p>\n\n<p style=\"font-size:18px\"><a href=\"https://www.spiderfoot.net/\">https://www.spiderfoot.net/</a></p>\n\n<p style=\"font-size:18px\">Обнаружив тот или иной рекламный идентификатор, мы можем попытаться найти его использование на других вебсайтах. Сделать это можно с использованием таких ресурсов:</p>\n\n<p style=\"font-size:18px\"><a href=\"http://www.spyonweb.com/\">http://www.spyonweb.com</a></p>\n\n<p style=\"font-size:18px\"><a href=\"https://analyzeid.com/\">https://analyzeid.com/</a></p>\n\n<p style=\"font-size:18px\"><a href=\"https://dnslytics.com/reverse-analytics\">https://dnslytics.com/reverse-analytics</a>&nbsp;</p>\n\n<p style=\"font-size:18px\"><a href=\"https://intelx.io/tools?tab=analytics\">https://intelx.io/tools?tab=analytics</a></p>\n\n<p style=\"font-size:18px\"><a href=\"https://intelx.io/tools?tab=adsense\">https://intelx.io/tools?tab=adsense</a></p>\n\n<p style=\"font-size:18px\">Проиллюстрируем это на примере изучения сайта&nbsp;<a href=\"https://www.bleepingcomputer.com/\">https://www.bleepingcomputer.com/</a>, который имеет в коде страницы уникальный рекламный идентификатор Google Analytics UA-91740.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/dfd/0dc/9b4/dfd0dc9b401c84103f668d00df62da60.jpg\" style=\"height:226px; width:1136px\" /></p>\n\n<p style=\"font-size:18px\">Введем идентификатор UA-91740 в сервис&nbsp;<a href=\"https://dnslytics.com/reverse-analytics\">https://dnslytics.com/reverse-analytics</a>. Это позволит нам получить сведения о сайте&nbsp;<a href=\"http://tucarga.us/\">http://tucarga.us/</a>, также связанным с данным кодом. Анализ группы сайтов, соединенных одним рекламным идентификатором, открывает для исследователя дополнительные возможности по идентификации их фактических владельцев.</p>\n\n<p style=\"font-size:18px\">Отдельно разберем работу с Яндекс Метрикой. Известно, что порядка 10% всех Метрик являются открытыми. Т.е. они предоставляют любому пользователю возможность удаленного доступа к себе.</p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Приведем несколько сайтов, имеющих открытую Яндекс Метрику:</p>\n\n<p style=\"font-size:18px\"><a href=\"https://20idei.ru/\">https://20idei.ru/</a>, имеющий уникальный код Яндекс Метрики 81150292</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/e38/f10/7fe/e38f107fe918bda82d8cf1f31efb1753.jpg\" style=\"height:313px; width:1428px\" /></p>\n\n<p style=\"font-size:18px\"><a href=\"https://epicube.su/\">https://epicube.su/</a>, имеющий уникальный код Яндекс Метрики 55694881</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/572/e75/5c6/572e755c67fa9ec060a8b9100c586df3.jpg\" style=\"height:369px; width:1464px\" /></p>\n\n<p style=\"font-size:18px\">&nbsp;</p>\n\n<p style=\"font-size:18px\">Для удаленного доступа к чужой Метрике перейдите по ссылке:</p>\n\n<p style=\"font-size:18px\"><a href=\"https://metrika.yandex.ru/dashboard?id=ID\">https://metrika.yandex.ru/dashboard?id=ID</a>, где &quot;ID&quot; - уникальный код Яндекс Метрики.</p>\n\n<p style=\"font-size:18px\">В случае с нашими примерами, ссылки будут иметь следующий вид:</p>\n\n<p style=\"font-size:18px\"><a href=\"https://metrika.yandex.ru/dashboard?id=81150292\">https://metrika.yandex.ru/dashboard?id=81150292</a>&nbsp;- для&nbsp;<a href=\"https://20idei.ru/\">https://20idei.ru/</a></p>\n\n<p style=\"font-size:18px\"><a href=\"https://metrika.yandex.ru/dashboard?id=55694881\">https://metrika.yandex.ru/dashboard?id=55694881</a>&nbsp;- для&nbsp;<a href=\"https://epicube.su/\">https://epicube.su/</a></p>\n\n<p style=\"font-size:18px\">&nbsp;Соответственно, для получения данных об администраторе изучаемого сайта нам следует открыть статистику Яндекс Метрики на день ее установки. Продемонстрируем это на примере анализа Яндекс Метрики, расположенной на сайте&nbsp;<a href=\"https://epicube.su/\">https://epicube.su/</a>.</p>\n\n<p style=\"font-size:18px\">Перейдем по ссылке&nbsp;<a href=\"https://metrika.yandex.ru/dashboard?id=55694881\">https://metrika.yandex.ru/dashboard?id=55694881</a>. Мы увидим, что первые данные о посетителях сайта стали попадать в Метрику 09 октября 2019 года. Откроем отчеты Яндекс Метрики на эту дату Отчеты - (Аудитория - География + Пол + Возраст).</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/aef/b45/713/aefb457134c36217c210e4ba6d887313.jpg\" style=\"height:700px; width:1425px\" /></p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/021/690/3d8/0216903d8d91bc2831ef112d7c5684e8.jpg\" style=\"height:671px; width:1427px\" /></p>\n\n<p style=\"font-size:18px\">Очевидно, что первым и, зачастую единственным, посетителем сайта будет его владелец или администратор. Таким образом, Метрика позволит нам получить сведения о его половозрастных показателях, используемом устройстве и городе проживания.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/59c/a4c/c9b/59ca4cc9b1c1b6ce04c33d4fd68ac84a.jpg\" style=\"height:670px; width:1424px\" /></p>\n\n<p style=\"font-size:18px\">Попадали в Метрику и данные поисковых интересов нашего вероятного администратора.</p>\n\n<p style=\"font-size:18px\">Итак, по данным Яндекс Метрики, сайт&nbsp;<a href=\"https://epicube.su/\">https://epicube.su/</a>&nbsp;администрировался жителем Татарстана, мужчиной, 25-34 лет. Проверим наши выводы в альтернативном источнике данных, в качестве которого я могу предложить сервис&nbsp;<a href=\"https://domainbigdata.com/\">https://domainbigdata.com/</a>. Похоже, что мы не ошиблись.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/59d/3f2/baf/59d3f2baf3104cb545654722a85d21e7.jpg\" style=\"height:499px; width:717px\" /></p>\n\n<p style=\"font-size:18px\">Также не стоит забывать о возможности у силовиков запрашивать данные владельцев Метрики непосредственно в компании Яндекс.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/c46/af3/b46/c46af3b461598150dea942bb7577002e.jpg\" style=\"height:674px; width:1044px\" /></p>\n\n<p style=\"font-size:18px\">Так, российские госорганы направили &laquo;Яндексу&raquo; в январе-июне 2021 года 19650 запросов, касающихся раскрытия данных пользователей. Это следует из статистики, размещенной на сайте самой компании&nbsp;<a href=\"https://yandex.ru/company/privacy/transparencyreport\">https://yandex.ru/company/privacy/transparencyreport</a>.</p>",
    "author": "sidorov",
    "category": "маркетинг",
    "image": "c6b7d8625023225682858fa306f9ea9c.jpg",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "17.10.21 01:55:19"
  },
  {
    "title": "Вся правда о Hi-Res: что скрывают аудиоформаты высокого разрешения",
    "preview": "Одно из самых интересных событий, которые произошли в мире аудио за последние годы — небывалый рост популярности форматов высокого разрешения (Hi-Res).",
    "body": "<p style=\"text-align:justify; font-size:18px\">Одно из самых интересных событий, которые\n    произошли в мире аудио за последние годы &mdash; небывалый рост\n    популярности форматов высокого разрешения (Hi-Res). Среди причин появления\n    в своё время новых форматов &mdash; неудовлетворённость качеством звучания\n    CD, ведь на заре эпохи компакт-дисков все звукозаписывающие лейблы спешили\n    переиздать свой аналоговый каталог на цифровом носителе, мало заботясь о\n    качестве: хотя бы плюс-минус привлекательное и лишённое всевозможных\n    щелчков и прочих шероховатостей звучание уже казалось победой.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Таким образом, производители аппаратуры и\n    звукозаписывающие лейблы начали выполнять свои обещания о высочайшем\n    качестве звучания CD далеко не сразу. В результате, в умах многих\n    аудиофилов формату был нанесен непоправимый ущерб, а CD превратились в\n    этакого цифрового &laquo;злодея&raquo;. Впрочем, забегая вперёд, стоит\n    отметить, что компакт-диски способны звучать совершенно замечательно\n    &mdash; при условии высочайшего качества исходной записи, а также при\n    должном внимании к мастерингу и продюсированию. Но обо всём по порядку.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/489/b28/078/489b280783c47b2b3e6773d508ebd233.jpg\"\n        style=\"width:1440px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">В последнее время мы стали свидетелями\n    возвращения к винилу, а также отмечаем рост интереса к цифровым файлам\n    высокого разрешения. Но не подстерегает ли нас опасность угодить в ловушку\n    1970-х, когда всё внимание было приковано только к техническим\n    характеристикам? Чтобы ответить на этот вопрос, порассуждаем о том, как и\n    что именно мы слышим, а также о реалиях хайрез-записи.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Для начала, затронем техническую сторону вопроса.\n    Формат CD с 16-битным квантованием и частотой дискретизации 44,1 кГц\n    позволяет записать аудио в диапазоне частот от 0 Гц примерно до 22 кГц (то\n    есть, чуть шире возможностей человеческого слуха) и динамическим диапазоном\n    порядка 95 дБ, чего вполне достаточно для подавляющего большинства\n    музыкальных инструментов. При этом формат 24 бит 48 кГц расширяет\n    динамический диапазон до 150 дБ, а верхнюю частоту &mdash; до 24 кГц. Более\n    того, многие аудиофилы предпочитают 24 бит 96 кГц, с верхней частотой до 48\n    кГц, а также 24 бит 192 кГц, с верхней планкой в районе 96 кГц. Столь\n    высокие звуковые частоты оказываются далеко за пределами возможностей\n    человеческого слуха, так что здесь напрашивается простой и резонный вопрос:\n    для чего же собственно всё это нужно?</p>\n\n<p style=\"text-align:justify; font-size:18px\">Некоторые сторонники Hi-Res скажут, что хоть\n    ничего и не слышат на этих частотах, но всё же могут &laquo;почувствовать&raquo;\n    разницу, зачастую преподнося это как более высокую &laquo;воздушность&raquo;\n    звучания. При этом любопытно, каким именно органом чувств они ощущают эту\n    воздушность? В общем-то, мы и вправду можем &laquo;почувствовать&raquo;\n    очень низкие частоты &mdash; при условии, что они воздействуют с высокой\n    амплитудой и с относительно близкого расстояния. Ну а что же касается\n    поклонников Hi-Res, скорее всего, они воспринимают звучание более плавным и\n    слитным из-за высокой частоты дискретизации. К тому же, АЦП и другие\n    компоненты, используемые во время записи в 192 кГц, скорее всего, будут\n    высокого качества, что само по себе повлияет на впечатления от\n    прослушивания.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/6e8/aba/c4f/6e8abac4fd19c2c6606a8a305e99fb44.jpg\"\n        style=\"width:600px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">Для того, чтобы проверить на практике\n    преимущества Hi-Res, все желающие могут провести любопытный тест &mdash;\n    послушать в случайном порядке несколько записей с разной частотой\n    дискретизации на хорошем цифровом аудиоплеере. Заклейте чем-нибудь\n    подручным дисплей проигрывателя, чтобы не иметь представления о том, с\n    каким именно разрешением в данный момент воспроизводится файл. Вооружитесь\n    ручкой и блокнотом (ну или приложением &laquo;заметки&raquo; в смартфоне),\n    прослушайте все записи и отметьте, что именно вы слышите и какой трек\n    звучит лучше. Если у вас получается точно определить более высокие частоты\n    дискретизации, можно с уверенностью заявить, что вы обладаете\n    необыкновенным слухом.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Большинство людей старше среднего возраста\n    способны услышать тон на частоте максимум до 15 кГц. К возрасту 60 лет эта\n    частота может снизиться примерно до 12-13 кГц для среднестатистического\n    мужчины (и, возможно, будет немного выше для женщин). Таким образом,\n    звуковой сигнал с частотой 96 кГц мало что значит для восприятия звука.\n    Однако вполне вероятно, что многие слушатели почувствуют дополнительную\n    плавность и слитность на средних частотах, которой может похвастаться\n    Hi-Res. Впрочем, на качество звучания записей влияет и множество других\n    факторов, некоторые из них играют очень важную роль.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/e7f/839/749/e7f8397497821e9f2bf7d9ab5389adde.jpg\"\n        style=\"width:900px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">К примеру, можно задаться вопросом, с помощью\n    какого оборудования осуществляется запись. Ведь, по иронии судьбы, многие\n    профессиональные конденсаторные микрофоны от Sennheiser, Beyerdynamic, AKG,\n    Neumann, Shure, Rode и Audio Technica обладают частотными характеристиками,\n    которые стремительно снижаются сразу после 20 кГц. Более того, у некоторых\n    популярных микрофонов заметный спад начинается уже после 18 кГц: таким\n    образом, они вряд ли будут улавливать что-либо на частоте 48 или 96 кГц, и\n    в большинстве случаев это как раз хорошо, ибо не очень-то и хочется вводить\n    высокочастотный шум в цепь микширования.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Итак, для того, чтобы записать аудио с\n    действительно &laquo;высоким разрешением&raquo;, в первую очередь,\n    потребуются специальные микрофоны, способные улавливать очень высокие\n    частоты, не внося при этом слишком много собственного шума. Далее нам\n    необходимы микрофонные предусилители и микшеры с расширенной частотной\n    характеристикой и сверхнизким уровнем шума, а также высококлассный\n    аналого-цифровой преобразователь. Предположим, что у нас есть микрофоны с\n    равномерной частотной характеристикой от 20 Гц до 96 кГц и сверхнизким\n    уровнем шума, подключенные специальными аудио кабелями к сверхмалошумящему\n    предусилителю. Далее мы отправим этот сигнал в секцию микширования и\n    высококлассный аналого-цифровой преобразователь, который передаёт\n    аудиосигнал высокого разрешения в цифровой рекордер или компьютер с\n    аналогичными улучшенными характеристиками.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/8b5/713/384/8b571338447855b3a4c32d21d1a59944.jpeg\"\n        style=\"width:1440px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">И в общем-то, да, всё это действительно\n    осуществимо. Более того, записав таким образом соло скрипки в 24 бит 96\n    кГц, можно заметить, что на самых высоких нотах некоторые гармоники\n    достигают частоты приблизительно 28 кГц. Подобные гармоники может давать и\n    флейта сопрано, но вот способны ли мы их услышать &mdash; это уже другой,\n    не менее интересный вопрос. В конечном итоге, практически весь значимый для\n    нашего слуха звуковой сигнал в записях соло скрипки вполне может\n    содержаться на 16-битном CD с частотой дискретизации 44,1 кГц.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Вдвойне удивительно, что даже полноценный\n    оркестр, с его широчайшим динамическим диапазоном, вполне можно записать в\n    16 битах, при условии изначально правильной настройки уровней (не прибегая\n    к компрессии). Безусловно, не стоит забывать, что вполне возможно\n    сгенерировать электронные звуки, которые выходят за пределы частотного\n    диапазона человеческого слуха и динамического диапазона в 100 дБ. Но всё\n    это остаётся, как правило, на уровне теории.</p>\n\n<p style=\"text-align:justify; font-size:18px\"><img\n        src=\"https://habrastorage.org/r/w780/getpro/habr/upload_files/874/9fe/3cd/8749fe3cd0f163819fb1fe6805d20111.jpg\"\n        style=\"width:800px\"/></p>\n\n<p style=\"text-align:justify; font-size:18px\">В заключение стоит отметить, что благодаря более\n    высокой плавности и слитности звучания в среднечастотном диапазоне, Hi-Res\n    записи однозначно достойны внимания слушателей, но только при условии, что\n    аудиосистема позволяет воспроизвести все эти нюансы.</p>\n\n<p style=\"text-align:justify; font-size:18px\">Любопытно, что у многих аудиофилов есть любимые\n    записи классической музыки, сделанные в конце 50-х и начале 60-х годов.\n    Ведь музыка &mdash; это не только технические характеристики, а\n    определяющим фактором зачастую является исполнение и профессионализм\n    звукорежиссёра, что позволяет сделать хорошую запись даже с минимальным\n    набором микрофонов. А послушав некоторые джазовые записи, сделанные в\n    начале 60-х годов, нельзя не отметить, что они звучат очень живо и\n    музыкально: может быть, не так уж и важно, что они не в Hi-Res.</p>",
    "author": "vasechkin",
    "category": "научпоп",
    "image": "489b280783c47b2b3e6773d508ebd233.jpg",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "03.11.21 01:55:19"
  },
  {
    "title": "Большой брат (пока) подслеповат",
    "preview": "Полагаю, прямо на наших глазах разворачивается переход между второй и третьей стадиями принятия неизбежного (гнев и торг) по поводу повсеместно установленных умных камер, чья функция заключается в устранении последних следов приватности в общественных местах.",
    "body": "<p style=\"font-size:18px\">Полагаю, прямо на наших глазах разворачивается переход между второй и третьей стадиями принятия неизбежного (гнев и торг) по поводу повсеместно установленных умных камер, чья функция заключается в устранении последних следов приватности в общественных местах.</p>\n\n<p style=\"font-size:18px\">Распознавание лиц и биометрия &mdash; лишь частные случаи более обширных разработок в области машинного зрения, но именно эти аспекты воспринимаются максимально болезненно, поскольку человека угнетает повсеместная слежка.</p>\n\n<p style=\"font-size:18px\">Я заинтересовался состязательными нейронными сетями, когда глубокой осенью 2018 года прочел статью &laquo;<a href=\"https://www.aiweirdness.com/do-neural-nets-dream-of-electric-18-03-02/\" rel=\"noopener noreferrer nofollow\">Do neural nets dream of electric sheep?</a>&raquo; (&laquo;Снятся ли нейронным сетям электроовцы&raquo;)? Автор проанализировала несколько примеров, где нейронка изрядно озадачивается, обнаружив овец в необычном сеттинге. Особенно интересен следующий пример:</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/165/715/ca7/165715ca7077545670c4c5daf0f5cc40.jpg\" style=\"height:818px; width:1024px\" /></p>\n\n<p style=\"font-size:18px\">Как видите, и NeuralTalk2, и Azure &laquo;мыслят стереотипно&raquo;: в датасетах, на которых они обучались, овцы не лазали по деревьям, поэтому одна сеть увидела здесь &laquo;стаю крупных белых птиц&raquo;, а другая &laquo;стадо жирафов&raquo;. В&nbsp;<a href=\"https://gradientscience.org/intro_adversarial/\" rel=\"noopener noreferrer nofollow\">другом примере</a>&nbsp;подобных атак на алгоритмы компьютерного зрения (такие примеры называются &laquo;состязательными&raquo;) обнаруживается, что даже небольшой поворот изображения сбивает нейронную сеть с толку:</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/c4b/39f/aa8/c4b39faa8eb0a821c7d51250bd3ab790.png\" style=\"height:588px; width:1200px\" /></p>\n\n<p style=\"font-size:18px\">Револьвер превращается в мышеловку, лодочная станция &ndash; в гильотину, а сервант с фарфором &ndash; в прожектор. Причем, в примере с сервантом мне даже удается посмотреть на эту ошибку &laquo;глазами нейронки&raquo;, но остальные ее ошибки понять не получается.</p>\n\n<p style=\"font-size:18px\">Попытки эксплуатации аналогичных уязвимостей при распознавании лиц активизировались&nbsp;<a href=\"https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%B5%D1%81%D1%82%D1%8B_%D0%B2_%D0%93%D0%BE%D0%BD%D0%BA%D0%BE%D0%BD%D0%B3%D0%B5_(2019%E2%80%942020)\" rel=\"noopener noreferrer nofollow\">в 2019 году</a>&nbsp;после манифестаций в Гонконге, когда стало понятно, что маскировка эффективнее брутфорса (протестующие пытались громить умные камеры). Последовавшая вскоре эпидемия COVID-19 и масочный режим вновь подстегнули такие исследования и, в частности, показали, что маска &ndash; плохая защита от нейронки. Лицо человека имеет характерную форму (скулы) и симметрию, кроме того, легко выявляется по симметричным и при этом блестящим глазам. На Хабре публиковался перевод интересного&nbsp;<a href=\"https://habr.com/ru/company/productivity_inside/blog/540860/\" rel=\"noopener noreferrer nofollow\">исследования</a>&nbsp;о том, легко ли обмануть алгоритм распознавания лиц при помощи медицинской маски (спойлер: нет).</p>\n\n<h2>Обнаружение и распознавание лиц</h2>\n\n<p style=\"font-size:18px\">Для начала разграничим две эти задачи &ndash; на самом деле, они сильно отличаются по сложности. Для обнаружения лица (1) достаточно, чтобы программа выявляла на картинке овал, а на нем &ndash; два глаза. Но для того, чтобы убедиться, что это именно человеческое лицо, а тем более распознать его, требуется гораздо более скрупулезный анализ характерных точек. Далее коротко расскажу о градиентной маскировочной маске, описанной в&nbsp;<a href=\"https://towardsdatascience.com/fooling-facial-detection-with-fashion-d668ed919eb\" rel=\"noopener noreferrer nofollow\">статье</a>&nbsp;Брюса Макдональда.</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/4d9/af9/628/4d9af962801e11bf28a6ab7eb993db3a.png\" style=\"height:586px; width:1208px\" /></p>\n\n<p style=\"font-size:18px\">Таким образом, алгоритм распознавания лица учитывает положение сразу множества легко идентифицируемых точек: зрачка, радужки, мочек ушей, уголков губ, кончика носа, скул &ndash; а также расстояния между этими точками. Поэтому обычная медицинская маска &ndash; не лучшая маскировка. Она не закрывает глаз, не закрывает ушных мочек; общая симметрия лица также сохраняется. Но в 2019 году, до повсеместного распространения масочного режима, антинадзорная градиентная маска была по-настоящему интересной находкой:</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/191/997/f9b/191997f9b9ba84674b4d3f5ce2b5487a.png\" style=\"height:406px; width:1017px\" /></p>\n\n<p style=\"font-size:18px\">Программа на Python (<a href=\"http://dlib.net/face_detector.py.html\" rel=\"noopener noreferrer nofollow\">исходный код</a>) создает градиентный узор/шум (так называемые &laquo;<a href=\"http://mechanoid.su/cv-image-detector2.html\" rel=\"noopener noreferrer nofollow\">гистограммы направленных градиентов</a>&raquo;), распределяющий линии и продолговатые фигуры таким образом, что они кажутся камере видеонаблюдения набором схематически очерченных лиц. Обратите внимание на имитацию глаз и бровей. Методом Q-обучения автор также нашел такой вариант замощения маски этими группами характерных точек, при котором &laquo;лица&raquo; выглядят разупорядоченно и тем более осложняют опознание носителя маски:</p>\n\n<pre>\n<code>fitness = mlrose.CustomFitness(detected_max)\nproblem = mlrose.DiscreteOpt(length=24, fitness_fn=fitness,\nmaximize=True, max_val=scale_factor)\nschedule = mlrose.ExpDecay()\nbest_state, max_faces = mlrose.simulated_annealing(problem, schedule=schedule, max_attempts=10, max_iters=1000,\ninit_state=initial_state, random_state=1)\n\nprint(&#39;Optimal state found: &#39;, best_state)\nprint(&#39;Max fitness found: &#39;, max_faces)\n# сохраняем оптимальный найденный результат\nget_img_from_state(best_state)\nprint(&quot;Number of faces in output: &quot;, len(detect_faces(cv2.imread(OUTPUT)))) \n</code></pre>\n\n<p style=\"font-size:18px\">По-видимому, такой антинадзорный узор действительно эффективен для обмана простого приложения вроде Snapchat или камеры видеонаблюдения. Тем не менее, эпидемия внесла коррективы в работу компьютерного зрения: теперь алгоритмы целенаправленно тренируют на распознавание лица в маске. Так, на Хабре в корпоративном блоге &laquo;Productivity Inside&raquo; была&nbsp;<a href=\"https://habr.com/ru/company/productivity_inside/blog/540860/\" rel=\"noopener noreferrer nofollow\">переведена статья</a>&nbsp;Томаса Смита, который попытался обмануть приложение&nbsp;<a href=\"https://www.faceplusplus.com/face-comparing/\" rel=\"noopener noreferrer nofollow\">Face++</a>. Эта программа не только распознает лица, но и сравнивает лица, отснятые в разных условиях, чтобы проверить, принадлежит ли лицо с обоих кадров одному и тому же человеку.</p>\n\n<p style=\"font-size:18px\">Точность распознавания лица в этой программе без применения маски составила более 95%, а различные маски все равно не слишком сбивали Face++: детская маска с собачьей мордочкой снижала точность распознавания до 82,4% - хотя теоретически &laquo;второе лицо&raquo; должно было дезориентировать систему. Автор предположил, что лицо распознавалось лучше, так как сама (детская) маска была меньше. Обычная медицинская маска снижала точность распознавания лица до 74,7%, что все равно очень высоко, а маска с вышеприведенным антинадзорным узором вообще не помогла: точность распознавания выросла более чем до 83%. Таким образом, в 2020 году алгоритмы компьютерного зрения уже явно ориентированы на распознавание масок. Но программа в принципе не смогла обнаружить лицо на фотографии, когда автор вместе с обычной медицинской маской надел черные очки. Таким образом, сокрытие большей части лицевых скул, носа и глазной симметрии по-прежнему эффективно против распознавания лиц.</p>\n\n<p style=\"font-size:18px\">Именно на уничтожении лицевой симметрии сосредоточен макияж-камуфляж по технологии&nbsp;<a href=\"https://ahprojects.com/cvdazzle\" rel=\"noopener noreferrer nofollow\">CV Dazzle</a>, разработанный Адамом Харви. Поскольку алгоритмы распознавания анализируют свыше 60 ключевых точек на лице, одного лишь макияжа недостаточно: слишком велика избыточность алгоритма. Зато помогают накладные волосы, шиньоны и скрывание хотя бы одного глаза. Полностью приведу здесь советы по стилю CV Dazzle:</p>\n\n<ol>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Макияж:</strong>&nbsp;Избегайте тональных кремов. Они только подчеркивают ключевые точки лица. Вместо этого применяйте макияж, который придает лицу необычную контрастность как по цвету, так и по сочетанию: светлые тона на темной коже и темные пятна на светлой.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Переносица:</strong>&nbsp;Нужно частично закрыть область переносицы. При распознавании лиц наиболее важен тот регион, где сходятся лоб, нос и глаза. Мера особенно эффективна против алгоритма обнаружения лица из OpenCV.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Глаза:</strong>&nbsp;Частично закройте одну или обе глазницы. Симметричное положение и темный цвет глаз &ndash; ключевые признаки, выдающие лицо.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Маски:</strong>&nbsp;вместо скрывания лица маской меняйте контраст, тональные градиенты, а также пространственные сочетания темных и светлых областей на лице: для этого меняйте прическу, макияж, надевайте необычные украшения.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Голова:</strong>&nbsp;Исследование&nbsp;<a href=\"http://dl.acm.org/citation.cfm?id=2502121\" rel=\"noopener noreferrer nofollow\">Ранрана Фэня и Балакришнана Прабхакарана&nbsp;</a>из Техасского Университета показало, что запутать алгоритм распознавания лиц можно, скрыв эллиптические очертания головы. В качестве камуфляжа подойдут прически, водолазки и другие украшения, скрывающие эллиптическую форму лица.</p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>Асимметрия:</strong>&nbsp;алгоритмы обнаружения лица учитывают симметрию между левой и правой стороной лица. Выбирая асимметричный образ, эти алгоритмы можно обмануть.</p>\n\t</li>\n</ol>\n\n<p style=\"font-size:18px\">Здесь находим одно принципиальное пересечение с опытом Томаса Смита: скрываем глаза. Смит сделал это, надев черные очки. Также было бы удобно разрушить симметрию, скрыв один глаз:</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/b2c/a50/976/b2ca5097643192029c63a4952ca300dd.png\" style=\"height:202px; width:491px\" /></p>\n\n<p style=\"font-size:18px\">Тем не менее, подобный камуфляж &ndash; пиррова победа, поскольку он делает человека малозаметным для камер, зато крайне заметным для человека. Менее броский вариант антинадзорной маскировки был придуман в 2017 году; его предложил инженер Яндекса&nbsp;<a href=\"https://habr.com/ru/users/bobuk/\" rel=\"noopener noreferrer nofollow\">Григорий Бакунов</a>&nbsp;<a href=\"https://habr.com/users/bobuk\">@bobuk</a>. Его&nbsp;<a href=\"https://telegra.ph/Novyj-makiyazh-korolya-07-14\" rel=\"noopener noreferrer nofollow\">макияж для защиты от распознавания лиц</a>&nbsp;делается при помощи блестящих полос и точек; показал себя особенно эффективным, чтобы сбивать с толку биометрию. То есть, макияж Бакунова не столько мешает камере распознать лицо &ndash; как вы помните из вышеприведенных примеров, камера вполне обнаружит лицо по ключевым точкам &ndash; сколько затрудняет опознание человека.&nbsp;&nbsp;&nbsp;&nbsp;</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/4a2/2f4/38b/4a22f438b6295057e72655a64619b8be.jpg\" style=\"height:854px; width:1280px\" /></p>\n\n<p style=\"font-size:18px\">По словам Бакунова, проект был свернут после получения первых положительных результатов, так как технология легко может быть использована во зло. Но она подсвечивает еще одну важную уязвимость: алгоритмы распознавания лиц настолько полагаются на симметрию глаз, что их можно ловить как раз на этом. Китайские ученые&nbsp;<a href=\"https://findbiometrics.com/biometrics-news-researchers-use-tape-and-glasses-to-spoof-face-id-liveness-detection/\" rel=\"noopener noreferrer nofollow\">показали</a>, что устройство Apple, открывающееся по идентификации лица пользователя (FaceID) легко обмануть, надев на спящего обладателя устройства очки, на которые на месте зрачков наклеены две черные точки. FaceID распознает лицо по ключевым точкам, а зрачки как таковые не распознает &ndash; ему достаточно характерной глазной симметрии и двух черных точек на месте зрачков.</p>\n\n<p style=\"font-size:18px\">Таким образом, чтобы обмануть видеонаблюдение, важнее скрывать симметрию области глаз; темные очки из опыта Смита &mdash; более эффективная маскировка, чем медицинская маска. Что касается опытов Бакунова, их успешность могла быть связана со сравнительным несовершенством технологий распознавания в 2017 году. Если система все-таки вычленит в толпе лицо, сопоставить его с фото в базе &ndash; дело техники.</p>\n\n<h2>Кепка-невидимка</h2>\n\n<p style=\"font-size:18px\">Уже в опытах Харви отмечалось, что распознавание лица значительно усложняет шляпа с полями. Шляпа &ndash; простейшее устройство, корректирующее отражательную заметность глаз; то есть, поля частично блокируют как свет, попадающий в глаза, так и отраженный от глаза свет. Еще недавно шляпа была всеобщим мужским аксессуаром, в ней человек не выделялся в толпе. Поэтому данное направление исследований кажется предпочтительнее, чем макияж-камуфляж. Первое достижение в этой области &ndash;&nbsp;<a href=\"https://codeby.net/threads/ataka-na-sistemu-raspoznavanija-lic.68095/\" rel=\"noopener noreferrer nofollow\">инфракрасная кепка</a>:</p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/d97/0c7/f3b/d970c7f3bc95046249a4b78794a2f921.jpg\" style=\"height:1189px; width:1000px\" /></p>\n\n<p style=\"font-size:18px\">Подобное устройство используется для &laquo;атаки с невидимой маской&raquo; IMA. На рынке доступны дешевые светодиоды, испускающие инфракрасное излучение с длиной волны 850 или 940 нм. Такой свет неразличим для человека, но отлично захватывается камерами видеонаблюдения. Такая камера раскладывает &laquo;увиденное&raquo; лицо на цветовые каналы R, G и B, и при этом весь инфраскрасный свет попадает в канал R, сильнейшим образом искажая картинку. Такие светодиоды под козырьком кепки практически не заметны, питание для них также требуется минимальное (по данным авторов, аккумулятор 18650 может поддерживать светодиод не менее двух часов).</p>\n\n<p style=\"font-size:18px\">Извлечение лица из последовательности видеокадров и сравнение найденного лица с фотографией из базы данных осуществляется методом &laquo;Face embedding&raquo; (встраивание лица). Лицо извлекается со множества кадров видео, эти данные преобразуются в векторы, после чего сравниваются с фотографией человека, которая может быть преобразована в такой же вектор. Инфракрасная кепка позволяет сорвать этот процесс уже на самом первом этапе, то есть, не дает вычленить лицо в толпе.</p>\n\n<p style=\"font-size:18px\">Эффективность такой кепки должна снижаться при ярком естественном освещении, а также, скорее всего, легко нивелируется при встраивании в камеру видеонаблюдения такого режима, который позволяли бы ей отсекать весь инфракрасный спектр, либо интерпретировать его как красный. Кроме того, светодиоды вполне могут быстро посадить зрение: пусть человек и не воспринимает инфракрасного излучения, в данном случае прямо вам в глаз светит яркая лампочка, выжигающая вам сетчатку. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n\n<h2>Заключение</h2>\n\n<p style=\"font-size:18px\">Системы распознавания лиц и биометрия развиваются параллельно с цифровизацией человеческих учетных данных и, в сущности, противодействовать этому технологическому вектору очень сложно. Я полагаю, что подобные &laquo;состязательные&raquo; разработки для обмана идентифицирующих устройств рано или поздно будут криминализованы, но сам пока на биометрию переходить не собираюсь. В моем втором блоге на Хабре (куда вынес технические переводы) я недавно публиковал статью о том, что глубокое обучение уже<a href=\"https://habr.com/ru/post/582646/\" rel=\"noopener noreferrer nofollow\">&nbsp;упирается в пределы своих технических возможностей</a>, поэтому до изобретения принципиально новых алгоритмов окончательная победа над подобными обманными приемами может быть еще далека. Предположу, что здесь мы скорее увидим гораздо более опасные атаки, когда злоумышленник научится виртуально накладывать на лицо преступника лицо другого человека, чтобы на пленке засветился невиновный человек, и можно было попытаться таким образом создать преступнику алиби. Либо могу представить дальнейшую миниатюризацию инфракрасных маячков, встраивание их в пирсинг, серьги или в контактные линзы. Макияж-камуфляж, вероятно, останется в истории подобной маскировки лишь первым и относительно &laquo;дешевым&raquo; шагом, который, однако, подсказал принципиально важные идеи и уязвимости для поборников приватности. &nbsp;&nbsp;&nbsp;</p>",
    "author": "petrov",
    "category": "научпоп",
    "image": "434e296a24b12ad3bfa2fab00cf69935.jpg",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "01.11.21 01:55:19"
  },
  {
    "title": "Развитие систем криптографической защиты информации в IoT (часть 1-я)",
    "preview": "Глядя на то, как сегодня продвигается внедрение аппаратных средств криптографии в кибер-физических системах, к которым относят и интернет вещей, невольно вспоминаешь анекдот. \n\nУлитка заходит в бар, но бармен заявляет: \"У нас строгая политика в отношении улиток!\", — и ногой выпихивает ее на улицу. Через неделю улитка возвращается в бар и говорит бармену: \"Ну и зачем ты это сделал!?\"",
    "body": "<p style=\"font-size:18px\"><strong>Глядя на то, как сегодня продвигается внедрение аппаратных средств криптографии в кибер-физических системах, к которым относят и интернет вещей, невольно вспоминаешь анекдот.&nbsp;</strong></p>\n\n<p style=\"font-size:18px\"><strong><em>Улитка заходит в бар, но бармен заявляет: &quot;У нас строгая политика в отношении улиток!&quot;, &mdash; и ногой выпихивает ее на улицу. Через неделю улитка возвращается в бар и говорит бармену: &quot;Ну и зачем ты это сделал!?&quot;</em></strong></p>\n\n<p style=\"font-size:18px\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/f2e/bc5/b42/f2ebc5b42569e05c70935610596dc760.jpg\" style=\"height:1654px; width:2378px\" /></p>\n\n<p style=\"font-size:18px\"><strong>А ведь все еще помнят, как прекрасно начиналось развитие интернета вещей. Все, что связано с IoT, IIoT, M2M поднимало волну хайпа, уступавшую разве что криптовалютной истерии. Огромное число стартапов, многие из которых казались настоящим прорывом для своего времени (&ldquo;Цифровизация экономики&rdquo;, &ldquo;Индустрия 4.0&rdquo; и др.), пробуждало немалый интерес как среди специалистов, так и у государственных лиц. Одни видели в IoT возможности реализации смелых и перспективных идей, другие &ndash; эффективный инструмент для привлечения в экономику регионов новых ресурсов. Мы же, как &quot;безопасники&quot;, не оставались в стороне и пристально следили за развитием событий. Вот какие наблюдения нам удалось сделать.</strong></p>\n\n<p style=\"font-size:18px\"><strong>Аспекты безопасности&nbsp;в IoT - в выигрыше предусмотрительные</strong></p>\n\n<p style=\"font-size:18px\">Было понятно, что на старте, то есть в ситуации, когда важны каждая минута и каждая копейка, мало кто будет заморачиваться внедрением сложных механизмов защиты. Важнее показать потенциальному заказчику, что решение в принципе работоспособно. Но рано или поздно настает момент, когда само решение или его часть достигает состояния, допускающего возможность применения в других областях. В том числе и в тех, которые связаны с критически важной инфраструктурой. И это вызывало вполне определенные опасения. Одно дело, когда вы развлекаетесь с умной лампочкой у себя в защищенном периметре, другое &ndash; когда вы управляете исполнительным механизмом включения подачи энергоресурса, находящимся далеко за пределами вашей физической досягаемости. При схожих принципах организации взаимодействия риски и последствия вторжения в обеих ситуациях несопоставимы.</p>\n\n<p style=\"font-size:18px\">Несмотря на то, что к моменту мощного рывка в развитии IoT существовали разнообразные средства обеспечения информационной безопасности, в том числе и криптографические, мало кто из IoT-сообщества интересовался их внедрением в свои системы. Причин тому было несколько. Кто-то искренне полагал, что логин-пароль &ndash; это нормально (сарказм). Кто-то надеялся на встроенные возможности протокола обмена. Но главная причина заключалась в том, что хорошая защита стоит денег и требует времени на интеграцию. И добровольно эти ресурсы никто не отдаст. Ситуацию усугубляло то, что большинство существующих на тот момент средств безопасности разрабатывалось для других применений. А значит, требовало дополнительных усилий по их адаптации, причем как со стороны разработчиков этих средств, так и со стороны вендоров конечных решений. В целом, за малым исключением, так происходит и по сей день.</p>\n\n<p style=\"font-size:18px\">В определенный момент в России развитием IoT серьезно занялись регуляторы, что позволило снизить масштаб хаоса в ряде важных и, главное, крупных сегментов. В итоге компании, уделяющие внимание безопасности, оказались в выигрыше. Перед ними открылись рыночные ниши, более не доступные тем, кто в свое время сэкономил. А новоявленные аутсайдеры были вынуждены переделывать готовые решения, терпя убытки, кратно превышающие затраты на защиту на начальном этапе. Деятельность регуляторов в целом можно назвать конструктивной, а в ряде аспектов, таких как ИБ КИИ, сфере защиты персональных данных &ndash; просто жизненно необходимой. Того нормативного вакуума, который царил на рынке 4-5 лет назад больше нет, и уже не будет.</p>\n\n<p style=\"font-size:18px\">При этом реакция на действия регуляторов была самой разнообразной - от одобрения до жесткой критики. Об этом можно долго спорить, но факты таковы, что в сфере IoT появился и развивается новый куст потребительских ценностей, связанных с соответствием IoT систем требованиям новых законов и подзаконных актов. Чтобы реализовать это соответствие, нужна компетенция и технические возможности. Это стало востребовано на рынке. А значит есть место для услуг, которые можно и нужно монетизировать. И тут на сцену выходим мы, &quot;безопасники&quot;, т.к. помимо разработки технических средств мы умеем взаимодействовать с регуляторами, разбираемся в законодательной базе и знаем, как сертифицировать готовые решения. Так уж вышло, что основным драйвером роста рынка средств безопасности стала не социальная ответственность бизнеса, а &laquo;невидимая рука рынка&raquo;, известно откуда растущая.</p>\n\n<p style=\"font-size:18px\"><strong>Аппаратная защита в IoT находится на этапе технологической незрелости</strong></p>\n\n<p style=\"font-size:18px\">Но давайте вернемся к техническим системам. Говоря об интернете вещей, хочется сделать упор не на технологичные игрушки для умного дома (хотя и там вопрос защиты стоит достаточно остро), а, на устройства и системы, которые оказывают влияние на жизнь социума. Речь идет о применении технологий интернета вещей в сфере ЖКХ, а это более 70% современного российского рынка IoT. Показания счетчиков энергоресурсов - тепла, газа, электричества, воды, может быть, и не требуют соблюдения конфиденциальности передаваемых данных, но защита от несанкционированной корректировки показаний здесь крайне полезна. Интересны системы, которые по ряду критериев можно отнести к критической информационной инфраструктуре. Это энергетика, банковская деятельность, медицинские организации и тому подобное. Ну и куда же без систем, в которых циркулируют персональные данные клиентов, пользователей, сотрудников. &nbsp;Все это либо уже попало, либо имеет все шансы попасть в ближайшее время под регулирование со стороны государства и, как следствие, сертификацию. И здесь, когда дело касается использования средств криптографической защиты, мы можем задействовать только отечественную криптографию, что накладывает дополнительные ограничения на техническую реализацию конечного решения.</p>\n\n<p style=\"font-size:18px\"><em>Так, например, большинство чипов, используемых в IoT, имеет встроенную реализацию зарубежных криптографических алгоритмов, тогда как отечественную криптографию приходится допиливать на уровне микропрограммы. Отсюда разница в разы, как в быстродействии, так и в энергопотреблении.</em></p>\n\n<p style=\"font-size:18px\">Хотелось бы отметить, что на сегодняшний день еще нет универсальной таблетки, которая могла бы подойти всем. Сейчас мы проживаем этап незрелости технологической базы по направлению аппаратной защиты. Это выражается, прежде всего, в негативном влиянии существующих механизмов защиты на ключевые потребительские параметры конечного решения: цена, производительность, время автономной работы от батареи. Для подавляющего большинства решений внедрение средств защиты все еще остается за пределами рентабельности. В счетчик или датчик за несколько сотен рублей не поставишь криптомодуль ценой около тысячи, не вызвав предсказуемые последствия. А если конечное устройство имеет автономное питание, то ресурс батареи будет снижен в разы за счет выполнения криптографических преобразований на отдельном модуле. И это, не говоря о дополнительных затратах на инженерию и внедрение.</p>\n\n<p style=\"font-size:18px\"><strong>Будет ли выход?&nbsp;</strong></p>\n\n<p style=\"font-size:18px\">Описанная ситуация вполне закономерна, и большинство рукотворных систем в свое время переживали похожие проблемы. Поэтому мы предлагаем взглянуть на проблему с несколько непривычной стороны, а именно, с точки зрения законов развития технических систем (ЗРТС), которые в свое время вывел Генрих Альтшуллер и развили его ученики. Законы носят статистически-достоверный характер, но, когда мы имеем дело с рукотворными системами, они работают. К сожалению, на рассмотрение всех законов одной статьи не хватит, и мы коснемся только базовых.</p>\n\n<p style=\"font-size:18px\">В основе иерархии ЗРТС лежит закон развития по S-образной кривой.</p>\n\n<p style=\"font-size:18px\"><img alt=\"Рис. 1 Развитие систем по S-образной кривой.\" src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/497/834/050/497834050f81b3f3c653fc215c21a483.png\" style=\"height:253px; width:364px\" title=\"Рис. 1 Развитие систем по S-образной кривой.\" /></p>\n\n<p style=\"font-size:18px\">Рис. 1 Развитие систем по S-образной кривой.</p>\n\n<p style=\"font-size:18px\">Авторы выделяют 4 этапа развития, каждый из которых характеризуется определенным набором признаков.</p>\n\n<p style=\"font-size:18px\">Первый этап жизни любой системы &mdash; это ее рождение и детство. На этом отрезке происходит уточнение конструкции и состава элементов, отлаживается взаимодействие с надсистемой. Устраняются различного рода проблемы и косяки. Второй этап характеризуется бурным ростом главных показателей системы. Система становится рентабельной. Растут объемы выпуска и попутно растут инвестиции за счет значительного снижения рисков. Между первым и вторым этапами выделяют, так называемый, переходный этап. Здесь еще вовсю присутствуют маркеры первого этапа, но уже явно просматриваются тенденции к переходу на второй. Третий этап начинается тогда, когда система достигает максимума показателей, свойственных конкретной реализации. Система уже заполнила рынок и дальнейший рост упирается в некие пределы развития: технологические, физические, инженерные. Обычно, по мере развития надсистемы актуальность системы, находящейся на 3-м этапе, начинает падать. Если в этот момент попытки разрешения противоречий, тормозящих дальнейшее развитие, будут успешны, то у системы есть шанс на качественный скачок и выход на новые горизонты развития. В противном случае система приходит к 4-му этапу: постепенному угасанию и, возможно, смерти. Теперь давайте рассмотрим подробнее каждый этап применительно к сфере IoT.</p>\n\n<p style=\"font-size:18px\"><strong>На первом этапе</strong>&nbsp;происходит борьба за жизнеспособность системы в принципе. Как правило, в силу различных причин, система на этом этапе не способна удовлетворить требования общества и практически не используется. Длительность первого этапа может быть сколь угодно долгой: от нескольких месяцев до нескольких десятков лет. Строго говоря, не факт, что система вообще преодолеет эту стадию, если для этого не сложатся минимально благоприятные условия.</p>\n\n<p style=\"font-size:18px\">Причины подобного стечения обстоятельств закономерны. Прежде всего это тотальная нехватка ресурсов: кадровых и материальных. Новые системы обычно вообще не избалованы ресурсами, т. к. высоки риски невозврата инвестиций. Специалисты, создающие систему, выйдя из смежных отраслей, почти всегда сталкиваются с новыми ограничениями как внутри системы, так и в надсистеме. И количество ограничений растет по мере того, как происходит освоение новой предметной области, пусть и весьма близкой к исходной. Возникает куст противоречий, которые следует разрешать в том числе и с применением изобретательских методик. Но эти противоречия нужно еще найти, осознать и сформулировать. Компоненты, которые берутся из альтернативных систем, тоже почти никогда не удовлетворяют целевым требованиям в полной мере. Их приходится допиливать на месте или искать другие. Отсюда - множество узких мест, бутылочных горлышек, тормозящих достижение требуемого эффекта.</p>\n\n<p style=\"font-size:18px\"><em>Если брать нашу область, то в одном случае это может быть скорость выполнения криптографических операций, в других - ограничения по энергопотреблению, цена модуля, его размер, да все, что угодно. При этом не стоит забывать и про внешние факторы.</em></p>\n\n<p style=\"font-size:18px\">В итоге имеем следующую картину: новая система состоит и компонентов, разработанных для других систем: чипы, API, протоколы, интерфейсы позаимствованы из близких решений. Система в таком виде на рынок еще не вышла либо крайне слабо на нем представлена (в основном в тех областях, где соотношение ключевых параметров хоть как-то удовлетворяет требованиям). Система стремится к объединению с элементами надсистемы или с альтернативными системами, господствующими на рынке с целью получения дополнительного толчка для внедрения. Происходит потребление ресурсов, специально не предназначенных для системы.</p>\n\n<p style=\"font-size:18px\"><em>В нашем случае примером взаимодействия с надсистемой могут быть попытки встроить крипто-модули в существующую&nbsp;PKI-инфраструктуру предприятия или другой организации. Когда дело касается сотен или даже тысяч устройств, все выглядит более-менее подъемно. Но если представить, что таких устройств в перспективе может быть не один миллион, то такие манипуляции, как выписка новых сертификатов, отзыв скомпрометированных, хранение и анализ CRL на конечных устройствах, зачастую не самых быстрых, представляют немалые трудности.</em></p>\n\n<p style=\"font-size:18px\">Вместе с тем уровень идей и инноваций на данном этапе достаточно высок, при их небольшом количестве. И самое главное, что следует отметить: система на данном этапе почти всегда убыточна. Доходы от ее продаж не перекрывают затраты на разработку и доводку, т. к. продажи в силу многочисленных недостатков &ndash; мизерные. А если представить, что рентабельность систем безопасности, как таковую, можно оценить лишь масштабом вероятных предотвращенных последствий (вероятных!), то становится совсем грустно. Именно поэтому так важна &laquo;невидимая рука рынка&raquo; в виде государства и регуляторов.</p>\n\n<p style=\"font-size:18px\">Выводы таковы, что на первом этапе глупо ждать от системы каких-то прорывных результатов. Необходимо работать над системой, повышая рентабельность, и, устраняя узкие места. На этом этапе допустимы даже радикальные изменения вплоть до полной смены принципа действия. Очень важно выбрать для системы ту область применения, соотношение достоинств и недостатков которой наиболее приемлемо. Это станет дополнительной подпиткой. Следует стараться ориентироваться на существующую инфраструктуру и источники ресурсов. В таком режиме, скорее всего, придется просуществовать несколько лет, поэтому неплохо бы попутно оценить тренды в надсистеме: куда она движется, какие есть перспективы, что может угрожать ее работе и существованию вообще. Последнее полезно делать периодически, независимо от этапа.</p>\n\n<p style=\"font-size:18px\"><strong>Переходный этап,&nbsp;</strong>как часть первого, характерен достижением системой состояния неустойчивого равновесия между силой, толкающей систему на рынок благодаря ее полезным свойствам, и тормозящим воздействием различных факторов. Этими факторами могут быть как собственные недостатки системы, так и инерция надсистемы, общества, конкуренция с альтернативными системами, уже присутствующими на рынке. Но в целом система, как правило, уже готова к проникновению на рынок, и делаются первые попытки продаж. При этом равновесие может быть нарушено в любую сторону, причем самым малым воздействием. Поэтому так важно внимание к деталям, от которых напрямую зависит будущее системы. В процессе доработки неизбежно растут главные показатели системы, и повышается степень удовлетворенности первоначальным требованиям. Делаются попытки внедрения системы в разных областях, но, лишь малая часть из них становится успешной.</p>\n\n<p style=\"font-size:18px\"><em>Говоря о стадии развития аппаратных средств криптографической защиты для кибер-физических систем, можно говорить именно о переходном этапе, характеризующемся пока довольно низким проникновением на рынок, относительно реальной текущей потребности. Причинами тому могут являться:</em></p>\n\n<p style=\"font-size:18px\"><em>А) Высокая конкуренция с альтернативными системами, например, работающими в IP-контурах. Это всевозможные решения для анализа, фильтрации, выявления аномалий IP-трафика в промышленных информационных системах. Эти решения по большей части покрывают угрозы, связанные с попытками несанкционированного доступа к данным и физическим компонентам конечной системы, однако требуют достаточных вычислительных ресурсов. Поэтому для относительно слабых устройств, где требуется строгий контроль целостности и аутентичности программных и аппаратных компонентов, аппаратная криптография &ndash; лучший выбор. А самое главное &mdash; это дешевле.</em></p>\n\n<p style=\"font-size:18px\"><em>Б) Многочисленные тактические ошибки, допускаемые производителями аппаратных средств криптографической защиты. Например такие, как попытка создания &laquo;универсальной таблетки&raquo; на все случаи жизни. Тогда как в текущих условиях допиливание решения до совершенства губительно из-за неминуемого повышения конечной цены и высоких рисков упустить окно возможностей в какой-то конкретной области применения. Как следствие, появляется очень много заброшенных проектов, владельцы которых прекратили инвестировать в них. Стоит сказать, что не все из них были безнадежны, просто время было упущено, а ресурсы концентрировались не там, где они действительно были необходимы.</em></p>\n\n<p style=\"font-size:18px\"><em>В) Инертность регуляторов. Здесь технические противоречия между ограничениями, накладываемыми на СКЗИ, и особенностями применения конечного решения бывают особенно остры.&nbsp;В качестве примера можно привести необходимость периодического обновления ключевого материала. Продвинуть крайне важную для IoT схему удаленного обновления симметричных ключей или инициализирующих последовательностей ГСПЧ на конечных точках крайне сложно. Таких противоречий можно найти очень много. И работа по их разрешению только начинается.</em></p>\n\n<p style=\"font-size:18px\">В целом, тактику действий на переходном этапе можно обрисовать следующим образом:</p>\n\n<p style=\"font-size:18px\">&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; для разрабатываемых систем важно прежде всего найти ту нишу, где наиболее приемлем баланс между достоинствами и недостатками.</p>\n\n<p style=\"font-size:18px\"><em>Низкая производительность крипто-чипов на текущем этапе развития может не удовлетворять условиям обработки аудио и видеопотоков, но вполне сгодится для некорректируемой регистрации показаний датчиков или счетчиков. Если есть просадка по автономности, то следует сконцентрироваться на устройствах с внешним питанием. Таковыми, например, являются счетчики электроэнергии. &nbsp;</em></p>\n\n<p style=\"font-size:18px\">&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; найдя такую нишу, следует максимально ускорить внедрение, следуя принципу &laquo;лучшее &ndash; враг хорошего&raquo; и ориентируясь на имеющуюся инфраструктуру и ресурсы.</p>\n\n<p style=\"font-size:18px\">Выход на&nbsp;<strong>второй этап&nbsp;</strong>сопровождается бурным ростом основных характеристик системы. Система уже развита настолько, что соответствует требованиям большинства потребителей. Она начинает приносить прибыль. Это, в свою очередь, дает возможности для дальнейшей оптимизации. Появляются новые разновидности системы, заточенные на разные области применения и новые поколения систем. Система начинает потреблять ресурсы, предназначенные конкретно для нее. Рост массовости применения отдельных систем порождает новые стандарты, на которые ориентируются уже не только клиенты, но и прямые конкуренты. Растет число специалистов, ориентированных на деятельность в целевой отрасли.</p>\n\n<p style=\"font-size:18px\"><em>Для СКЗИ в IoT специализированными&nbsp;ресурсами могут быть посадочные места для модулей, API, криптографические протоколы, системы низкоуровневых команд, серверные платформы для управления жизненным циклом как самих криптографических модулей, так и устройств, которые их содержат. Отдельно хочется отметить необходимость появления на массовом рынке специализированных чипов, реализующих отечественную криптографию на уровне транзиторной логики. В противном случае отставание от зарубежных решений может быть колоссальным.</em></p>\n\n<p style=\"font-size:18px\">Окончательный выход на второй этап аппаратных СКЗИ для кибер-физических систем &ndash; вопрос ближайшего времени. Все будет зависеть от того, насколько плотным будет взаимодействие между разработчиками средств криптографии и их партнерами, применяющими эти средства в своих решениях. Сейчас настал тот момент, когда разница между вложениями и потенциальной прибылью на грядущем 3-м этапе максимальна.</p>\n\n<p style=\"font-size:18px\">Конец 1-ой части.</p>\n\n<p style=\"font-size:18px\">В следующих частях статьи мы постараемся рассмотреть возможные пути эволюции аппаратных СКЗИ в IoT на последующих этапах их развития как технических систем.</p>\n\n<p style=\"font-size:18px\">Использованная литература:</p>\n\n<ul>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>А. Любомирский, С. Литвин &quot;Законы развития технических систем&quot;.</strong></p>\n\t</li>\n\t<li>\n\t<p style=\"font-size:18px\"><strong>В. Петров, Э. Злотин &quot;Законы развития технических систем&quot;</strong>. Учебное пособие. Тель-Авив. 1992.</p>\n\t</li>\n</ul>",
    "author": "petrov",
    "category": "научпоп",
    "image": "f2ebc5b42569e05c70935610596dc760.jpg",
    "status": "published",
    "comment_moderator": "",
    "moderator_id": "ivanov",
    "published_at": "14.09.21 01:55:19"
  }
]